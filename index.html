<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Tablecloth documentation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link rel="icon" href="data:,">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#dataset-api" id="toc-dataset-api" class="nav-link" data-scroll-target="#dataset-api">Dataset API</a>
  <ul>
  <li><a href="#dataset-creation" id="toc-dataset-creation" class="nav-link" data-scroll-target="#dataset-creation">Dataset creation</a></li>
  <li><a href="#saving" id="toc-saving" class="nav-link" data-scroll-target="#saving">Saving</a>
  <ul class="collapse">
  <li><a href="#nippy" id="toc-nippy" class="nav-link" data-scroll-target="#nippy">Nippy</a></li>
  </ul></li>
  <li><a href="#dataset-related-functions" id="toc-dataset-related-functions" class="nav-link" data-scroll-target="#dataset-related-functions">Dataset related functions</a></li>
  <li><a href="#columns-and-rows" id="toc-columns-and-rows" class="nav-link" data-scroll-target="#columns-and-rows">Columns and rows</a></li>
  <li><a href="#single-entry" id="toc-single-entry" class="nav-link" data-scroll-target="#single-entry">Single entry</a></li>
  <li><a href="#printing" id="toc-printing" class="nav-link" data-scroll-target="#printing">Printing</a></li>
  <li><a href="#group-by" id="toc-group-by" class="nav-link" data-scroll-target="#group-by">Group-by</a>
  <ul class="collapse">
  <li><a href="#grouping" id="toc-grouping" class="nav-link" data-scroll-target="#grouping">Grouping</a></li>
  <li><a href="#ungrouping" id="toc-ungrouping" class="nav-link" data-scroll-target="#ungrouping">Ungrouping</a></li>
  <li><a href="#other-functions" id="toc-other-functions" class="nav-link" data-scroll-target="#other-functions">Other functions</a></li>
  </ul></li>
  <li><a href="#columns" id="toc-columns" class="nav-link" data-scroll-target="#columns">Columns</a>
  <ul class="collapse">
  <li><a href="#names" id="toc-names" class="nav-link" data-scroll-target="#names">Names</a></li>
  <li><a href="#select" id="toc-select" class="nav-link" data-scroll-target="#select">Select</a></li>
  <li><a href="#drop" id="toc-drop" class="nav-link" data-scroll-target="#drop">Drop</a></li>
  <li><a href="#rename" id="toc-rename" class="nav-link" data-scroll-target="#rename">Rename</a></li>
  <li><a href="#add-or-update" id="toc-add-or-update" class="nav-link" data-scroll-target="#add-or-update">Add or update</a></li>
  <li><a href="#update" id="toc-update" class="nav-link" data-scroll-target="#update">Update</a></li>
  <li><a href="#map" id="toc-map" class="nav-link" data-scroll-target="#map">Map</a></li>
  <li><a href="#reorder" id="toc-reorder" class="nav-link" data-scroll-target="#reorder">Reorder</a></li>
  <li><a href="#type-conversion" id="toc-type-conversion" class="nav-link" data-scroll-target="#type-conversion">Type conversion</a></li>
  </ul></li>
  <li><a href="#column-operations" id="toc-column-operations" class="nav-link" data-scroll-target="#column-operations">Column Operations</a></li>
  <li><a href="#rows" id="toc-rows" class="nav-link" data-scroll-target="#rows">Rows</a>
  <ul class="collapse">
  <li><a href="#select-1" id="toc-select-1" class="nav-link" data-scroll-target="#select-1">Select</a></li>
  <li><a href="#drop-1" id="toc-drop-1" class="nav-link" data-scroll-target="#drop-1">Drop</a></li>
  <li><a href="#map-rows" id="toc-map-rows" class="nav-link" data-scroll-target="#map-rows">Map rows</a></li>
  <li><a href="#other" id="toc-other" class="nav-link" data-scroll-target="#other">Other</a></li>
  </ul></li>
  <li><a href="#aggregate" id="toc-aggregate" class="nav-link" data-scroll-target="#aggregate">Aggregate</a>
  <ul class="collapse">
  <li><a href="#column" id="toc-column" class="nav-link" data-scroll-target="#column">Column</a></li>
  <li><a href="#crosstab" id="toc-crosstab" class="nav-link" data-scroll-target="#crosstab">Crosstab</a></li>
  </ul></li>
  <li><a href="#order" id="toc-order" class="nav-link" data-scroll-target="#order">Order</a></li>
  <li><a href="#unique" id="toc-unique" class="nav-link" data-scroll-target="#unique">Unique</a>
  <ul class="collapse">
  <li><a href="#strategies" id="toc-strategies" class="nav-link" data-scroll-target="#strategies">Strategies</a></li>
  </ul></li>
  <li><a href="#missing" id="toc-missing" class="nav-link" data-scroll-target="#missing">Missing</a>
  <ul class="collapse">
  <li><a href="#select-2" id="toc-select-2" class="nav-link" data-scroll-target="#select-2">Select</a></li>
  <li><a href="#drop-2" id="toc-drop-2" class="nav-link" data-scroll-target="#drop-2">Drop</a></li>
  <li><a href="#replace" id="toc-replace" class="nav-link" data-scroll-target="#replace">Replace</a></li>
  <li><a href="#inject" id="toc-inject" class="nav-link" data-scroll-target="#inject">Inject</a></li>
  </ul></li>
  <li><a href="#joinseparate-columns" id="toc-joinseparate-columns" class="nav-link" data-scroll-target="#joinseparate-columns">Join/Separate Columns</a>
  <ul class="collapse">
  <li><a href="#join" id="toc-join" class="nav-link" data-scroll-target="#join">Join</a></li>
  <li><a href="#separate" id="toc-separate" class="nav-link" data-scroll-target="#separate">Separate</a></li>
  <li><a href="#array-column-conversion" id="toc-array-column-conversion" class="nav-link" data-scroll-target="#array-column-conversion">Array column conversion</a></li>
  </ul></li>
  <li><a href="#foldunroll-rows" id="toc-foldunroll-rows" class="nav-link" data-scroll-target="#foldunroll-rows">Fold/Unroll Rows</a>
  <ul class="collapse">
  <li><a href="#fold-by" id="toc-fold-by" class="nav-link" data-scroll-target="#fold-by">Fold-by</a></li>
  <li><a href="#unroll" id="toc-unroll" class="nav-link" data-scroll-target="#unroll">Unroll</a></li>
  </ul></li>
  <li><a href="#reshape" id="toc-reshape" class="nav-link" data-scroll-target="#reshape">Reshape</a>
  <ul class="collapse">
  <li><a href="#longer" id="toc-longer" class="nav-link" data-scroll-target="#longer">Longer</a></li>
  <li><a href="#wider" id="toc-wider" class="nav-link" data-scroll-target="#wider">Wider</a></li>
  <li><a href="#reshaping" id="toc-reshaping" class="nav-link" data-scroll-target="#reshaping">Reshaping</a></li>
  </ul></li>
  <li><a href="#joinconcat-datasets" id="toc-joinconcat-datasets" class="nav-link" data-scroll-target="#joinconcat-datasets">Join/Concat Datasets</a>
  <ul class="collapse">
  <li><a href="#left" id="toc-left" class="nav-link" data-scroll-target="#left">Left</a></li>
  <li><a href="#right" id="toc-right" class="nav-link" data-scroll-target="#right">Right</a></li>
  <li><a href="#inner" id="toc-inner" class="nav-link" data-scroll-target="#inner">Inner</a></li>
  <li><a href="#full" id="toc-full" class="nav-link" data-scroll-target="#full">Full</a></li>
  <li><a href="#semi" id="toc-semi" class="nav-link" data-scroll-target="#semi">Semi</a></li>
  <li><a href="#anti" id="toc-anti" class="nav-link" data-scroll-target="#anti">Anti</a></li>
  <li><a href="#hashing" id="toc-hashing" class="nav-link" data-scroll-target="#hashing">Hashing</a></li>
  <li><a href="#cross" id="toc-cross" class="nav-link" data-scroll-target="#cross">Cross</a></li>
  <li><a href="#expand" id="toc-expand" class="nav-link" data-scroll-target="#expand">Expand</a></li>
  <li><a href="#complete" id="toc-complete" class="nav-link" data-scroll-target="#complete">Complete</a></li>
  <li><a href="#asof" id="toc-asof" class="nav-link" data-scroll-target="#asof">asof</a></li>
  <li><a href="#concat" id="toc-concat" class="nav-link" data-scroll-target="#concat">Concat</a></li>
  <li><a href="#union" id="toc-union" class="nav-link" data-scroll-target="#union">Union</a></li>
  <li><a href="#bind" id="toc-bind" class="nav-link" data-scroll-target="#bind">Bind</a></li>
  <li><a href="#append" id="toc-append" class="nav-link" data-scroll-target="#append">Append</a></li>
  <li><a href="#intersection" id="toc-intersection" class="nav-link" data-scroll-target="#intersection">Intersection</a></li>
  <li><a href="#difference" id="toc-difference" class="nav-link" data-scroll-target="#difference">Difference</a></li>
  </ul></li>
  <li><a href="#split-into-traintest" id="toc-split-into-traintest" class="nav-link" data-scroll-target="#split-into-traintest">Split into train/test</a>
  <ul class="collapse">
  <li><a href="#k-fold" id="toc-k-fold" class="nav-link" data-scroll-target="#k-fold">k-Fold</a></li>
  <li><a href="#bootstrap" id="toc-bootstrap" class="nav-link" data-scroll-target="#bootstrap">Bootstrap</a></li>
  <li><a href="#holdout" id="toc-holdout" class="nav-link" data-scroll-target="#holdout">Holdout</a></li>
  <li><a href="#holdouts" id="toc-holdouts" class="nav-link" data-scroll-target="#holdouts">Holdouts</a></li>
  <li><a href="#leave-one-out" id="toc-leave-one-out" class="nav-link" data-scroll-target="#leave-one-out">Leave One Out</a></li>
  <li><a href="#grouped-dataset-with-partitioning" id="toc-grouped-dataset-with-partitioning" class="nav-link" data-scroll-target="#grouped-dataset-with-partitioning">Grouped dataset with partitioning</a></li>
  <li><a href="#split-as-a-sequence" id="toc-split-as-a-sequence" class="nav-link" data-scroll-target="#split-as-a-sequence">Split as a sequence</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#column-api" id="toc-column-api" class="nav-link" data-scroll-target="#column-api">Column API</a>
  <ul>
  <li><a href="#creation-identity" id="toc-creation-identity" class="nav-link" data-scroll-target="#creation-identity">Creation &amp; Identity</a></li>
  <li><a href="#datatypes" id="toc-datatypes" class="nav-link" data-scroll-target="#datatypes">Datatypes</a></li>
  <li><a href="#access-manipulation" id="toc-access-manipulation" class="nav-link" data-scroll-target="#access-manipulation">Access &amp; Manipulation</a>
  <ul class="collapse">
  <li><a href="#column-access" id="toc-column-access" class="nav-link" data-scroll-target="#column-access">Column Access</a></li>
  <li><a href="#slice" id="toc-slice" class="nav-link" data-scroll-target="#slice">Slice</a></li>
  <li><a href="#select-3" id="toc-select-3" class="nav-link" data-scroll-target="#select-3">Select</a></li>
  <li><a href="#sort" id="toc-sort" class="nav-link" data-scroll-target="#sort">Sort</a></li>
  </ul></li>
  <li><a href="#operations" id="toc-operations" class="nav-link" data-scroll-target="#operations">Operations</a></li>
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values">Missing Values</a></li>
  </ul></li>
  <li><a href="#pipeline" id="toc-pipeline" class="nav-link" data-scroll-target="#pipeline">Pipeline</a></li>
  <li><a href="#other-examples" id="toc-other-examples" class="nav-link" data-scroll-target="#other-examples">Other examples</a>
  <ul>
  <li><a href="#stocks" id="toc-stocks" class="nav-link" data-scroll-target="#stocks">Stocks</a></li>
  <li><a href="#data.table" id="toc-data.table" class="nav-link" data-scroll-target="#data.table">data.table</a>
  <ul class="collapse">
  <li><a href="#basics" id="toc-basics" class="nav-link" data-scroll-target="#basics">Basics</a></li>
  <li><a href="#aggregations" id="toc-aggregations" class="nav-link" data-scroll-target="#aggregations">Aggregations</a></li>
  <li><a href="#going-further" id="toc-going-further" class="nav-link" data-scroll-target="#going-further">Going further</a></li>
  <li><a href="#miscellaneous" id="toc-miscellaneous" class="nav-link" data-scroll-target="#miscellaneous">Miscellaneous</a></li>
  <li><a href="#joinbind-data-sets" id="toc-joinbind-data-sets" class="nav-link" data-scroll-target="#joinbind-data-sets">Join/Bind data sets</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tablecloth documentation</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<style></style>
<style>.printedClojure .sourceCode {
  background-color: transparent;
  border-style: none;
}
</style>
<style>.clay-limit-image-width .clay-image {max-width: 100%}
</style>
<script src="index_files/md-default0.js" type="text/javascript"></script>
<script src="index_files/md-default1.js" type="text/javascript"></script>
<p>Dataset (data frame) manipulation API for the <a href="https://github.com/techascent/tech.ml.dataset">tech.ml.dataset</a> library</p>
<p><em>GenerateMe</em></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb1"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> tech-ml-version </span>(<span class="kw">get-in</span> (<span class="kw">read-string</span> (<span class="kw">slurp</span> <span class="st">"deps.edn"</span>)) [<span class="at">:deps</span> <span class="at">'techascent/tech.ml.dataset</span> <span class="at">:mvn/version</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb2"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> tablecloth-version </span>(<span class="kw">nth</span> (<span class="kw">read-string</span> (<span class="kw">slurp</span> <span class="st">"project.clj"</span>)) <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb3"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tech-ml-version</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb4"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="st">"7.029"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb5"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>tablecloth-version</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb6"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="st">"7.029.2"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p><a href="https://github.com/techascent/tech.ml.dataset">tech.ml.dataset</a> is a great and fast library which brings columnar dataset to the Clojure. Chris Nuernberger has been working on this library for last year as a part of bigger <code>tech.ml</code> stack.</p>
<p>I’ve started to test the library and help to fix uncovered bugs. My main goal was to compare functionalities with the other standards from other platforms. I focused on R solutions: <a href="https://dplyr.tidyverse.org/">dplyr</a>, <a href="https://tidyr.tidyverse.org/">tidyr</a> and <a href="https://rdatatable.gitlab.io/data.table/">data.table</a>.</p>
<p>During conversions of the examples I’ve come up how to reorganized existing <code>tech.ml.dataset</code> functions into simple to use API. The main goals were:</p>
<ul>
<li>Focus on dataset manipulation functionality, leaving other parts of <code>tech.ml</code> like pipelines, datatypes, readers, ML, etc.</li>
<li>Single entry point for common operations - one function dispatching on given arguments.</li>
<li><code>group-by</code> results with special kind of dataset - a dataset containing subsets created after grouping as a column.</li>
<li>Most operations recognize regular dataset and grouped dataset and process data accordingly.</li>
<li>One function form to enable thread-first on dataset.</li>
</ul>
<p>If you want to know more about <code>tech.ml.dataset</code> and <code>dtype-next</code> please refer their documentation:</p>
<ul>
<li><a href="https://techascent.github.io/tech.ml.dataset/walkthrough.html">tech.ml.dataset walkthrough</a></li>
<li><a href="https://cnuernber.github.io/dtype-next/overview.html">dtype-next overview</a></li>
<li><a href="https://cnuernber.github.io/dtype-next/cheatsheet.html">dtype-next cheatsheet</a></li>
</ul>
<p><a href="https://github.com/scicloj/tablecloth">SOURCE CODE</a></p>
<p>Join the discussion on <a href="https://clojurians.zulipchat.com/#narrow/stream/236259-tech.2Eml.2Edataset.2Edev/topic/api">Zulip</a></p>
<p>First, let’s require main namespace and define dataset used in most examples:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb7"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">require</span> '[tablecloth.api <span class="at">:as</span> tc]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>         '[tech.v3.datatype.functional <span class="at">:as</span> dfn])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb8"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/dataset {<span class="at">:V1</span> (<span class="kw">take</span> <span class="dv">9</span> (<span class="kw">cycle</span> [<span class="dv">1</span> <span class="dv">2</span>]))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:V2</span> (<span class="kw">range</span> <span class="dv">1</span> <span class="dv">10</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:V3</span> (<span class="kw">take</span> <span class="dv">9</span> (<span class="kw">cycle</span> [<span class="fl">0.5</span> <span class="fl">1.0</span> <span class="fl">1.5</span>]))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:V4</span> (<span class="kw">take</span> <span class="dv">9</span> (<span class="kw">cycle</span> [<span class="st">"A"</span> <span class="st">"B"</span> <span class="st">"C"</span>]))}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb9"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="dataset-api" class="level2">
<h2 class="anchored" data-anchor-id="dataset-api">Dataset API</h2>
<p>Dataset is a special type which can be considered as a map of columns implemented around <code>tech.ml.dataset</code> library. Each column can be considered as named sequence of typed data. Supported types include integers, floats, string, boolean, date/time, objects etc.</p>
<section id="dataset-creation" class="level3">
<h3 class="anchored" data-anchor-id="dataset-creation">Dataset creation</h3>
<p>Dataset can be created from various of types of Clojure structures and files:</p>
<ul>
<li>single values</li>
<li>sequence of maps</li>
<li>map of sequences or values</li>
<li>sequence of <code>tech.v3.dataset.column</code>s (taken from other dataset or created manually)</li>
<li>array of any arrays</li>
<li>file types: raw/gzipped csv/tsv, json, xls(x) taken from local file system or URL</li>
<li>input stream</li>
</ul>
<p><code>tc/dataset</code> accepts:</p>
<ul>
<li>data</li>
<li>options (see documentation of <code>tech.ml.dataset/-&gt;dataset</code> function for full list):
<ul>
<li><code>:dataset-name</code> - name of the dataset</li>
<li><code>:num-rows</code> - number of rows to read from file</li>
<li><code>:header-row?</code> - indication if first row in file is a header</li>
<li><code>:key-fn</code> - function applied to column names (eg. <code>keyword</code>, to convert column names to keywords)</li>
<li><code>:separator</code> - column separator</li>
<li><code>:single-value-column-name</code> - name of the column when single value is provided</li>
<li><code>:column-names</code> - in case you want to name columns - only works for sequential input (arrays) or empty dataset</li>
<li><code>:layout</code> - for numerical, native array of arrays - treat entries <code>:as-rows</code> or <code>:as-columns</code> (default)</li>
</ul></li>
</ul>
<p><code>tc/let-dataset</code> accepts bindings <code>symbol</code>-<code>column-data</code> to simulate R’s <code>tibble</code> function. Each binding is converted into a column. You can refer previous columns to in further bindings (as in <code>let</code>).</p>
<hr>
<p>Empty dataset.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb10"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [0 0]</p>
</div>
<hr>
<p>Empty dataset with column names</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb11"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset <span class="va">nil</span> {<span class="at">:column-names</span> [<span class="at">:a</span> <span class="at">:b</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [0 2]:</p>
<table>
<thead>
<tr class="header">
<th>:a</th>
<th>:b</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
<hr>
<p>Dataset created from map (keys = column names, vals = value(s)).</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb12"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset {<span class="at">:A</span> <span class="dv">33</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:A</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">33</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb13"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset {<span class="at">:A</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:A</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb14"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset {<span class="at">:A</span> [<span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span>] <span class="at">:B</span> [<span class="st">"X"</span> <span class="st">"Y"</span> <span class="st">"Z"</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:A</th>
<th>:B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>Y</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td>Z</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Non-sequential values are repeated row-count number of times.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb15"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset {<span class="at">:A</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span>] <span class="at">:B</span> <span class="st">"X"</span> <span class="at">:C</span> <span class="at">:a</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:A</th>
<th>:B</th>
<th>:C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>X</td>
<td>:a</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>X</td>
<td>:a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>X</td>
<td>:a</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>X</td>
<td>:a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td>X</td>
<td>:a</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td>X</td>
<td>:a</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>You can put any value inside a column</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb16"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset {<span class="at">:A</span> [[<span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span>] [<span class="at">:a</span> <span class="at">:b</span>]] <span class="at">:B</span> <span class="st">"X"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:A</th>
<th>:B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[3 4 5]</td>
<td>X</td>
</tr>
<tr class="even">
<td>[:a :b]</td>
<td>X</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Sequence of maps</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb17"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset [{<span class="at">:a</span> <span class="dv">1</span> <span class="at">:b</span> <span class="dv">3</span>} {<span class="at">:b</span> <span class="dv">2</span> <span class="at">:a</span> <span class="dv">99</span>}])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">99</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb18"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset [{<span class="at">:a</span> <span class="dv">1</span> <span class="at">:b</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>]} {<span class="at">:a</span> <span class="dv">2</span> <span class="at">:b</span> [<span class="dv">3</span> <span class="dv">4</span>]}])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th>:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>[1 2 3]</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>[3 4]</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Missing values are marked by <code>nil</code></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb19"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset [{<span class="at">:a</span> <span class="va">nil</span> <span class="at">:b</span> <span class="dv">1</span>} {<span class="at">:a</span> <span class="dv">3</span> <span class="at">:b</span> <span class="dv">4</span>} {<span class="at">:a</span> <span class="dv">11</span>}])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Reading from arrays, by default <code>:as-rows</code></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb20"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset [[<span class="at">:a</span> <span class="dv">1</span>] [<span class="at">:b</span> <span class="dv">2</span>] [<span class="at">:c</span> <span class="dv">3</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>:_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>0</th>
<th style="text-align: right;">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:a</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>:b</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td>:c</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb21"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (<span class="kw">map</span> <span class="kw">int-array</span> [[<span class="dv">1</span> <span class="dv">2</span>] [<span class="dv">3</span> <span class="dv">4</span>] [<span class="dv">5</span> <span class="dv">6</span>]])</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">into-array</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    (tc/dataset))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>:_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">0</th>
<th style="text-align: right;">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
<p><code>:as-columns</code></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb22"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (<span class="kw">map</span> <span class="kw">int-array</span> [[<span class="dv">1</span> <span class="dv">2</span>] [<span class="dv">3</span> <span class="dv">4</span>] [<span class="dv">5</span> <span class="dv">6</span>]])</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">into-array</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    (tc/dataset {<span class="at">:layout</span> <span class="at">:as-columns</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>:_unnamed [2 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">0</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
<p><code>:as-rows</code> with names</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb23"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (<span class="kw">map</span> <span class="kw">int-array</span> [[<span class="dv">1</span> <span class="dv">2</span>] [<span class="dv">3</span> <span class="dv">4</span>] [<span class="dv">5</span> <span class="dv">6</span>]])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">into-array</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    (tc/dataset {<span class="at">:layout</span> <span class="at">:as-rows</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:column-names</span> [<span class="at">:a</span> <span class="at">:b</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>:_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
<p>Any objects</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb24"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (<span class="kw">map</span> <span class="kw">to-array</span> [[<span class="at">:a</span> <span class="at">:z</span>] [<span class="st">"ee"</span> <span class="st">"ww"</span>] [<span class="dv">9</span> <span class="dv">10</span>]])</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">into-array</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    (tc/dataset {<span class="at">:column-names</span> [<span class="at">:a</span> <span class="at">:b</span> <span class="at">:c</span>]</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:layout</span> <span class="at">:as-columns</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>:_unnamed [2 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:a</th>
<th>:b</th>
<th style="text-align: right;">:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:a</td>
<td>ee</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td>:z</td>
<td>ww</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Create dataset using macro <code>let-dataset</code> to simulate R <code>tibble</code> function. Each binding is converted into a column.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb25"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(tc/let-dataset [x (<span class="kw">range</span> <span class="dv">1</span> <span class="dv">6</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                  y <span class="dv">1</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                  z (dfn/+ x y)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>:_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>0</th>
<th>1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:x</td>
<td>(1 2 3 4 5)</td>
</tr>
<tr class="even">
<td>:y</td>
<td>1</td>
</tr>
<tr class="odd">
<td>:z</td>
<td>tech.v3.datatype.unary_op<span class="math inline">\(eval28316\)</span>fn$reify__28327@76e1bcf2</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Import CSV file</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb26"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset <span class="st">"data/family.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/family.csv [5 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">family</th>
<th>dob_child1</th>
<th>dob_child2</th>
<th style="text-align: right;">gender_child1</th>
<th style="text-align: right;">gender_child2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>1998-11-26</td>
<td>2000-01-29</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>1996-06-22</td>
<td></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>2002-07-11</td>
<td>2004-04-05</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>2004-10-10</td>
<td>2009-08-27</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td>2000-12-05</td>
<td>2005-02-28</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Import from URL</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb27"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defonce</span><span class="fu"> ds </span>(tc/dataset <span class="st">"https://vega.github.io/vega-lite/examples/data/seattle-weather.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb28"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>https://vega.github.io/vega-lite/examples/data/seattle-weather.csv [1461 6]:</p>
<table class="table">
<thead>
<tr class="header">
<th>date</th>
<th style="text-align: right;">precipitation</th>
<th style="text-align: right;">temp_max</th>
<th style="text-align: right;">temp_min</th>
<th style="text-align: right;">wind</th>
<th>weather</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2012-01-01</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">12.8</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">4.7</td>
<td>drizzle</td>
</tr>
<tr class="even">
<td>2012-01-02</td>
<td style="text-align: right;">10.9</td>
<td style="text-align: right;">10.6</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.5</td>
<td>rain</td>
</tr>
<tr class="odd">
<td>2012-01-03</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">11.7</td>
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">2.3</td>
<td>rain</td>
</tr>
<tr class="even">
<td>2012-01-04</td>
<td style="text-align: right;">20.3</td>
<td style="text-align: right;">12.2</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">4.7</td>
<td>rain</td>
</tr>
<tr class="odd">
<td>2012-01-05</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">8.9</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">6.1</td>
<td>rain</td>
</tr>
<tr class="even">
<td>2012-01-06</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">2.2</td>
<td>rain</td>
</tr>
<tr class="odd">
<td>2012-01-07</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">2.3</td>
<td>rain</td>
</tr>
<tr class="even">
<td>2012-01-08</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">10.0</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">2.0</td>
<td>sun</td>
</tr>
<tr class="odd">
<td>2012-01-09</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">9.4</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.4</td>
<td>rain</td>
</tr>
<tr class="even">
<td>2012-01-10</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">3.4</td>
<td>rain</td>
</tr>
<tr class="odd">
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
</tr>
<tr class="even">
<td>2015-12-21</td>
<td style="text-align: right;">27.4</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.3</td>
<td>rain</td>
</tr>
<tr class="odd">
<td>2015-12-22</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">7.8</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">5.0</td>
<td>rain</td>
</tr>
<tr class="even">
<td>2015-12-23</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">7.6</td>
<td>rain</td>
</tr>
<tr class="odd">
<td>2015-12-24</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">4.3</td>
<td>rain</td>
</tr>
<tr class="even">
<td>2015-12-25</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">1.5</td>
<td>rain</td>
</tr>
<tr class="odd">
<td>2015-12-26</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">2.5</td>
<td>sun</td>
</tr>
<tr class="even">
<td>2015-12-27</td>
<td style="text-align: right;">8.6</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">2.9</td>
<td>rain</td>
</tr>
<tr class="odd">
<td>2015-12-28</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">1.3</td>
<td>rain</td>
</tr>
<tr class="even">
<td>2015-12-29</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">2.6</td>
<td>fog</td>
</tr>
<tr class="odd">
<td>2015-12-30</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">-1.0</td>
<td style="text-align: right;">3.4</td>
<td>sun</td>
</tr>
<tr class="even">
<td>2015-12-31</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">-2.1</td>
<td style="text-align: right;">3.5</td>
<td>sun</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>When none of above works, singleton dataset is created. Along with the error message from the exception thrown by <code>tech.ml.dataset</code></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb29"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:<span class="math inline">\(value |                                            :\)</span>error</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">999</td>
<td>Don’t know how to create ISeq from: java.lang.Long</td>
</tr>
</tbody>
</table>
</div>
<p>To see the stack trace, turn it on by setting <code>:stack-trace?</code> to <code>true</code>.</p>
<hr>
<p>Set column name for single value. Also set the dataset name and turn off creating error message column.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb30"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset <span class="dv">999</span> {<span class="at">:single-value-column-name</span> <span class="st">"my-single-value"</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:error-column</span>? <span class="va">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">my-single-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">999</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb31"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset <span class="dv">999</span> {<span class="at">:single-value-column-name</span> <span class="st">""</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:dataset-name</span> <span class="st">"Single value"</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:error-column</span>? <span class="va">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>Single value [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">999</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="saving" class="level3">
<h3 class="anchored" data-anchor-id="saving">Saving</h3>
<p>Export dataset to a file or output stream can be done by calling <code>tc/write!</code>. Function accepts:</p>
<ul>
<li>dataset</li>
<li>file name with one of the extensions: <code>.csv</code>, <code>.tsv</code>, <code>.csv.gz</code> and <code>.tsv.gz</code> or output stream</li>
<li>options:</li>
<li><code>:separator</code> - string or separator char.</li>
</ul>
<div class="sourceClojure">
<div class="sourceCode" id="cb32"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>(tc/write! ds <span class="st">"output.tsv.gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb33"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1462</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb34"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>(.exists (clojure.java.io/file <span class="st">"output.tsv.gz"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb35"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="va">true</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="nippy" class="level4">
<h4 class="anchored" data-anchor-id="nippy">Nippy</h4>
<div class="sourceClojure">
<div class="sourceCode" id="cb36"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>(tc/write! DS <span class="st">"output.nippy.gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb37"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb38"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset <span class="st">"output.nippy.gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>output.nippy.gz [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="dataset-related-functions" class="level3">
<h3 class="anchored" data-anchor-id="dataset-related-functions">Dataset related functions</h3>
<p>Summary functions about the dataset like number of rows, columns and basic stats.</p>
<hr>
<p>Number of rows</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb39"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>(tc/row-count ds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb40"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1461</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Number of columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb41"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>(tc/column-count ds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb42"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Shape of the dataset, [row count, column count]</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb43"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>(tc/shape ds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb44"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1461</span> <span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>General info about dataset. There are three variants:</p>
<ul>
<li>default - containing information about columns with basic statistics</li>
<li><code>:basic</code> - just name, row and column count and information if dataset is a result of <code>group-by</code> operation</li>
<li><code>:columns</code> - columns’ metadata</li>
</ul>
<div class="sourceClojure">
<div class="sourceCode" id="cb45"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>(tc/info ds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>https://vega.github.io/vega-lite/examples/data/seattle-weather.csv: descriptive-stats [6 12]:</p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th>:col-name</th>
<th>:datatype</th>
<th style="text-align: right;">:n-valid</th>
<th style="text-align: right;">:n-missing</th>
<th>:min</th>
<th>:mean</th>
<th>:mode</th>
<th>:max</th>
<th style="text-align: right;">:standard-deviation</th>
<th style="text-align: right;">:skew</th>
<th>:first</th>
<th>:last</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>date</td>
<td>:packed-local-date</td>
<td style="text-align: right;">1461</td>
<td style="text-align: right;">0</td>
<td>2012-01-01</td>
<td>2013-12-31</td>
<td></td>
<td>2015-12-31</td>
<td style="text-align: right;">3.64520463E+10</td>
<td style="text-align: right;">1.98971418E-17</td>
<td>2012-01-01</td>
<td>2015-12-31</td>
</tr>
<tr class="even">
<td>precipitation</td>
<td>:float64</td>
<td style="text-align: right;">1461</td>
<td style="text-align: right;">0</td>
<td>0.000</td>
<td>3.029</td>
<td></td>
<td>55.90</td>
<td style="text-align: right;">6.68019432E+00</td>
<td style="text-align: right;">3.50564372E+00</td>
<td>0.000</td>
<td>0.000</td>
</tr>
<tr class="odd">
<td>temp_max</td>
<td>:float64</td>
<td style="text-align: right;">1461</td>
<td style="text-align: right;">0</td>
<td>-1.600</td>
<td>16.44</td>
<td></td>
<td>35.60</td>
<td style="text-align: right;">7.34975810E+00</td>
<td style="text-align: right;">2.80929992E-01</td>
<td>12.80</td>
<td>5.600</td>
</tr>
<tr class="even">
<td>temp_min</td>
<td>:float64</td>
<td style="text-align: right;">1461</td>
<td style="text-align: right;">0</td>
<td>-7.100</td>
<td>8.235</td>
<td></td>
<td>18.30</td>
<td style="text-align: right;">5.02300418E+00</td>
<td style="text-align: right;">-2.49458552E-01</td>
<td>5.000</td>
<td>-2.100</td>
</tr>
<tr class="odd">
<td>wind</td>
<td>:float64</td>
<td style="text-align: right;">1461</td>
<td style="text-align: right;">0</td>
<td>0.4000</td>
<td>3.241</td>
<td></td>
<td>9.500</td>
<td style="text-align: right;">1.43782506E+00</td>
<td style="text-align: right;">8.91667519E-01</td>
<td>4.700</td>
<td>3.500</td>
</tr>
<tr class="even">
<td>weather</td>
<td>:string</td>
<td style="text-align: right;">1461</td>
<td style="text-align: right;">0</td>
<td></td>
<td></td>
<td>rain</td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td>drizzle</td>
<td>sun</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb46"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>(tc/info ds <span class="at">:basic</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>https://vega.github.io/vega-lite/examples/data/seattle-weather.csv :basic info [1 4]:</p>
<table class="table">
<colgroup>
<col style="width: 70%">
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th>:name</th>
<th>:grouped?</th>
<th style="text-align: right;">:rows</th>
<th style="text-align: right;">:columns</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>https://vega.github.io/vega-lite/examples/data/seattle-weather.csv</td>
<td>false</td>
<td style="text-align: right;">1461</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb47"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>(tc/info ds <span class="at">:columns</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>https://vega.github.io/vega-lite/examples/data/seattle-weather.csv :column info [6 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:name</th>
<th>:datatype</th>
<th style="text-align: right;">:n-elems</th>
<th>:categorical?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>date</td>
<td>:packed-local-date</td>
<td style="text-align: right;">1461</td>
<td></td>
</tr>
<tr class="even">
<td>precipitation</td>
<td>:float64</td>
<td style="text-align: right;">1461</td>
<td></td>
</tr>
<tr class="odd">
<td>temp_max</td>
<td>:float64</td>
<td style="text-align: right;">1461</td>
<td></td>
</tr>
<tr class="even">
<td>temp_min</td>
<td>:float64</td>
<td style="text-align: right;">1461</td>
<td></td>
</tr>
<tr class="odd">
<td>wind</td>
<td>:float64</td>
<td style="text-align: right;">1461</td>
<td></td>
</tr>
<tr class="even">
<td>weather</td>
<td>:string</td>
<td style="text-align: right;">1461</td>
<td>true</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Getting a dataset name</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb48"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset-name ds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb49"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="st">"https://vega.github.io/vega-lite/examples/data/seattle-weather.csv"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Setting a dataset name (operation is immutable).</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb50"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;&gt;</span> <span class="st">"seattle-weather"</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>     (tc/set-dataset-name ds)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>     (tc/dataset-name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb51"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="st">"seattle-weather"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="columns-and-rows" class="level3">
<h3 class="anchored" data-anchor-id="columns-and-rows">Columns and rows</h3>
<p>Get columns and rows as sequences. <code>column</code>, <code>columns</code> and <code>rows</code> treat grouped dataset as regular one. See <code>Groups</code> to read more about grouped datasets.</p>
<p>Possible result types:</p>
<ul>
<li><code>:as-seq</code> or <code>:as-seqs</code> - sequence of seqences (default)</li>
<li><code>:as-maps</code> - sequence of maps (rows)</li>
<li><code>:as-map</code> - map of sequences (columns)</li>
<li><code>:as-double-arrays</code> - array of double arrays</li>
<li><code>:as-vecs</code> - sequence of vectors (rows)</li>
</ul>
<p>For <code>rows</code> setting <code>:nil-missing?</code> option to <code>false</code> will elide keys for nil values.</p>
<hr>
<p>Select column.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb52"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>(ds <span class="st">"wind"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb53"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;float64&amp;gt;[1461]</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>wind</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>[<span class="fl">4.700</span>, <span class="fl">4.500</span>, <span class="fl">2.300</span>, <span class="fl">4.700</span>, <span class="fl">6.100</span>, <span class="fl">2.200</span>, <span class="fl">2.300</span>, <span class="fl">2.000</span>, <span class="fl">3.400</span>, <span class="fl">3.400</span>, <span class="fl">5.100</span>, <span class="fl">1.900</span>, <span class="fl">1.300</span>, <span class="fl">5.300</span>, <span class="fl">3.200</span>, <span class="fl">5.000</span>, <span class="fl">5.600</span>, <span class="fl">5.000</span>, <span class="fl">1.600</span>, <span class="dv">2</span>.<span class="dv">300</span>...]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb54"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>(tc/column ds <span class="st">"date"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb55"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;packed-local-date&amp;gt;[1461]</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>date</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2012-01-01</span>, <span class="dv">2012-01-02</span>, <span class="dv">2012-01-03</span>, <span class="dv">2012-01-04</span>, <span class="dv">2012-01-05</span>, <span class="dv">2012-01-06</span>, <span class="dv">2012-01-07</span>, <span class="dv">2012-01-08</span>, <span class="dv">2012-01-09</span>, <span class="dv">2012-01-10</span>, <span class="dv">2012-01-11</span>, <span class="dv">2012-01-12</span>, <span class="dv">2012-01-13</span>, <span class="dv">2012-01-14</span>, <span class="dv">2012-01-15</span>, <span class="dv">2012-01-16</span>, <span class="dv">2012-01-17</span>, <span class="dv">2012-01-18</span>, <span class="dv">2012-01-19</span>, <span class="dv">2012-01-20</span>...]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Columns as sequence</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb56"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">take</span> <span class="dv">2</span> (tc/columns ds))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb57"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>(#tech.v3.dataset.column&amp;lt<span class="co">;packed-local-date&amp;gt;[1461]</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>date</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2012-01-01</span>, <span class="dv">2012-01-02</span>, <span class="dv">2012-01-03</span>, <span class="dv">2012-01-04</span>, <span class="dv">2012-01-05</span>, <span class="dv">2012-01-06</span>, <span class="dv">2012-01-07</span>, <span class="dv">2012-01-08</span>, <span class="dv">2012-01-09</span>, <span class="dv">2012-01-10</span>, <span class="dv">2012-01-11</span>, <span class="dv">2012-01-12</span>, <span class="dv">2012-01-13</span>, <span class="dv">2012-01-14</span>, <span class="dv">2012-01-15</span>, <span class="dv">2012-01-16</span>, <span class="dv">2012-01-17</span>, <span class="dv">2012-01-18</span>, <span class="dv">2012-01-19</span>, <span class="dv">2012-01-20</span>...]</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a> #tech.v3.dataset.column&amp;lt<span class="co">;float64&amp;gt;[1461]</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>precipitation</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>[<span class="fl">0.000</span>, <span class="fl">10.90</span>, <span class="fl">0.8000</span>, <span class="fl">20.30</span>, <span class="fl">1.300</span>, <span class="fl">2.500</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">4.300</span>, <span class="fl">1.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">0.000</span>, <span class="fl">4.100</span>, <span class="fl">5.300</span>, <span class="fl">2.500</span>, <span class="fl">8.100</span>, <span class="fl">19.80</span>, <span class="fl">15.20</span>, <span class="dv">13</span>.<span class="dv">50</span>...])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Columns as map</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb58"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">keys</span> (tc/columns ds <span class="at">:as-map</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb59"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>(<span class="st">"date"</span> <span class="st">"precipitation"</span> <span class="st">"temp_max"</span> <span class="st">"temp_min"</span> <span class="st">"wind"</span> <span class="st">"weather"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Rows as sequence of sequences</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb60"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">take</span> <span class="dv">2</span> (tc/rows ds))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb61"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>([#object[java.<span class="kw">time</span>.LocalDate <span class="bn">0x3d8af9f2</span> <span class="st">"2012-01-01"</span>]</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.0</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">12.8</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fl">5.0</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">4.7</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"drizzle"</span>]</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a> [#object[java.<span class="kw">time</span>.LocalDate <span class="bn">0x4b48026e</span> <span class="st">"2012-01-02"</span>]</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">10.9</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fl">10.6</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fl">2.8</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fl">4.5</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"rain"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Select rows/columns as double-double-array</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb62"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> ds</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns <span class="at">:type/numerical</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    (tc/head)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    (tc/rows <span class="at">:as-double-arrays</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb63"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>[[<span class="fl">0.0</span>, <span class="fl">12.8</span>, <span class="fl">5.0</span>, <span class="fl">4.7</span>], [<span class="fl">10.9</span>, <span class="fl">10.6</span>, <span class="fl">2.8</span>, <span class="fl">4.5</span>], [<span class="fl">0.8</span>, <span class="fl">11.7</span>, <span class="fl">7.2</span>, <span class="fl">2.3</span>],</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a> [<span class="fl">20.3</span>, <span class="fl">12.2</span>, <span class="fl">5.6</span>, <span class="fl">4.7</span>], [<span class="fl">1.3</span>, <span class="fl">8.9</span>, <span class="fl">2.8</span>, <span class="fl">6.1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb64"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> ds</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns <span class="at">:type/numerical</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    (tc/head)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    (tc/columns <span class="at">:as-double-arrays</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb65"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>[[<span class="fl">0.0</span>, <span class="fl">10.9</span>, <span class="fl">0.8</span>, <span class="fl">20.3</span>, <span class="fl">1.3</span>], [<span class="fl">12.8</span>, <span class="fl">10.6</span>, <span class="fl">11.7</span>, <span class="fl">12.2</span>, <span class="fl">8.9</span>],</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a> [<span class="fl">5.0</span>, <span class="fl">2.8</span>, <span class="fl">7.2</span>, <span class="fl">5.6</span>, <span class="fl">2.8</span>], [<span class="fl">4.7</span>, <span class="fl">4.5</span>, <span class="fl">2.3</span>, <span class="fl">4.7</span>, <span class="fl">6.1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Rows as sequence of maps</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb66"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>(clojure.pprint/pprint (<span class="kw">take</span> <span class="dv">2</span> (tc/rows ds <span class="at">:as-maps</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb67"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Rows with missing values</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb68"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> {<span class="at">:a</span> [<span class="dv">1</span> <span class="va">nil</span> <span class="dv">2</span>]</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">:b</span> [<span class="dv">3</span> <span class="dv">4</span> <span class="va">nil</span>]}</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    (tc/dataset)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    (tc/rows <span class="at">:as-maps</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb69"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>[{<span class="at">:a</span> <span class="dv">1</span>, <span class="at">:b</span> <span class="dv">3</span>} {<span class="at">:a</span> <span class="va">nil</span>, <span class="at">:b</span> <span class="dv">4</span>} {<span class="at">:a</span> <span class="dv">2</span>, <span class="at">:b</span> <span class="va">nil</span>}]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rows with elided missing values</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb70"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> {<span class="at">:a</span> [<span class="dv">1</span> <span class="va">nil</span> <span class="dv">2</span>]</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">:b</span> [<span class="dv">3</span> <span class="dv">4</span> <span class="va">nil</span>]}</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    (tc/dataset)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    (tc/rows <span class="at">:as-maps</span> {<span class="at">:nil-missing</span>? <span class="va">false</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb71"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>[{<span class="at">:a</span> <span class="dv">1</span>, <span class="at">:b</span> <span class="dv">3</span>} {<span class="at">:b</span> <span class="dv">4</span>} {<span class="at">:a</span> <span class="dv">2</span>}]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="single-entry" class="level3">
<h3 class="anchored" data-anchor-id="single-entry">Single entry</h3>
<p>Get single value from the table using <code>get-in</code> from Clojure API or <code>get-entry</code>. First argument is column name, second is row number.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb72"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">get-in</span> ds [<span class="st">"wind"</span> <span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb73"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fl">2.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb74"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>(tc/get-entry ds <span class="st">"wind"</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb75"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fl">2.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="printing" class="level3">
<h3 class="anchored" data-anchor-id="printing">Printing</h3>
<p>Dataset is printed using <code>dataset-&gt;str</code> or <code>print-dataset</code> functions. Options are the same as in <code>tech.ml.dataset/dataset-data-&gt;str</code>. Most important is <code>:print-line-policy</code> which can be one of the: <code>:single</code>, <code>:repl</code> or <code>:markdown</code>.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb76"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>(tc/print-dataset (tc/group-by DS <span class="at">:V1</span>) {<span class="at">:print-line-policy</span> <span class="at">:markdown</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb77"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb78"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>(tc/print-dataset (tc/group-by DS <span class="at">:V1</span>) {<span class="at">:print-line-policy</span> <span class="at">:repl</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb79"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb80"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>(tc/print-dataset (tc/group-by DS <span class="at">:V1</span>) {<span class="at">:print-line-policy</span> <span class="at">:single</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb81"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="group-by" class="level3">
<h3 class="anchored" data-anchor-id="group-by">Group-by</h3>
<p>Grouping by is an operation which splits dataset into subdatasets and pack it into new special type of… dataset. I distinguish two types of dataset: regular dataset and grouped dataset. The latter is the result of grouping.</p>
<p>Grouped dataset is annotated in by <code>:grouped?</code> meta tag and consist following columns:</p>
<ul>
<li><code>:name</code> - group name or structure</li>
<li><code>:group-id</code> - integer assigned to the group</li>
<li><code>:data</code> - groups as datasets</li>
</ul>
<p>Almost all functions recognize type of the dataset (grouped or not) and operate accordingly.</p>
<p>You can’t apply reshaping or join/concat functions on grouped datasets.</p>
<section id="grouping" class="level4">
<h4 class="anchored" data-anchor-id="grouping">Grouping</h4>
<p>Grouping is done by calling <code>group-by</code> function with arguments:</p>
<ul>
<li><code>ds</code> - dataset</li>
<li><code>grouping-selector</code> - what to use for grouping</li>
<li>options:</li>
<li><code>:result-type</code> - what to return:</li>
<li><code>:as-dataset</code> (default) - return grouped dataset</li>
<li><code>:as-indexes</code> - return rows ids (row number from original dataset)</li>
<li><code>:as-map</code> - return map with group names as keys and subdataset as values</li>
<li><code>:as-seq</code> - return sequence of subdatasets</li>
<li><code>:select-keys</code> - list of the columns passed to a grouping selector function</li>
</ul>
<p>All subdatasets (groups) have set name as the group name, additionally <code>group-id</code> is in meta.</p>
<p>Grouping can be done by:</p>
<ul>
<li>single column name</li>
<li>seq of column names</li>
<li>map of keys (group names) and row indexes</li>
<li>value returned by function taking row as map (limited to <code>:select-keys</code>)</li>
</ul>
<p>Note: currently dataset inside dataset is printed recursively so it renders poorly from markdown. So I will use <code>:as-seq</code> result type to show just group names and groups.</p>
<hr>
<p>List of columns in grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb82"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V1</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    (tc/column-names))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb83"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V3</span> <span class="at">:V4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>List of columns in grouped dataset treated as regular dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb84"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V1</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    (tc/as-regular-dataset)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    (tc/column-names))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb85"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:name</span> <span class="at">:group-id</span> <span class="at">:data</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Content of the grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb86"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>(tc/columns (tc/group-by DS <span class="at">:V1</span>) <span class="at">:as-map</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>{</p><div style="margin-left:10%;width:110%;"><div><pre><code class="sourceCode language-clojure printed-clojure">:name #tech.v3.dataset.column&lt;int64&gt;[2]
:name
[1, 2]</code></pre></div><div><pre><code class="sourceCode language-clojure printed-clojure">:group-id #tech.v3.dataset.column&lt;int64&gt;[2]
:group-id
[0, 1]</code></pre></div>
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>:data</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div>
<p>(</p>
<div style="margin-left:10%;width:110%;">
<div class="clay-dataset">
<p>Group: 1 [5 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<div class="clay-dataset">
<p>Group: 2 [4 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>)</p>
</div>
</div></td>
</tr>
</tbody>
</table>
</div><p>}</p></div>
</div>
<hr>
<p>Grouped dataset as map</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb88"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">keys</span> (tc/group-by DS <span class="at">:V1</span> {<span class="at">:result-type</span> <span class="at">:as-map</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb89"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb90"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">vals</span> (tc/group-by DS <span class="at">:V1</span> {<span class="at">:result-type</span> <span class="at">:as-map</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>(</p><div style="margin-left:10%;width:110%;"><div class="clay-dataset"><p>Group: 1 [5 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: 2 [4 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div></div><p>)</p></div>
</div>
<hr>
<p>Group dataset as map of indexes (row ids)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb91"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>(tc/group-by DS <span class="at">:V1</span> {<span class="at">:result-type</span> <span class="at">:as-indexes</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb92"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>{<span class="dv">1</span> [<span class="dv">0</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">6</span> <span class="dv">8</span>], <span class="dv">2</span> [<span class="dv">1</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span>]}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Grouped datasets are printed as follows by default.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb93"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>(tc/group-by DS <span class="at">:V1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:name</th>
<th style="text-align: right;">:group-id</th>
<th>:data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>Group: 1 [5 4]:</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td>Group: 2 [4 4]:</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>To get groups as sequence or a map can be done from grouped dataset using <code>groups-&gt;seq</code> and <code>groups-&gt;map</code> functions.</p>
<p>Groups as seq can be obtained by just accessing <code>:data</code> column.</p>
<p>I will use temporary dataset here.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb94"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">let</span> [ds (<span class="kw">-&gt;</span> {<span class="st">"a"</span> [<span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span>]</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"b"</span> [<span class="st">"a"</span> <span class="st">"b"</span> <span class="st">"c"</span> <span class="st">"d"</span>]}</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>             (tc/dataset)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>             (tc/group-by <span class="st">"a"</span>))]</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">seq</span> (ds <span class="at">:data</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>(</p><div style="margin-left:10%;width:110%;"><div class="clay-dataset"><p>Group: 1 [2 2]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>b</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: 2 [2 2]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>c</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>d</td>
</tr>
</tbody>
</table>
</div></div><p>)</p></div>
</div>
<p>seq is not necessary but Markdown treats <code>:data</code> as command here</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb95"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> {<span class="st">"a"</span> [<span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span>]</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>     <span class="st">"b"</span> [<span class="st">"a"</span> <span class="st">"b"</span> <span class="st">"c"</span> <span class="st">"d"</span>]}</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    (tc/dataset)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="st">"a"</span>)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>    (tc/groups-&gt;seq))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>(</p><div style="margin-left:10%;width:110%;"><div class="clay-dataset"><p>Group: 1 [2 2]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>b</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: 2 [2 2]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>c</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>d</td>
</tr>
</tbody>
</table>
</div></div><p>)</p></div>
</div>
<hr>
<p>Groups as map</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb96"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> {<span class="st">"a"</span> [<span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span>]</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>     <span class="st">"b"</span> [<span class="st">"a"</span> <span class="st">"b"</span> <span class="st">"c"</span> <span class="st">"d"</span>]}</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    (tc/dataset)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="st">"a"</span>)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    (tc/groups-&gt;map))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>{</p><div style="margin-left:10%;width:110%;">
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>1</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: 1 [2 2]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>b</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>2</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: 2 [2 2]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>c</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>d</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
</div><p>}</p></div>
</div>
<hr>
<p>Grouping by more than one column. You can see that group names are maps. When ungrouping is done these maps are used to restore column names.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb99"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>(tc/group-by DS [<span class="at">:V1</span> <span class="at">:V3</span>] {<span class="at">:result-type</span> <span class="at">:as-seq</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>(</p><div style="margin-left:10%;width:110%;"><div class="clay-dataset"><p>Group: {:V1 1, :V3 0.5} [2 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: {:V1 2, :V3 1.0} [2 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: {:V1 1, :V3 1.5} [2 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: {:V1 2, :V3 0.5} [1 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: {:V1 1, :V3 1.0} [1 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: {:V1 2, :V3 1.5} [1 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div></div><p>)</p></div>
</div>
<hr>
<p>Grouping can be done by providing just row indexes. This way you can assign the same row to more than one group.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb100"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>(tc/group-by DS {<span class="st">"group-a"</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span>]</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"group-b"</span> [<span class="dv">5</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">1</span>]} {<span class="at">:result-type</span> <span class="at">:as-seq</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>(</p><div style="margin-left:10%;width:110%;"><div class="clay-dataset"><p>Group: group-a [4 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: group-b [4 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div></div><p>)</p></div>
</div>
<hr>
<p>You can group by a result of grouping function which gets row as map and should return group name. When map is used as a group name, ungrouping restore original column names.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb101"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>(tc/group-by DS (<span class="kw">fn</span> [row] (<span class="kw">*</span> (<span class="at">:V1</span> row)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>                             (<span class="at">:V3</span> row))) {<span class="at">:result-type</span> <span class="at">:as-seq</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>(</p><div style="margin-left:10%;width:110%;"><div class="clay-dataset"><p>Group: 0.5 [2 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: 2.0 [2 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: 1.5 [2 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: 1.0 [2 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: 3.0 [1 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div></div><p>)</p></div>
</div>
<hr>
<p>You can use any predicate on column to split dataset into two groups.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb102"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>(tc/group-by DS (<span class="kw">comp</span> #(<span class="kw">&lt;</span> <span class="va">%</span> <span class="fl">1.0</span>) <span class="at">:V3</span>) {<span class="at">:result-type</span> <span class="at">:as-seq</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>(</p><div style="margin-left:10%;width:110%;"><div class="clay-dataset"><p>Group: true [3 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: false [6 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div></div><p>)</p></div>
</div>
<hr>
<p><code>juxt</code> is also helpful</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb103"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>(tc/group-by DS (<span class="kw">juxt</span> <span class="at">:V1</span> <span class="at">:V3</span>) {<span class="at">:result-type</span> <span class="at">:as-seq</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>(</p><div style="margin-left:10%;width:110%;"><div class="clay-dataset"><p>Group: [1 0.5] [2 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: [2 1.0] [2 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: [1 1.5] [2 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: [2 0.5] [1 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: [1 1.0] [1 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: [2 1.5] [1 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div></div><p>)</p></div>
</div>
<hr>
<p><code>tech.ml.dataset</code> provides an option to limit columns which are passed to grouping functions. It’s done for performance purposes.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb104"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>(tc/group-by DS <span class="kw">identity</span> {<span class="at">:result-type</span> <span class="at">:as-seq</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">:select-keys</span> [<span class="at">:V1</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>(</p><div style="margin-left:10%;width:110%;"><div class="clay-dataset"><p>Group: {:V1 1} [5 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div><div class="clay-dataset"><p>Group: {:V1 2} [4 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div></div><p>)</p></div>
</div>
</section>
<section id="ungrouping" class="level4">
<h4 class="anchored" data-anchor-id="ungrouping">Ungrouping</h4>
<p>Ungrouping simply concats all the groups into the dataset. Following options are possible</p>
<ul>
<li><code>:order?</code> - order groups according to the group name ascending order. Default: <code>false</code></li>
<li><code>:add-group-as-column</code> - should group name become a column? If yes column is created with provided name (or <code>:$group-name</code> if argument is <code>true</code>). Default: <code>nil</code>.</li>
<li><code>:add-group-id-as-column</code> - should group id become a column? If yes column is created with provided name (or <code>:$group-id</code> if argument is <code>true</code>). Default: <code>nil</code>.</li>
<li><code>:dataset-name</code> - to name resulting dataset. Default: <code>nil</code> (_unnamed)</li>
</ul>
<p>If group name is a map, it will be splitted into separate columns. Be sure that groups (subdatasets) doesn’t contain the same columns already.</p>
<p>If group name is a vector, it will be splitted into separate columns. If you want to name them, set vector of target column names as <code>:add-group-as-column</code> argument.</p>
<p>After ungrouping, order of the rows is kept within the groups but groups are ordered according to the internal storage.</p>
<hr>
<p>Grouping and ungrouping.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb105"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V3</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Groups sorted by group name and named.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb106"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V3</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup {<span class="at">:order</span>? <span class="va">true</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:dataset-name</span> <span class="st">"Ordered by V3"</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>Ordered by V3 [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Groups sorted descending by group name and named.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb107"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V3</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup {<span class="at">:order</span>? <span class="at">:desc</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:dataset-name</span> <span class="st">"Ordered by V3 descending"</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>Ordered by V3 descending [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Let’s add group name and id as additional columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb108"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by (<span class="kw">comp</span> #(<span class="kw">&lt;</span> <span class="va">%</span> <span class="dv">4</span>) <span class="at">:V2</span>))</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup {<span class="at">:add-group-as-column</span> <span class="va">true</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:add-group-id-as-column</span> <span class="va">true</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 6]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:<span class="math inline">\(group-name | :\)</span>group-id</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th style="text-align: right;">:V4</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>true</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td>true</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td>true</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td>false</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td>false</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td>false</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td>false</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td>false</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td>false</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Let’s assign different column names</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb109"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by (<span class="kw">comp</span> #(<span class="kw">&lt;</span> <span class="va">%</span> <span class="dv">4</span>) <span class="at">:V2</span>))</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup {<span class="at">:add-group-as-column</span> <span class="st">"Is V2 less than 4?"</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:add-group-id-as-column</span> <span class="st">"group id"</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 6]:</p>
<table class="table">
<thead>
<tr class="header">
<th>Is V2 less than 4?</th>
<th style="text-align: right;">group id</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>true</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td>true</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td>true</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td>false</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td>false</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td>false</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td>false</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td>false</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td>false</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>If we group by map, we can automatically create new columns out of group names.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb110"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by (<span class="kw">fn</span> [row] {<span class="st">"V1 and V3 multiplied"</span> (<span class="kw">*</span> (<span class="at">:V1</span> row)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>                                                      (<span class="at">:V3</span> row))</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"V4 as lowercase"</span> (clojure.string/lower-case (<span class="at">:V4</span> row))}))</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup {<span class="at">:add-group-as-column</span> <span class="va">true</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 6]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">V1 and V3 multiplied</th>
<th>V4 as lowercase</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>a</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5</td>
<td>a</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td>b</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td>b</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.5</td>
<td>c</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>c</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td>a</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.0</td>
<td>c</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>We can add group names without separation</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb111"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by (<span class="kw">fn</span> [row] {<span class="st">"V1 and V3 multiplied"</span> (<span class="kw">*</span> (<span class="at">:V1</span> row)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>                                                      (<span class="at">:V3</span> row))</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"V4 as lowercase"</span> (clojure.string/lower-case (<span class="at">:V4</span> row))}))</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup {<span class="at">:add-group-as-column</span> <span class="st">"just map"</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:separate</span>? <span class="va">false</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<colgroup>
<col style="width: 70%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th>just map</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>{V1 and V3 multiplied 0.5, V4 as lowercase a}</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td>{V1 and V3 multiplied 0.5, V4 as lowercase a}</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td>{V1 and V3 multiplied 2.0, V4 as lowercase b}</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td>{V1 and V3 multiplied 2.0, V4 as lowercase b}</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td>{V1 and V3 multiplied 1.5, V4 as lowercase c}</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td>{V1 and V3 multiplied 1.5, V4 as lowercase c}</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td>{V1 and V3 multiplied 1.0, V4 as lowercase a}</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td>{V1 and V3 multiplied 1.0, V4 as lowercase b}</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td>{V1 and V3 multiplied 3.0, V4 as lowercase c}</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>The same applies to group names as sequences</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb112"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by (<span class="kw">juxt</span> <span class="at">:V1</span> <span class="at">:V3</span>))</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup {<span class="at">:add-group-as-column</span> <span class="st">"abc"</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 6]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:abc-0</th>
<th style="text-align: right;">:abc-1</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Let’s provide column names</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb113"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by (<span class="kw">juxt</span> <span class="at">:V1</span> <span class="at">:V3</span>))</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup {<span class="at">:add-group-as-column</span> [<span class="st">"v1"</span> <span class="st">"v3"</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 6]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">v1</th>
<th style="text-align: right;">v3</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Also we can supress separation</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb114"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by (<span class="kw">juxt</span> <span class="at">:V1</span> <span class="at">:V3</span>))</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup {<span class="at">:separate</span>? <span class="va">false</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:add-group-as-column</span> <span class="va">true</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:$group-name</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1 0.5]</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td>[1 0.5]</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td>[2 1.0]</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td>[2 1.0]</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td>[1 1.5]</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td>[1 1.5]</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td>[2 0.5]</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td>[1 1.0]</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td>[2 1.5]</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="other-functions" class="level4">
<h4 class="anchored" data-anchor-id="other-functions">Other functions</h4>
<p>To check if dataset is grouped or not just use <code>grouped?</code> function.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb115"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>(tc/grouped? DS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb116"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb117"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>(tc/grouped? (tc/group-by DS <span class="at">:V1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb118"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="va">true</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>If you want to remove grouping annotation (to make all the functions work as with regular dataset) you can use <code>unmark-group</code> or <code>as-regular-dataset</code> (alias) functions.</p>
<p>It can be important when you want to remove some groups (rows) from grouped dataset using <code>drop-rows</code> or something like that.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb119"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V1</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>    (tc/as-regular-dataset)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>    (tc/grouped?))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb120"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also operate on grouped dataset as a regular one in case you want to access its columns using <code>without-grouping-&gt;</code> threading macro.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb121"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span> <span class="at">:V1</span>])</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>    (tc/without-grouping-&gt;</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>     (tc/order-by (<span class="kw">comp</span> (<span class="kw">juxt</span> <span class="at">:V4</span> <span class="at">:V1</span>) <span class="at">:name</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:name</th>
<th style="text-align: right;">:group-id</th>
<th>:data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>{:V4 A, :V1 1}</td>
<td style="text-align: right;">0</td>
<td>Group: {:V4 “A”, :V1 1} [2 4]:</td>
</tr>
<tr class="even">
<td>{:V4 A, :V1 2}</td>
<td style="text-align: right;">3</td>
<td>Group: {:V4 “A”, :V1 2} [1 4]:</td>
</tr>
<tr class="odd">
<td>{:V4 B, :V1 1}</td>
<td style="text-align: right;">4</td>
<td>Group: {:V4 “B”, :V1 1} [1 4]:</td>
</tr>
<tr class="even">
<td>{:V4 B, :V1 2}</td>
<td style="text-align: right;">1</td>
<td>Group: {:V4 “B”, :V1 2} [2 4]:</td>
</tr>
<tr class="odd">
<td>{:V4 C, :V1 1}</td>
<td style="text-align: right;">2</td>
<td>Group: {:V4 “C”, :V1 1} [2 4]:</td>
</tr>
<tr class="even">
<td>{:V4 C, :V1 2}</td>
<td style="text-align: right;">5</td>
<td>Group: {:V4 “C”, :V1 2} [1 4]:</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>This is considered internal.</p>
<p>If you want to implement your own mapping function on grouped dataset you can call <code>process-group-data</code> and pass function operating on datasets. Result should be a dataset to have ungrouping working.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb122"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V1</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    (tc/process-group-data #(<span class="kw">str</span> <span class="st">"Shape: "</span> (<span class="kw">vector</span> (tc/row-count <span class="va">%</span>) (tc/column-count <span class="va">%</span>))))</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    (tc/as-regular-dataset))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:name</th>
<th style="text-align: right;">:group-id</th>
<th>:data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>Shape: [5 4]</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td>Shape: [4 4]</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="columns" class="level3">
<h3 class="anchored" data-anchor-id="columns">Columns</h3>
<p>Column is a special <code>tech.ml.dataset</code> structure. For our purposes we cat treat columns as typed and named sequence bound to particular dataset.</p>
<p>Type of the data is inferred from a sequence during column creation.</p>
<section id="names" class="level4">
<h4 class="anchored" data-anchor-id="names">Names</h4>
<p>To select dataset columns or column names <code>columns-selector</code> is used. <code>columns-selector</code> can be one of the following:</p>
<ul>
<li><code>:all</code> keyword - selects all columns</li>
<li>column name - for single column</li>
<li>sequence of column names - for collection of columns</li>
<li>regex - to apply pattern on column names or datatype</li>
<li>filter predicate - to filter column names or datatype</li>
<li><code>type</code> namespaced keyword for specific datatype or group of datatypes</li>
</ul>
<p>Column name can be anything.</p>
<p><code>column-names</code> function returns names according to <code>columns-selector</code> and optional <code>meta-field</code>. <code>meta-field</code> is one of the following:</p>
<ul>
<li><code>:name</code> (default) - to operate on column names</li>
<li><code>:datatype</code> - to operated on column types</li>
<li><code>:all</code> - if you want to process all metadata</li>
</ul>
<p>Datatype groups are:</p>
<ul>
<li><code>:type/numerical</code> - any numerical type</li>
<li><code>:type/float</code> - floating point number (<code>:float32</code> and <code>:float64</code>)</li>
<li><code>:type/integer</code> - any integer</li>
<li><code>:type/datetime</code> - any datetime type</li>
</ul>
<p>If qualified keyword starts with <code>:!type</code>, complement set is used.</p>
<hr>
<p>To select all column names you can use <code>column-names</code> function.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb123"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names DS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb124"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V3</span> <span class="at">:V4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb125"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names DS <span class="at">:all</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb126"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V3</span> <span class="at">:V4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In case you want to select column which has name <code>:all</code> (or is sequence or map), put it into a vector. Below code returns empty sequence since there is no such column in the dataset.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb127"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names DS [<span class="at">:all</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb128"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Obviously selecting single name returns it’s name if available</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb129"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names DS <span class="at">:V1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb130"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:V1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb131"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names DS <span class="st">"no such column"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb132"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Select sequence of column names.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb133"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names DS [<span class="at">:V1</span> <span class="st">"V2"</span> <span class="at">:V3</span> <span class="at">:V4</span> <span class="at">:V5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb134"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:V1</span> <span class="at">:V3</span> <span class="at">:V4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Select names based on regex, columns ends with <code>1</code> or <code>4</code></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb135"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names DS <span class="ss">#".*[14]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb136"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:V1</span> <span class="at">:V4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Select names based on regex operating on type of the column (to check what are the column types, call <code>(tc/info DS :columns)</code>. Here we want to get integer columns only.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb137"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names DS <span class="ss">#"^:int.*"</span> <span class="at">:datatype</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb138"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:V1</span> <span class="at">:V2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb139"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names DS <span class="at">:type/integer</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb140"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:V1</span> <span class="at">:V2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>And finally we can use predicate to select names. Let’s select double precision columns.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb141"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names DS #{<span class="at">:float64</span>} <span class="at">:datatype</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb142"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:V3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb143"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names DS <span class="at">:type/float64</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb144"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:V3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>If you want to select all columns but given, use <code>complement</code> function. Works only on a predicate.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb145"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names DS (<span class="kw">complement</span> #{<span class="at">:V1</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb146"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:V2</span> <span class="at">:V3</span> <span class="at">:V4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb147"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names DS (<span class="kw">complement</span> #{<span class="at">:float64</span>}) <span class="at">:datatype</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb148"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb149"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names DS :!type/float64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb150"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>You can select column names based on all column metadata at once by using <code>:all</code> metadata selector. Below we want to select column names ending with <code>1</code> which have <code>long</code> datatype.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb151"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>(tc/column-names DS (<span class="kw">fn</span> [<span class="kw">meta</span>]</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>                       (<span class="kw">and</span> (<span class="kw">=</span> <span class="at">:int64</span> (<span class="at">:datatype</span> <span class="kw">meta</span>))</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>                            (clojure.string/ends-with? (<span class="at">:name</span> <span class="kw">meta</span>) <span class="st">"1"</span>))) <span class="at">:all</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb152"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:V1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="select" class="level4">
<h4 class="anchored" data-anchor-id="select">Select</h4>
<p><code>select-columns</code> creates dataset with columns selected by <code>columns-selector</code> as described above. Function works on regular and grouped dataset.</p>
<hr>
<p>Select only float64 columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb153"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>(tc/select-columns DS #(<span class="kw">=</span> <span class="at">:float64</span> <span class="va">%</span>) <span class="at">:datatype</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.5</td>
</tr>
</tbody>
</table>
</div>
<p>or</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb154"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>(tc/select-columns DS <span class="at">:type/float64</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Select all but <code>:V1</code> columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb155"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>(tc/select-columns DS (<span class="kw">complement</span> #{<span class="at">:V1</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>If we have grouped data set, column selection is applied to every group separately.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb156"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V1</span>)</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns [<span class="at">:V2</span> <span class="at">:V3</span>])</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>    (tc/groups-&gt;map))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>{</p><div style="margin-left:10%;width:110%;">
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>1</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: 1 [5 2]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>2</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: 2 [4 2]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
</div><p>}</p></div>
</div>
</section>
<section id="drop" class="level4">
<h4 class="anchored" data-anchor-id="drop">Drop</h4>
<p><code>drop-columns</code> creates dataset with removed columns.</p>
<hr>
<p>Drop float64 columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb159"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>(tc/drop-columns DS #(<span class="kw">=</span> <span class="at">:float64</span> <span class="va">%</span>) <span class="at">:datatype</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<p>or</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb160"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>(tc/drop-columns DS <span class="at">:type/float64</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Drop all columns but <code>:V1</code> and <code>:V2</code></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb161"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>(tc/drop-columns DS (<span class="kw">complement</span> #{<span class="at">:V1</span> <span class="at">:V2</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>If we have grouped data set, column selection is applied to every group separately. Selected columns are dropped.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb162"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V1</span>)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>    (tc/drop-columns [<span class="at">:V2</span> <span class="at">:V3</span>])</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>    (tc/groups-&gt;map))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>{</p><div style="margin-left:10%;width:110%;">
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>1</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: 1 [5 2]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>2</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: 2 [4 2]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th data-quarto-table-cell-role="th">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
</div><p>}</p></div>
</div>
</section>
<section id="rename" class="level4">
<h4 class="anchored" data-anchor-id="rename">Rename</h4>
<p>If you want to rename colums use <code>rename-columns</code> and pass map where keys are old names, values new ones.</p>
<p>You can also pass mapping function with optional columns-selector</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb165"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>(tc/rename-columns DS {<span class="at">:V1</span> <span class="st">"v1"</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">:V2</span> <span class="st">"v2"</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">:V3</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>]</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">:V4</span> (Object.)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">v1</th>
<th style="text-align: right;">v2</th>
<th style="text-align: right;">[1 2 3]</th>
<th>java.lang.Object@681d3bce</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Map all names with function</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb166"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>(tc/rename-columns DS (<span class="kw">comp</span> <span class="kw">str</span> <span class="kw">second</span> <span class="kw">name</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">1</th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Map selected names with function</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb167"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>(tc/rename-columns DS [<span class="at">:V1</span> <span class="at">:V3</span>] (<span class="kw">comp</span> <span class="kw">str</span> <span class="kw">second</span> <span class="kw">name</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Function works on grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb168"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V1</span>)</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>    (tc/rename-columns {<span class="at">:V1</span> <span class="st">"v1"</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">:V2</span> <span class="st">"v2"</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">:V3</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>]</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">:V4</span> (Object.)})</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>    (tc/groups-&gt;map))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>{</p><div style="margin-left:10%;width:110%;">
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>1</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: 1 [5 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">v1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">v2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">[1 2 3]</th>
<th data-quarto-table-cell-role="th">java.lang.Object@458de26a</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>2</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: 2 [4 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">v1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">v2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">[1 2 3]</th>
<th data-quarto-table-cell-role="th">java.lang.Object@458de26a</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
</div><p>}</p></div>
</div>
</section>
<section id="add-or-update" class="level4">
<h4 class="anchored" data-anchor-id="add-or-update">Add or update</h4>
<p>To add (or replace existing) column call <code>add-column</code> function. Function accepts:</p>
<ul>
<li><code>ds</code> - a dataset</li>
<li><code>column-name</code> - if it’s existing column name, column will be replaced</li>
<li><code>column</code> - can be column (from other dataset), sequence, single value or function. Too big columns are always trimmed. Too small are cycled or extended with missing values (according to <code>size-strategy</code> argument)</li>
<li><code>size-strategy</code> (optional) - when new column is shorter than dataset row count, following strategies are applied:
<ul>
<li><code>:cycle</code> - repeat data</li>
<li><code>:na</code> - append missing values</li>
<li><code>:strict</code> - (default) throws an exception when sizes mismatch</li>
</ul></li>
</ul>
<p>Function works on grouped dataset.</p>
<hr>
<p>Add single value as column</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb171"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>(tc/add-column DS <span class="at">:V5</span> <span class="st">"X"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th>:V5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td>X</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Replace one column (column is trimmed)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb172"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>(tc/add-column DS <span class="at">:V1</span> (<span class="kw">repeatedly</span> <span class="kw">rand</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.16311591</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.93869434</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.68946876</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.13585414</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.95914916</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.54901221</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.13154249</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.06481602</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.92547268</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Copy column</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb173"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>(tc/add-column DS <span class="at">:V5</span> (DS <span class="at">:V1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th style="text-align: right;">:V5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>When function is used, argument is whole dataset and the result should be column, sequence or single value</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb174"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>(tc/add-column DS <span class="at">:row-count</span> tc/row-count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th style="text-align: right;">:row-count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Above example run on grouped dataset, applies function on each group separately.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb175"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V1</span>)</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>    (tc/add-column <span class="at">:row-count</span> tc/row-count)</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th style="text-align: right;">:row-count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>When column which is added is longer than row count in dataset, column is trimmed. When column is shorter, it’s cycled or missing values are appended.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb176"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>(tc/add-column DS <span class="at">:V5</span> [<span class="at">:r</span> <span class="at">:b</span>] <span class="at">:cycle</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th>:V5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td>:r</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td>:b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td>:r</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td>:b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td>:r</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td>:b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td>:r</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td>:b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td>:r</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb177"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>(tc/add-column DS <span class="at">:V5</span> [<span class="at">:r</span> <span class="at">:b</span>] <span class="at">:na</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th>:V5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td>:r</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td>:b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>Exception is thrown when <code>:strict</code> (default) strategy is used and column size is not equal row count</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb178"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">try</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  (tc/add-column DS <span class="at">:V5</span> [<span class="at">:r</span> <span class="at">:b</span>])</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">catch</span> Exception <span class="kw">e</span> (<span class="kw">str</span> <span class="st">"Exception caught: "</span>(ex-message <span class="kw">e</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb179"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="st">"Exception caught: Column size (2) should be exactly the same as dataset row count (9). Consider `:cycle` or `:na` strategy."</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Tha same applies for grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb180"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V3</span>)</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>    (tc/add-column <span class="at">:V5</span> [<span class="at">:r</span> <span class="at">:b</span>] <span class="at">:na</span>)</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th>:V5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td>:r</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td>:b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td>:r</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td>:b</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td>:r</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td>:b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Let’s use other column to fill groups</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb181"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V3</span>)</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>    (tc/add-column <span class="at">:V5</span> (DS <span class="at">:V2</span>) <span class="at">:cycle</span>)</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th style="text-align: right;">:V5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>In case you want to add or update several columns you can call <code>add-columns</code> and provide map where keys are column names, vals are columns.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb182"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>(tc/add-columns DS {<span class="at">:V1</span> #(<span class="kw">map</span> <span class="kw">inc</span> (<span class="va">%</span> <span class="at">:V1</span>))</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">:V5</span> #(<span class="kw">map</span> (<span class="kw">comp</span> <span class="kw">keyword</span> <span class="kw">str</span>) (<span class="va">%</span> <span class="at">:V4</span>))</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">:V6</span> <span class="dv">11</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 6]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th>:V5</th>
<th style="text-align: right;">:V6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td>:A</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td>:B</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td>:C</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td>:A</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td>:B</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td>:C</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td>:A</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td>:B</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td>:C</td>
<td style="text-align: right;">11</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="update" class="level4">
<h4 class="anchored" data-anchor-id="update">Update</h4>
<p>If you want to modify specific column(s) you can call <code>update-columns</code>. Arguments:</p>
<ul>
<li>dataset</li>
<li>one of:
<ul>
<li><code>columns-selector</code> and function (or sequence of functions)</li>
<li>map where keys are column names and vals are function</li>
</ul></li>
</ul>
<p>Functions accept column and have to return column or sequence</p>
<hr>
<p>Reverse of columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb183"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>(tc/update-columns DS <span class="at">:all</span> <span class="kw">reverse</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Apply dec/inc on numerical columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb184"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>(tc/update-columns DS <span class="at">:type/numerical</span> [(<span class="kw">partial</span> <span class="kw">map</span> <span class="kw">dec</span>)</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>                                        (<span class="kw">partial</span> <span class="kw">map</span> <span class="kw">inc</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">-0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">-0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>You can also assign a function to a column by packing operations into the map.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb185"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>(tc/update-columns DS {<span class="at">:V1</span> <span class="kw">reverse</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">:V2</span> (<span class="kw">comp</span> shuffle <span class="kw">seq</span>)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="map" class="level4">
<h4 class="anchored" data-anchor-id="map">Map</h4>
<p>The other way of creating or updating column is to map rows as regular <code>map</code> function. The arity of mapping function should be the same as number of selected columns.</p>
<p>Arguments:</p>
<ul>
<li><code>ds</code> - dataset</li>
<li><code>column-name</code> - target column name</li>
<li><code>columns-selector</code> - columns selected</li>
<li><code>map-fn</code> - mapping function</li>
</ul>
<hr>
<p>Let’s add numerical columns together</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb186"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>(tc/map-columns DS</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:sum-of-numbers</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>                 (tc/column-names DS  #{<span class="at">:int64</span> <span class="at">:float64</span>} <span class="at">:datatype</span>)</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>                 (<span class="kw">fn</span> [&amp; rows]</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>                   (<span class="kw">reduce</span> <span class="kw">+</span> rows)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th style="text-align: right;">:sum-of-numbers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">2.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">5.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">6.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">7.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">9.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">11.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">11.5</td>
</tr>
</tbody>
</table>
</div>
<p>The same works on grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb187"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>    (tc/map-columns <span class="at">:sum-of-numbers</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>                     (tc/column-names DS  #{<span class="at">:int64</span> <span class="at">:float64</span>} <span class="at">:datatype</span>)</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>                     (<span class="kw">fn</span> [&amp; rows]</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>                       (<span class="kw">reduce</span> <span class="kw">+</span> rows)))</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th style="text-align: right;">:sum-of-numbers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">2.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">6.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">7.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">11.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">5.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">9.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">11.5</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="reorder" class="level4">
<h4 class="anchored" data-anchor-id="reorder">Reorder</h4>
<p>To reorder columns use columns selectors to choose what columns go first. The unseleted columns are appended to the end.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb188"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>(tc/reorder-columns DS <span class="at">:V4</span> [<span class="at">:V3</span> <span class="at">:V2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V3</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>This function doesn’t let you select meta field, so you have to call <code>column-names</code> in such case. Below we want to add integer columns at the end.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb189"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>(tc/reorder-columns DS (tc/column-names DS (<span class="kw">complement</span> #{<span class="at">:int64</span>}) <span class="at">:datatype</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="type-conversion" class="level4">
<h4 class="anchored" data-anchor-id="type-conversion">Type conversion</h4>
<p>To convert column into given datatype can be done using <code>convert-types</code> function. Not all the types can be converted automatically also some types require slow parsing (every conversion from string). In case where conversion is not possible you can pass conversion function.</p>
<p>Arguments:</p>
<ul>
<li><code>ds</code> - dataset</li>
<li>Two options:
<ul>
<li><code>coltype-map</code> in case when you want to convert several columns, keys are column names, vals are new types</li>
<li><code>column-selector</code> and <code>new-types</code> - column name and new datatype (or datatypes as sequence)</li>
</ul></li>
</ul>
<p><code>new-types</code> can be:</p>
<ul>
<li>a type like <code>:int64</code> or <code>:string</code> or sequence of types</li>
<li>or sequence of pair of datetype and conversion function</li>
</ul>
<p>After conversion additional infomation is given on problematic values.</p>
<p>The other conversion is casting column into java array (<code>-&gt;array</code>) of the type column or provided as argument. Grouped dataset returns sequence of arrays.</p>
<hr>
<p>Basic conversion</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb190"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>    (tc/convert-types <span class="at">:V1</span> <span class="at">:float64</span>)</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>    (tc/info <span class="at">:columns</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed :column info [4 6]:</p>
<table class="table">
<colgroup>
<col style="width: 8%">
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 24%">
<col style="width: 20%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th>:name</th>
<th>:datatype</th>
<th style="text-align: right;">:n-elems</th>
<th>:unparsed-indexes</th>
<th>:unparsed-data</th>
<th>:categorical?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:V1</td>
<td>:float64</td>
<td style="text-align: right;">9</td>
<td>{}</td>
<td>[]</td>
<td></td>
</tr>
<tr class="even">
<td>:V2</td>
<td>:int64</td>
<td style="text-align: right;">9</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>:V3</td>
<td>:float64</td>
<td style="text-align: right;">9</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>:V4</td>
<td>:string</td>
<td style="text-align: right;">9</td>
<td></td>
<td></td>
<td>true</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Using custom converter. Let’s treat <code>:V4</code> as haxadecimal values. See that this way we can map column to any value.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb191"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>    (tc/convert-types <span class="at">:V4</span> [[<span class="at">:int16</span> #(Integer/parseInt <span class="va">%</span> <span class="dv">16</span>)]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th style="text-align: right;">:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">12</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>You can process several columns at once</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb192"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>    (tc/convert-types {<span class="at">:V1</span> <span class="at">:float64</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">:V2</span> <span class="at">:object</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">:V3</span> [<span class="at">:boolean</span> #(<span class="kw">&lt;</span> <span class="va">%</span> <span class="fl">1.0</span>)]</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">:V4</span> <span class="at">:object</span>})</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>    (tc/info <span class="at">:columns</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed :column info [4 6]:</p>
<table class="table">
<colgroup>
<col style="width: 8%">
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 24%">
<col style="width: 20%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th>:name</th>
<th>:datatype</th>
<th style="text-align: right;">:n-elems</th>
<th>:unparsed-indexes</th>
<th>:unparsed-data</th>
<th>:categorical?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:V1</td>
<td>:float64</td>
<td style="text-align: right;">9</td>
<td>{}</td>
<td>[]</td>
<td></td>
</tr>
<tr class="even">
<td>:V2</td>
<td>:object</td>
<td style="text-align: right;">9</td>
<td>{}</td>
<td>[]</td>
<td>true</td>
</tr>
<tr class="odd">
<td>:V3</td>
<td>:boolean</td>
<td style="text-align: right;">9</td>
<td>{}</td>
<td>[]</td>
<td></td>
</tr>
<tr class="even">
<td>:V4</td>
<td>:object</td>
<td style="text-align: right;">9</td>
<td></td>
<td></td>
<td>true</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Convert one type into another</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb193"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>    (tc/convert-types <span class="at">:type/numerical</span> <span class="at">:int16</span>)</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>    (tc/info <span class="at">:columns</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed :column info [4 6]:</p>
<table class="table">
<colgroup>
<col style="width: 8%">
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 24%">
<col style="width: 20%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th>:name</th>
<th>:datatype</th>
<th style="text-align: right;">:n-elems</th>
<th>:unparsed-indexes</th>
<th>:unparsed-data</th>
<th>:categorical?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:V1</td>
<td>:int16</td>
<td style="text-align: right;">9</td>
<td>{}</td>
<td>[]</td>
<td></td>
</tr>
<tr class="even">
<td>:V2</td>
<td>:int16</td>
<td style="text-align: right;">9</td>
<td>{}</td>
<td>[]</td>
<td></td>
</tr>
<tr class="odd">
<td>:V3</td>
<td>:int16</td>
<td style="text-align: right;">9</td>
<td>{}</td>
<td>[]</td>
<td></td>
</tr>
<tr class="even">
<td>:V4</td>
<td>:string</td>
<td style="text-align: right;">9</td>
<td></td>
<td></td>
<td>true</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Function works on the grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb194"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V1</span>)</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>    (tc/convert-types <span class="at">:V1</span> <span class="at">:float32</span>)</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup)</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>    (tc/info <span class="at">:columns</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed :column info [4 6]:</p>
<table class="table">
<colgroup>
<col style="width: 8%">
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 24%">
<col style="width: 20%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th>:name</th>
<th>:datatype</th>
<th style="text-align: right;">:n-elems</th>
<th>:unparsed-indexes</th>
<th>:unparsed-data</th>
<th>:categorical?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:V1</td>
<td>:float32</td>
<td style="text-align: right;">9</td>
<td>{}</td>
<td>[]</td>
<td></td>
</tr>
<tr class="even">
<td>:V2</td>
<td>:int64</td>
<td style="text-align: right;">9</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>:V3</td>
<td>:float64</td>
<td style="text-align: right;">9</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>:V4</td>
<td>:string</td>
<td style="text-align: right;">9</td>
<td></td>
<td></td>
<td>true</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Double array conversion.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb195"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>(tc/-&gt;array DS <span class="at">:V1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb196"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Function also works on grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb197"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V3</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>    (tc/-&gt;array <span class="at">:V2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb198"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>([<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>] [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>] [<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>You can also cast the type to the other one (if casting is possible):</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb199"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>(tc/-&gt;array DS <span class="at">:V4</span> <span class="at">:string</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb200"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>[<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb201"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>(tc/-&gt;array DS <span class="at">:V1</span> <span class="at">:float32</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb202"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>[<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="column-operations" class="level3">
<h3 class="anchored" data-anchor-id="column-operations">Column Operations</h3>
<p>There are a large number of column operations that can be performed on the columns in your dataset. These operations are a similar set as the <a href="#operations">Column API operations</a>, but instead of operating directly on columns, they take a Dataset and a <a href="#names"><code>columns-selector</code></a>.</p>
<p>The behavior of the operations differ based on their return value:</p>
<ul>
<li><p>If an operation would return a scalar value, then the function behaves like an aggregator and can be used in group-by expresesions. Such functions will have the general signature:</p>
<pre><code>(dataset columns-selector) =&gt; dataset</code></pre></li>
<li><p>If an operation would return another column, then the function will not behave like an aggregator. Instead, it asks you to specify a target column, which it will add to the dataset that it returns. The signature of these functions is:</p>
<pre><code>(ds target-col columns-selector) =&gt; dataset</code></pre></li>
</ul>
<p>As there are a large number of operations, we will illustrate their usage. To begin with, here are some examples of operations whose result is a new column:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb205"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb206"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>    (tc/+ <span class="at">:SUM</span> [<span class="at">:V1</span> <span class="at">:V2</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th style="text-align: right;">:SUM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb207"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>    (tc/* <span class="at">:MULTIPY</span> [<span class="at">:V1</span> <span class="at">:V2</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th style="text-align: right;">:MULTIPY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<p>Now let’s look at operations that would return a scalar:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb208"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>    (tc/mean [<span class="at">:V1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.44444444</td>
</tr>
</tbody>
</table>
</div>
<p>Notice that we did not supply a target column to the <code>mean</code> function. Since <code>mean</code> does not return a column, we do not provide this argument. Instead, we simply provide the dataset and a <code>columns-selector.</code> We then get back a dataset with the result.</p>
<p>Now let’s use this function within a grouping expression:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb209"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span>])</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>    (tc/mean [<span class="at">:V2</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">4.0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">6.0</td>
</tr>
</tbody>
</table>
</div>
<p>In this example, we grouped <code>DS</code> and then passed the resulting grouped Dataset directly to the <code>mean</code> operation. Since <code>mean</code> returns a scalar, it operates as an aggregator, summarizing the results of each group.</p>
</section>
<section id="rows" class="level3">
<h3 class="anchored" data-anchor-id="rows">Rows</h3>
<p>Rows can be selected or dropped using various selectors:</p>
<ul>
<li>row id(s) - row index as number or seqence of numbers (first row has index <code>0</code>, second <code>1</code> and so on)</li>
<li>sequence of true/false values</li>
<li>filter by predicate (argument is row as a map)</li>
</ul>
<p>When predicate is used you may want to limit columns passed to the function (<code>select-keys</code> option).</p>
<p>Additionally you may want to precalculate some values which will be visible for predicate as additional columns. It’s done internally by calling <code>add-columns</code> on a dataset. <code>:pre</code> is used as a column definitions.</p>
<section id="select-1" class="level4">
<h4 class="anchored" data-anchor-id="select-1">Select</h4>
<p>Select fifth row</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb210"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows DS <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Select 3 rows</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb211"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows DS [<span class="dv">1</span> <span class="dv">4</span> <span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Select rows using sequence of true/false values</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb212"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows DS [<span class="va">true</span> <span class="va">nil</span> <span class="va">nil</span> <span class="va">true</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Select rows using predicate</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb213"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows DS (<span class="kw">comp</span> #(<span class="kw">&lt;</span> <span class="va">%</span> <span class="dv">1</span>) <span class="at">:V3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>The same works on grouped dataset, let’s select first row from every group.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb214"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V1</span>)</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows <span class="dv">0</span>)</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>If you want to select <code>:V2</code> values which are lower than or equal mean in grouped dataset you have to precalculate it using <code>:pre</code>.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb215"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows (<span class="kw">fn</span> [row] (<span class="kw">&lt;=</span> (<span class="at">:V2</span> row) (<span class="at">:mean</span> row)))</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>                     {<span class="at">:pre</span> {<span class="at">:mean</span> #(tech.v3.datatype.functional/mean (<span class="va">%</span> <span class="at">:V2</span>))}})</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="drop-1" class="level4">
<h4 class="anchored" data-anchor-id="drop-1">Drop</h4>
<p><code>drop-rows</code> removes rows, and accepts exactly the same parameters as <code>select-rows</code></p>
<hr>
<p>Drop values lower than or equal <code>:V2</code> column mean in grouped dataset.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb216"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>    (tc/drop-rows (<span class="kw">fn</span> [row] (<span class="kw">&lt;=</span> (<span class="at">:V2</span> row) (<span class="at">:mean</span> row)))</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>                   {<span class="at">:pre</span> {<span class="at">:mean</span> #(tech.v3.datatype.functional/mean (<span class="va">%</span> <span class="at">:V2</span>))}})</span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="map-rows" class="level4">
<h4 class="anchored" data-anchor-id="map-rows">Map rows</h4>
<p>Call a mapping function for every row. Mapping function should return a map, where keys are column names (new or old) and values are column values.</p>
<p>Works on grouped dataset too.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb217"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>(tc/map-rows DS (<span class="kw">fn</span> [{<span class="at">:keys</span> [V1 V2]}] {<span class="at">:V1</span> <span class="dv">0</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">:V5</span> (<span class="kw">/</span> (<span class="kw">+</span> V1 V2) (<span class="kw">double</span> V2))}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th style="text-align: right;">:V5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">2.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">2.00000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">1.33333333</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">1.50000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">1.20000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">1.33333333</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">1.14285714</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">1.25000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">1.11111111</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="other" class="level4">
<h4 class="anchored" data-anchor-id="other">Other</h4>
<p>There are several function to select first, last, random rows, or display head, tail of the dataset. All functions work on grouped dataset.</p>
<p>All random functions accept <code>:seed</code> as an option if you want to fix returned result.</p>
<hr>
<p>First row</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb218"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>(tc/first DS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Last row</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb219"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>(tc/last DS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Random row (single)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb220"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>(tc/rand-nth DS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Random row (single) with seed</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb221"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>(tc/rand-nth DS {<span class="at">:seed</span> <span class="dv">42</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Random <code>n</code> (default: row count) rows with repetition.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb222"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>(tc/random DS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Five random rows with repetition</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb223"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>(tc/random DS <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Five random, non-repeating rows</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb224"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>(tc/random DS <span class="dv">5</span> {<span class="at">:repeat</span>? <span class="va">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Five random, with seed</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb225"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>(tc/random DS <span class="dv">5</span> {<span class="at">:seed</span> <span class="dv">42</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Shuffle dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb226"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>(tc/shuffle DS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Shuffle with seed</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb227"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>(tc/shuffle DS {<span class="at">:seed</span> <span class="dv">42</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>First <code>n</code> rows (default 5)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb228"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>(tc/head DS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Last <code>n</code> rows (default 5)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb229"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>(tc/tail DS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p><code>by-rank</code> calculates rank on column(s). It’s base on <a href="https://www.rdocumentation.org/packages/base/versions/3.6.1/topics/rank">R rank()</a> with addition of <code>:dense</code> (default) tie strategy which give consecutive rank numbering.</p>
<p><code>:desc?</code> options (default: <code>true</code>) sorts input with descending order, giving top values under <code>0</code> value.</p>
<p><code>rank</code> is zero based and is defined at <code>tablecloth.api.utils</code> namespace.</p>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb230"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>(tc/by-rank DS <span class="at">:V3</span> <span class="kw">zero?</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<p>most V3 values</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb231"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>(tc/by-rank DS <span class="at">:V3</span> <span class="kw">zero?</span> {<span class="at">:desc</span>? <span class="va">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<p>least V3 values</p>
<hr>
<p>Rank also works on multiple columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb232"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>(tc/by-rank DS [<span class="at">:V1</span> <span class="at">:V3</span>] <span class="kw">zero?</span> {<span class="at">:desc</span>? <span class="va">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Select 5 random rows from each group</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb233"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>    (tc/random <span class="dv">5</span>)</span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="aggregate" class="level3">
<h3 class="anchored" data-anchor-id="aggregate">Aggregate</h3>
<p>Aggregating is a function which produces single row out of dataset.</p>
<p>Aggregator is a function or sequence or map of functions which accept dataset as an argument and result single value, sequence of values or map.</p>
<p>Where map is given as an input or result, keys are treated as column names.</p>
<p>Grouped dataset is ungrouped after aggreation. This can be turned off by setting <code>:ungroup</code> to false. In case you want to pass additional ungrouping parameters add them to the options.</p>
<p>By default resulting column names are prefixed with <code>summary</code> prefix (set it with <code>:default-column-name-prefix</code> option).</p>
<hr>
<p>Let’s calculate mean of some columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb234"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>(tc/aggregate DS #(<span class="kw">reduce</span> <span class="kw">+</span> (<span class="va">%</span> <span class="at">:V2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">45</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Let’s give resulting column a name.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb235"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>(tc/aggregate DS {<span class="at">:sum-of-V2</span> #(<span class="kw">reduce</span> <span class="kw">+</span> (<span class="va">%</span> <span class="at">:V2</span>))})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:sum-of-V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">45</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Sequential result is spread into separate columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb236"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>(tc/aggregate DS #(<span class="kw">take</span> <span class="dv">5</span>(<span class="va">%</span> <span class="at">:V2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:summary-0</th>
<th style="text-align: right;">:summary-1</th>
<th style="text-align: right;">:summary-2</th>
<th style="text-align: right;">:summary-3</th>
<th style="text-align: right;">:summary-4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>You can combine all variants and rename default prefix</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb237"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>(tc/aggregate DS [#(<span class="kw">take</span> <span class="dv">3</span> (<span class="va">%</span> <span class="at">:V2</span>))</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>                   (<span class="kw">fn</span> [ds] {<span class="at">:sum-v1</span> (<span class="kw">reduce</span> <span class="kw">+</span> (ds <span class="at">:V1</span>))</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">:prod-v3</span> (<span class="kw">reduce</span> <span class="kw">*</span> (ds <span class="at">:V3</span>))})] {<span class="at">:default-column-name-prefix</span> <span class="st">"V2-value"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 5]:</p>
<table class="table">
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 23%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">:V2-value-0-0</th>
<th style="text-align: right;">:V2-value-0-1</th>
<th style="text-align: right;">:V2-value-0-2</th>
<th style="text-align: right;">:V2-value-1-sum-v1</th>
<th style="text-align: right;">:V2-value-1-prod-v3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.421875</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Processing grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb238"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span>])</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate [#(<span class="kw">take</span> <span class="dv">3</span> (<span class="va">%</span> <span class="at">:V2</span>))</span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>                    (<span class="kw">fn</span> [ds] {<span class="at">:sum-v1</span> (<span class="kw">reduce</span> <span class="kw">+</span> (ds <span class="at">:V1</span>))</span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">:prod-v3</span> (<span class="kw">reduce</span> <span class="kw">*</span> (ds <span class="at">:V3</span>))})] {<span class="at">:default-column-name-prefix</span> <span class="st">"V2-value"</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 6]:</p>
<table class="table">
<colgroup>
<col style="width: 5%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 21%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V2-value-0-0</th>
<th style="text-align: right;">:V2-value-0-1</th>
<th style="text-align: right;">:V2-value-0-2</th>
<th style="text-align: right;">:V2-value-1-sum-v1</th>
<th style="text-align: right;">:V2-value-1-prod-v3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.125</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3.375</td>
</tr>
</tbody>
</table>
</div>
<p>Result of aggregating is automatically ungrouped, you can skip this step by stetting <code>:ungroup</code> option to <code>false</code>.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb239"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V3</span>])</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate [#(<span class="kw">take</span> <span class="dv">3</span> (<span class="va">%</span> <span class="at">:V2</span>))</span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>                    (<span class="kw">fn</span> [ds] {<span class="at">:sum-v1</span> (<span class="kw">reduce</span> <span class="kw">+</span> (ds <span class="at">:V1</span>))</span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">:prod-v3</span> (<span class="kw">reduce</span> <span class="kw">*</span> (ds <span class="at">:V3</span>))})] {<span class="at">:default-column-name-prefix</span> <span class="st">"V2-value"</span></span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a>                                                              <span class="at">:ungroup</span>? <span class="va">false</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:name</th>
<th style="text-align: right;">:group-id</th>
<th>:data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>{:V3 0.5}</td>
<td style="text-align: right;">0</td>
<td>_unnamed [1 5]:</td>
</tr>
<tr class="even">
<td>{:V3 1.0}</td>
<td style="text-align: right;">1</td>
<td>_unnamed [1 5]:</td>
</tr>
<tr class="odd">
<td>{:V3 1.5}</td>
<td style="text-align: right;">2</td>
<td>_unnamed [1 5]:</td>
</tr>
</tbody>
</table>
</div>
<section id="column" class="level4">
<h4 class="anchored" data-anchor-id="column">Column</h4>
<p>You can perform columnar aggreagation also. <code>aggregate-columns</code> selects columns and apply aggregating function (or sequence of functions) for each column separately.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb240"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>(tc/aggregate-columns DS [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V3</span>] #(<span class="kw">reduce</span> <span class="kw">+</span> <span class="va">%</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">9.0</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb241"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>(tc/aggregate-columns DS [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V3</span>] [#(<span class="kw">reduce</span> <span class="kw">+</span> <span class="va">%</span>)</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>                                         #(<span class="kw">reduce</span> <span class="kw">max</span> <span class="va">%</span>)</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>                                         #(<span class="kw">reduce</span> <span class="kw">*</span> <span class="va">%</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.421875</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb242"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span>])</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate-columns [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V3</span>] #(<span class="kw">reduce</span> <span class="kw">+</span> <span class="va">%</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">3.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">4.5</td>
</tr>
</tbody>
</table>
</div>
<p>You can also aggregate whole dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb243"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>    (tc/drop-columns <span class="at">:V4</span>)</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate-columns #(<span class="kw">reduce</span> <span class="kw">+</span> <span class="va">%</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">9.0</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="crosstab" class="level4">
<h4 class="anchored" data-anchor-id="crosstab">Crosstab</h4>
<p>Cross tabulation built from two sets of columns. First rows and cols are used to construct grouped dataset, then aggregation function is applied for each pair. By default it counts rows from each group.</p>
<p>Options are:</p>
<ul>
<li><code>:aggregator</code> - function which aggregates values of grouped dataset, default it’s <code>row-count</code></li>
<li><code>:marginal-rows</code> and <code>:marginal-cols</code> - if true, sum of rows and cols are added as an additional columns and row. May be custom function which accepts pure row and col as a seq.</li>
<li><code>:replace-missing?</code> - should missing values be replaced (default: true) with <code>:missing-value</code> (default: 0)</li>
<li><code>:pivot?</code> - if false, flat aggregation result is returned (default: false)</li>
</ul>
<div class="sourceClojure">
<div class="sourceCode" id="cb244"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> ctds </span>(tc/dataset {<span class="at">:a</span> [<span class="at">:foo</span> <span class="at">:foo</span> <span class="at">:bar</span> <span class="at">:bar</span> <span class="at">:foo</span> <span class="at">:foo</span>]</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:b</span> [<span class="at">:one</span> <span class="at">:one</span> <span class="at">:two</span> <span class="at">:one</span> <span class="at">:two</span> <span class="at">:one</span>]</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:c</span> [<span class="at">:dull</span> <span class="at">:dull</span> <span class="at">:shiny</span> <span class="at">:dull</span> <span class="at">:dull</span> <span class="at">:shiny</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb245"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>ctds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:a</th>
<th>:b</th>
<th>:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:foo</td>
<td>:one</td>
<td>:dull</td>
</tr>
<tr class="even">
<td>:foo</td>
<td>:one</td>
<td>:dull</td>
</tr>
<tr class="odd">
<td>:bar</td>
<td>:two</td>
<td>:shiny</td>
</tr>
<tr class="even">
<td>:bar</td>
<td>:one</td>
<td>:dull</td>
</tr>
<tr class="odd">
<td>:foo</td>
<td>:two</td>
<td>:dull</td>
</tr>
<tr class="even">
<td>:foo</td>
<td>:one</td>
<td>:shiny</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb246"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>(tc/crosstab ctds <span class="at">:a</span> [<span class="at">:b</span> <span class="at">:c</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 5]:</p>
<table class="table">
<colgroup>
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 21%">
<col style="width: 20%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th>rows/cols</th>
<th style="text-align: right;">[:one :dull]</th>
<th style="text-align: right;">[:two :shiny]</th>
<th style="text-align: right;">[:two :dull]</th>
<th style="text-align: right;">[:one :shiny]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:foo</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>:bar</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>With marginals</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb247"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>(tc/crosstab ctds <span class="at">:a</span> [<span class="at">:b</span> <span class="at">:c</span>] {<span class="at">:marginal-rows</span> <span class="va">true</span> <span class="at">:marginal-cols</span> <span class="va">true</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 6]:</p>
<table class="table">
<colgroup>
<col style="width: 13%">
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>rows/cols</th>
<th style="text-align: right;">[:one :dull]</th>
<th style="text-align: right;">[:two :shiny]</th>
<th style="text-align: right;">[:two :dull]</th>
<th style="text-align: right;">[:one :shiny]</th>
<th style="text-align: right;">:summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:foo</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td>:bar</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td>:summary</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Set missing value to <code>-1</code></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb248"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>(tc/crosstab ctds <span class="at">:a</span> [<span class="at">:b</span> <span class="at">:c</span>] {<span class="at">:missing-value</span> -<span class="dv">1</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 5]:</p>
<table class="table">
<colgroup>
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 21%">
<col style="width: 20%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th>rows/cols</th>
<th style="text-align: right;">[:one :dull]</th>
<th style="text-align: right;">[:two :shiny]</th>
<th style="text-align: right;">[:two :dull]</th>
<th style="text-align: right;">[:one :shiny]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:foo</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>:bar</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Turn off pivoting</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb249"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>(tc/crosstab ctds <span class="at">:a</span> [<span class="at">:b</span> <span class="at">:c</span>] {<span class="at">:pivot</span>? <span class="va">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:rows</th>
<th>:cols</th>
<th style="text-align: right;">summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:foo</td>
<td>[:one :dull]</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td>:bar</td>
<td>[:two :shiny]</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td>:bar</td>
<td>[:one :dull]</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>:foo</td>
<td>[:two :dull]</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td>:foo</td>
<td>[:one :shiny]</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="order" class="level3">
<h3 class="anchored" data-anchor-id="order">Order</h3>
<p>Ordering can be done by column(s) or any function operating on row. Possible order can be:</p>
<ul>
<li><code>:asc</code> for ascending order (default)</li>
<li><code>:desc</code> for descending order</li>
<li>custom comparator</li>
</ul>
<p><code>:select-keys</code> limits row map provided to ordering functions.</p>
<hr>
<p>Order by single column, ascending</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb250"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>(tc/order-by DS <span class="at">:V1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Descending order</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb251"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>(tc/order-by DS <span class="at">:V1</span> <span class="at">:desc</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Order by two columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb252"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>(tc/order-by DS [<span class="at">:V1</span> <span class="at">:V2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Use different orders for columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb253"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>(tc/order-by DS [<span class="at">:V1</span> <span class="at">:V2</span>] [<span class="at">:asc</span> <span class="at">:desc</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb254"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>(tc/order-by DS [<span class="at">:V1</span> <span class="at">:V2</span>] [<span class="at">:desc</span> <span class="at">:desc</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb255"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>(tc/order-by DS [<span class="at">:V1</span> <span class="at">:V3</span>] [<span class="at">:desc</span> <span class="at">:asc</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Custom function can be used to provided ordering key. Here order by <code>:V4</code> descending, then by product of other columns ascending.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb256"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>(tc/order-by DS [<span class="at">:V4</span> (<span class="kw">fn</span> [row] (<span class="kw">*</span> (<span class="at">:V1</span> row)</span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>                                  (<span class="at">:V2</span> row)</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>                                  (<span class="at">:V3</span> row)))] [<span class="at">:desc</span> <span class="at">:asc</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Custom comparator also can be used in case objects are not comparable by default. Let’s define artificial one: if Euclidean distance is lower than 2, compare along <code>z</code> else along <code>x</code> and <code>y</code>. We use first three columns for that.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb257"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defn</span><span class="fu"> dist</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>  [v1 v2]</span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">-&gt;&gt;</span> v2</span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a>       (<span class="kw">map</span> <span class="kw">-</span> v1)</span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a>       (<span class="kw">map</span> #(<span class="kw">*</span> <span class="va">%</span> <span class="va">%</span>))</span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true" tabindex="-1"></a>       (<span class="kw">reduce</span> <span class="kw">+</span>)</span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true" tabindex="-1"></a>       (Math/sqrt)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb258"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>(tc/order-by DS [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V3</span>] (<span class="kw">fn</span> [[x1 y1 z1 <span class="at">:as</span> v1] [x2 y2 z2 <span class="at">:as</span> v2]]</span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>                                (<span class="kw">let</span> [d (dist v1 v2)]</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>                                  (<span class="kw">if</span> (<span class="kw">&lt;</span> d <span class="fl">2.0</span>)</span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>                                    (<span class="kw">compare</span> z1 z2)</span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>                                    (<span class="kw">compare</span> [x1 y1] [x2 y2])))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="unique" class="level3">
<h3 class="anchored" data-anchor-id="unique">Unique</h3>
<p>Remove rows which contains the same data. By default <code>unique-by</code> removes duplicates from whole dataset. You can also pass list of columns or functions (similar as in <code>group-by</code>) to remove duplicates limited by them. Default strategy is to keep the first row. More strategies below.</p>
<p><code>unique-by</code> works on groups</p>
<hr>
<p>Remove duplicates from whole dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb259"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>(tc/unique-by DS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Remove duplicates from each group selected by column.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb260"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>(tc/unique-by DS <span class="at">:V1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Pair of columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb261"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>(tc/unique-by DS [<span class="at">:V1</span> <span class="at">:V3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Also function can be used, split dataset by modulo 3 on columns <code>:V2</code></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb262"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>(tc/unique-by DS (<span class="kw">fn</span> [m] (<span class="kw">mod</span> (<span class="at">:V2</span> m) <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>The same can be achived with <code>group-by</code></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb263"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by (<span class="kw">fn</span> [m] (<span class="kw">mod</span> (<span class="at">:V2</span> m) <span class="dv">3</span>)))</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>    (tc/first)</span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb264"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>    (tc/unique-by <span class="at">:V1</span>)</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<section id="strategies" class="level4">
<h4 class="anchored" data-anchor-id="strategies">Strategies</h4>
<p>There are 4 strategies defined:</p>
<ul>
<li><code>:first</code> - select first row (default)</li>
<li><code>:last</code> - select last row</li>
<li><code>:random</code> - select random row</li>
<li>any function - apply function to a columns which are subject of uniqueness</li>
</ul>
<hr>
<p>Last</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb265"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>(tc/unique-by DS <span class="at">:V1</span> {<span class="at">:strategy</span> <span class="at">:last</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Random</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb266"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>(tc/unique-by DS <span class="at">:V1</span> {<span class="at">:strategy</span> <span class="at">:random</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Pack columns into vector</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb267"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>(tc/unique-by DS <span class="at">:V4</span> {<span class="at">:strategy</span> <span class="kw">vec</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V1</th>
<th>:V2</th>
<th>:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1 2 1]</td>
<td>[1 4 7]</td>
<td>[0.5 0.5 0.5]</td>
</tr>
<tr class="even">
<td>[2 1 2]</td>
<td>[2 5 8]</td>
<td>[1.0 1.0 1.0]</td>
</tr>
<tr class="odd">
<td>[1 2 1]</td>
<td>[3 6 9]</td>
<td>[1.5 1.5 1.5]</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Sum columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb268"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>(tc/unique-by DS <span class="at">:V4</span> {<span class="at">:strategy</span> (<span class="kw">partial</span> <span class="kw">reduce</span> <span class="kw">+</span>)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">4.5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Group by function and apply functions</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb269"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>(tc/unique-by DS (<span class="kw">fn</span> [m] (<span class="kw">mod</span> (<span class="at">:V2</span> m) <span class="dv">3</span>)) {<span class="at">:strategy</span> <span class="kw">vec</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V1</th>
<th>:V2</th>
<th>:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1 2 1]</td>
<td>[1 4 7]</td>
<td>[0.5 0.5 0.5]</td>
<td>[A A A]</td>
</tr>
<tr class="even">
<td>[2 1 2]</td>
<td>[2 5 8]</td>
<td>[1.0 1.0 1.0]</td>
<td>[B B B]</td>
</tr>
<tr class="odd">
<td>[1 2 1]</td>
<td>[3 6 9]</td>
<td>[1.5 1.5 1.5]</td>
<td>[C C C]</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb270"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V1</span>)</span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>    (tc/unique-by (<span class="kw">fn</span> [m] (<span class="kw">mod</span> (<span class="at">:V2</span> m) <span class="dv">3</span>)) {<span class="at">:strategy</span> <span class="kw">vec</span>})</span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup {<span class="at">:add-group-as-column</span> <span class="at">:from-V1</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:from-V1</th>
<th>:V1</th>
<th>:V2</th>
<th>:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>[1 1]</td>
<td>[1 7]</td>
<td>[0.5 0.5]</td>
<td>[A A]</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>[1 1]</td>
<td>[3 9]</td>
<td>[1.5 1.5]</td>
<td>[C C]</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>[1]</td>
<td>[5]</td>
<td>[1.0]</td>
<td>[B]</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>[2 2]</td>
<td>[2 8]</td>
<td>[1.0 1.0]</td>
<td>[B B]</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>[2]</td>
<td>[4]</td>
<td>[0.5]</td>
<td>[A]</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>[2]</td>
<td>[6]</td>
<td>[1.5]</td>
<td>[C]</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="missing" class="level3">
<h3 class="anchored" data-anchor-id="missing">Missing</h3>
<p>When dataset contains missing values you can select or drop rows with missing values or replace them using some strategy.</p>
<p><code>column-selector</code> can be used to limit considered columns</p>
<p>Let’s define dataset which contains missing values</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb271"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DSm </span>(tc/dataset {<span class="at">:V1</span> (<span class="kw">take</span> <span class="dv">9</span> (<span class="kw">cycle</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="va">nil</span>]))</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:V2</span> (<span class="kw">range</span> <span class="dv">1</span> <span class="dv">10</span>)</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:V3</span> (<span class="kw">take</span> <span class="dv">9</span> (<span class="kw">cycle</span> [<span class="fl">0.5</span> <span class="fl">1.0</span> <span class="va">nil</span> <span class="fl">1.5</span>]))</span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:V4</span> (<span class="kw">take</span> <span class="dv">9</span> (<span class="kw">cycle</span> [<span class="st">"A"</span> <span class="st">"B"</span> <span class="st">"C"</span>]))}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb272"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>DSm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.5</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.0</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;"></td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.5</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<section id="select-2" class="level4">
<h4 class="anchored" data-anchor-id="select-2">Select</h4>
<p>Select rows with missing values</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb273"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>(tc/select-missing DSm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.0</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;"></td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Select rows with missing values in <code>:V1</code></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb274"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>(tc/select-missing DSm <span class="at">:V1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.0</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>The same with grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb275"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DSm</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-missing <span class="at">:V3</span>)</span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td></td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td></td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="drop-2" class="level4">
<h4 class="anchored" data-anchor-id="drop-2">Drop</h4>
<p>Drop rows with missing values</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb276"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>(tc/drop-missing DSm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.5</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.5</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Drop rows with missing values in <code>:V1</code></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb277"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>(tc/drop-missing DSm <span class="at">:V1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.5</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;"></td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.5</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>The same with grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb278"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DSm</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>    (tc/drop-missing <span class="at">:V1</span>)</span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;"></td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.5</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.5</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="replace" class="level4">
<h4 class="anchored" data-anchor-id="replace">Replace</h4>
<p>Missing values can be replaced using several strategies. <code>replace-missing</code> accepts:</p>
<ul>
<li>dataset</li>
<li>column selector, default: <code>:all</code></li>
<li>strategy, default: <code>:nearest</code></li>
<li>value (optional)
<ul>
<li>single value</li>
<li>sequence of values (cycled)</li>
<li>function, applied on column(s) with stripped missings</li>
<li>map with [index,value] pairs</li>
</ul></li>
</ul>
<p>Strategies are:</p>
<ul>
<li><code>:value</code> - replace with given value</li>
<li><code>:up</code> - copy values up</li>
<li><code>:down</code> - copy values down</li>
<li><code>:updown</code> - copy values up and then down for missing values at the end</li>
<li><code>:downup</code> - copy values down and then up for missing values at the beginning</li>
<li><code>:mid</code> or <code>:nearest</code> - copy values around known values</li>
<li><code>:midpoint</code> - use average value from previous and next non-missing</li>
<li><code>:lerp</code> - trying to lineary approximate values, works for numbers and datetime, otherwise applies <code>:nearest</code>. For numbers always results in <code>float</code> datatype.</li>
</ul>
<p>Let’s define special dataset here:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb279"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DSm2 </span>(tc/dataset {<span class="at">:a</span> [<span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span> <span class="fl">1.0</span> <span class="dv">2</span>  <span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span>  <span class="va">nil</span> <span class="dv">4</span>   <span class="va">nil</span>  <span class="dv">11</span> <span class="va">nil</span> <span class="va">nil</span>]</span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:b</span> [<span class="dv">2</span>   <span class="dv">2</span>   <span class="dv">2</span> <span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span> <span class="dv">13</span>   <span class="va">nil</span>   <span class="dv">3</span>  <span class="dv">4</span>  <span class="dv">5</span> <span class="dv">5</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb280"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>DSm2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Replace missing with default strategy for all columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb281"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>(tc/replace-missing DSm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Replace missing with single value in whole dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb282"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>(tc/replace-missing DSm2 <span class="at">:all</span> <span class="at">:value</span> <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">999</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">999</td>
</tr>
<tr class="even">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">999</td>
</tr>
<tr class="odd">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">999</td>
</tr>
<tr class="even">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">999</td>
</tr>
<tr class="odd">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">999</td>
</tr>
<tr class="even">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">999</td>
</tr>
<tr class="even">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Replace missing with single value in <code>:a</code> column</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb283"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>(tc/replace-missing DSm2 <span class="at">:a</span> <span class="at">:value</span> <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Replace missing with sequence in <code>:a</code> column</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb284"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>(tc/replace-missing DSm2 <span class="at">:a</span> <span class="at">:value</span> [-<span class="dv">999</span> -<span class="dv">998</span> -<span class="dv">997</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-999.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">-998.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-997.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">-999.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">-998.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">-997.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">-999.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">-998.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">-997.0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">-999.0</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-998.0</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Replace missing with a function (mean)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb285"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>(tc/replace-missing DSm2 <span class="at">:a</span> <span class="at">:value</span> tech.v3.datatype.functional/mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Replace missing some missing values with a map</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb286"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>(tc/replace-missing DSm2 <span class="at">:a</span> <span class="at">:value</span> {<span class="dv">0</span> <span class="dv">100</span> <span class="dv">1</span> -<span class="dv">100</span> <span class="dv">14</span> -<span class="dv">1000</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">-100.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-1000.0</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Using <code>:down</code> strategy, fills gaps with values from above. You can see that if missings are at the beginning, the are filled with first value</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb287"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>(tc/replace-missing DSm2 [<span class="at">:a</span> <span class="at">:b</span>] <span class="at">:downup</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>To fix above issue you can provide value</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb288"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>(tc/replace-missing DSm2 [<span class="at">:a</span> <span class="at">:b</span>] <span class="at">:down</span> <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>The same applies for <code>:up</code> strategy which is opposite direction.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb289"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>(tc/replace-missing DSm2 [<span class="at">:a</span> <span class="at">:b</span>] <span class="at">:up</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb290"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>(tc/replace-missing DSm2 [<span class="at">:a</span> <span class="at">:b</span>] <span class="at">:updown</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>The same applies for <code>:up</code> strategy which is opposite direction.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb291"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>(tc/replace-missing DSm2 [<span class="at">:a</span> <span class="at">:b</span>] <span class="at">:midpoint</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">7.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">7.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">7.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">7.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">7.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">7.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">13.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.5</td>
<td style="text-align: right;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">5.0</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>We can use a function which is applied after applying <code>:up</code> or <code>:down</code></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb292"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>(tc/replace-missing DSm2 [<span class="at">:a</span> <span class="at">:b</span>] <span class="at">:down</span> tech.v3.datatype.functional/mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Lerp tries to apply linear interpolation of the values</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb293"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>(tc/replace-missing DSm2 [<span class="at">:a</span> <span class="at">:b</span>] <span class="at">:lerp</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.00000000</td>
<td style="text-align: right;">2.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.00000000</td>
<td style="text-align: right;">2.00000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.00000000</td>
<td style="text-align: right;">2.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.00000000</td>
<td style="text-align: right;">3.57142857</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.00000000</td>
<td style="text-align: right;">5.14285714</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.33333333</td>
<td style="text-align: right;">6.71428571</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.66666667</td>
<td style="text-align: right;">8.28571429</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.00000000</td>
<td style="text-align: right;">9.85714286</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.33333333</td>
<td style="text-align: right;">11.42857143</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.66666667</td>
<td style="text-align: right;">13.00000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.00000000</td>
<td style="text-align: right;">8.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.50000000</td>
<td style="text-align: right;">3.00000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.00000000</td>
<td style="text-align: right;">4.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.00000000</td>
<td style="text-align: right;">5.00000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.00000000</td>
<td style="text-align: right;">5.00000000</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Lerp works also on dates</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb294"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tc/dataset {<span class="at">:dt</span> [(java.<span class="kw">time</span>.LocalDateTime/of <span class="dv">2020</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">11</span> <span class="dv">22</span> <span class="dv">33</span>)</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>                      <span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>                      (java.<span class="kw">time</span>.LocalDateTime/of <span class="dv">2020</span> <span class="dv">10</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span>)]})</span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a>    (tc/replace-missing <span class="at">:lerp</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:dt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2020-01-01T11:22:33</td>
</tr>
<tr class="even">
<td>2020-02-04T16:04:51.500</td>
</tr>
<tr class="odd">
<td>2020-03-09T20:47:10</td>
</tr>
<tr class="even">
<td>2020-04-13T01:29:28.500</td>
</tr>
<tr class="odd">
<td>2020-05-17T06:11:47</td>
</tr>
<tr class="even">
<td>2020-06-20T10:54:05.500</td>
</tr>
<tr class="odd">
<td>2020-07-24T15:36:24</td>
</tr>
<tr class="even">
<td>2020-08-27T20:18:42.500</td>
</tr>
<tr class="odd">
<td>2020-10-01T01:01:01</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="inject" class="level4">
<h4 class="anchored" data-anchor-id="inject">Inject</h4>
<p>When your column contains not continuous data range you can fill up with lacking values. Arguments:</p>
<ul>
<li>dataset</li>
<li>column name</li>
<li>expected step (<code>max-span</code>, milliseconds in case of datetime column)</li>
<li>(optional) <code>missing-strategy</code> - how to replace missing, default <code>:down</code> (set to <code>nil</code> if none)</li>
<li>(optional) <code>missing-value</code> - optional value for replace missing</li>
</ul>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb295"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tc/dataset {<span class="at">:a</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">9</span>]</span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:b</span> [<span class="at">:a</span> <span class="at">:b</span> <span class="at">:c</span>]})</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a>    (tc/fill-range-replace <span class="at">:a</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th>:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td>:a</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td>:b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.0</td>
<td>:b</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td>:b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0</td>
<td>:b</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.0</td>
<td>:b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.0</td>
<td>:b</td>
</tr>
<tr class="even">
<td style="text-align: right;">8.0</td>
<td>:b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9.0</td>
<td>:c</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="joinseparate-columns" class="level3">
<h3 class="anchored" data-anchor-id="joinseparate-columns">Join/Separate Columns</h3>
<p>Joining or separating columns are operations which can help to tidy messy dataset.</p>
<ul>
<li><code>join-columns</code> joins content of the columns (as string concatenation or other structure) and stores it in new column</li>
<li><code>separate-column</code> splits content of the columns into set of new columns</li>
</ul>
<section id="join" class="level4">
<h4 class="anchored" data-anchor-id="join">Join</h4>
<p><code>join-columns</code> accepts:</p>
<ul>
<li>dataset</li>
<li>column selector (as in <code>select-columns</code>)</li>
<li>options</li>
<li><code>:separator</code> (default <code>"-"</code>)</li>
<li><code>:drop-columns?</code> - whether to drop source columns or not (default <code>true</code>)</li>
<li><code>:result-type</code></li>
<li><code>:map</code> - packs data into map</li>
<li><code>:seq</code> - packs data into sequence</li>
<li><code>:string</code> - join strings with separator (default)</li>
<li>or custom function which gets row as a vector</li>
<li><code>:missing-subst</code> - substitution for missing value</li>
</ul>
<hr>
<p>Default usage. Create <code>:joined</code> column out of other columns.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb296"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>(tc/join-columns DSm <span class="at">:joined</span> [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
<th>:joined</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>1-1-A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>2-2-B</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>3-C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>1-4-A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>2-5-B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>6-C</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>1-7-A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>2-8-B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>9-C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Without dropping source columns.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb297"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>(tc/join-columns DSm <span class="at">:joined</span> [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V4</span>] {<span class="at">:drop-columns</span>? <span class="va">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th>:joined</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td>1-1-A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td>2-2-B</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td>C</td>
<td>3-C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1.5</td>
<td>A</td>
<td>1-4-A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.5</td>
<td>B</td>
<td>2-5-B</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.0</td>
<td>C</td>
<td>6-C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;"></td>
<td>A</td>
<td>1-7-A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.5</td>
<td>B</td>
<td>2-8-B</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
<td>9-C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Let’s replace missing value with “NA” string.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb298"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>(tc/join-columns DSm <span class="at">:joined</span> [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V4</span>] {<span class="at">:missing-subst</span> <span class="st">"NA"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
<th>:joined</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>1-1-A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>2-2-B</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>NA-3-C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>1-4-A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>2-5-B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>NA-6-C</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>1-7-A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>2-8-B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>NA-9-C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>We can use custom separator.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb299"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>(tc/join-columns DSm <span class="at">:joined</span> [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V4</span>] {<span class="at">:separator</span> <span class="st">"/"</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">:missing-subst</span> <span class="st">"."</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
<th>:joined</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>1/1/A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>2/2/B</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>./3/C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>1/4/A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>2/5/B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>./6/C</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>1/7/A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>2/8/B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>./9/C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Or even sequence of separators.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb300"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>(tc/join-columns DSm <span class="at">:joined</span> [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V4</span>] {<span class="at">:separator</span> [<span class="st">"-"</span> <span class="st">"/"</span>]</span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">:missing-subst</span> <span class="st">"."</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
<th>:joined</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>1-1/A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>2-2/B</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>.-3/C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>1-4/A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>2-5/B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>.-6/C</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>1-7/A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>2-8/B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>.-9/C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>The other types of results, map:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb301"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>(tc/join-columns DSm <span class="at">:joined</span> [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V4</span>] {<span class="at">:result-type</span> <span class="at">:map</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
<th>:joined</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>{:V1 1, :V2 1, :V4 A}</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>{:V1 2, :V2 2, :V4 B}</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>{:V1 nil, :V2 3, :V4 C}</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>{:V1 1, :V2 4, :V4 A}</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>{:V1 2, :V2 5, :V4 B}</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>{:V1 nil, :V2 6, :V4 C}</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>{:V1 1, :V2 7, :V4 A}</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>{:V1 2, :V2 8, :V4 B}</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>{:V1 nil, :V2 9, :V4 C}</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Sequence</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb302"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>(tc/join-columns DSm <span class="at">:joined</span> [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V4</span>] {<span class="at">:result-type</span> <span class="at">:seq</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
<th>:joined</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>(1 1 A)</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>(2 2 B)</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>(nil 3 C)</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>(1 4 A)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>(2 5 B)</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>(nil 6 C)</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>(1 7 A)</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>(2 8 B)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>(nil 9 C)</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Custom function, calculate hash</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb303"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>(tc/join-columns DSm <span class="at">:joined</span> [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V4</span>] {<span class="at">:result-type</span> <span class="kw">hash</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
<th style="text-align: right;">:joined</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">535226087</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1128801549</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">-1842240303</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">2022347171</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1884312041</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">-1555412370</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">1640237355</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">-967279152</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1128367958</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb304"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DSm</span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a>    (tc/join-columns <span class="at">:joined</span> [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V4</span>])</span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
<th>:joined</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>1-1-A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>1-4-A</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>1-7-A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>2-2-B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>2-5-B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>2-8-B</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>3-C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>6-C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>9-C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<section id="tidyr-examples" class="level5">
<h5 class="anchored" data-anchor-id="tidyr-examples">Tidyr examples</h5>
<p><a href="https://tidyr.tidyverse.org/reference/unite.html">source</a></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb305"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> df </span>(tc/dataset {<span class="at">:x</span> [<span class="st">"a"</span> <span class="st">"a"</span> <span class="va">nil</span> <span class="va">nil</span>]</span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:y</span> [<span class="st">"b"</span> <span class="va">nil</span> <span class="st">"b"</span> <span class="va">nil</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb306"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:x</th>
<th>:y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a</td>
<td>b</td>
</tr>
<tr class="even">
<td>a</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>b</td>
</tr>
<tr class="even">
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb307"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>(tc/join-columns df <span class="st">"z"</span> [<span class="at">:x</span> <span class="at">:y</span>] {<span class="at">:drop-columns</span>? <span class="va">false</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">:missing-subst</span> <span class="st">"NA"</span></span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">:separator</span> <span class="st">"_"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:x</th>
<th>:y</th>
<th>z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a</td>
<td>b</td>
<td>a_b</td>
</tr>
<tr class="even">
<td>a</td>
<td></td>
<td>a_NA</td>
</tr>
<tr class="odd">
<td></td>
<td>b</td>
<td>NA_b</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>NA_NA</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb308"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>(tc/join-columns df <span class="st">"z"</span> [<span class="at">:x</span> <span class="at">:y</span>] {<span class="at">:drop-columns</span>? <span class="va">false</span></span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">:separator</span> <span class="st">"_"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:x</th>
<th>:y</th>
<th>z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a</td>
<td>b</td>
<td>a_b</td>
</tr>
<tr class="even">
<td>a</td>
<td></td>
<td>a</td>
</tr>
<tr class="odd">
<td></td>
<td>b</td>
<td>b</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="separate" class="level4">
<h4 class="anchored" data-anchor-id="separate">Separate</h4>
<p>Column can be also separated into several other columns using string as separator, regex or custom function. Arguments:</p>
<ul>
<li>dataset</li>
<li>source column</li>
<li>target columns - can be <code>nil</code> or <code>:infer</code> to automatically create columns</li>
<li>separator as:
<ul>
<li>string - it’s converted to regular expression and passed to <code>clojure.string/split</code> function</li>
<li>regex</li>
<li>or custom function (default: identity)</li>
</ul></li>
<li>options
<ul>
<li><code>:drop-columns?</code> - whether drop source column(s) or not (default: <code>true</code>). Set to <code>:all</code> to keep only separation result.</li>
<li><code>:missing-subst</code> - values which should be treated as missing, can be set, sequence, value or function (default: <code>""</code>)</li>
</ul></li>
</ul>
<p>Custom function (as separator) should return seqence of values for given value or a sequence of map.</p>
<hr>
<p>Separate float into integer and factional values</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb309"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a>(tc/separate-column DS <span class="at">:V3</span> [<span class="at">:int-part</span> <span class="at">:frac-part</span>] (<span class="kw">fn</span> [^<span class="kw">double</span> v]</span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>                                                     [(<span class="kw">int</span> (<span class="kw">quot</span> v <span class="fl">1.0</span>))</span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>                                                      (<span class="kw">mod</span> v <span class="fl">1.0</span>)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:int-part</th>
<th style="text-align: right;">:frac-part</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Source column can be kept</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb310"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a>(tc/separate-column DS <span class="at">:V3</span> [<span class="at">:int-part</span> <span class="at">:frac-part</span>] (<span class="kw">fn</span> [^<span class="kw">double</span> v]</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>                                                     [(<span class="kw">int</span> (<span class="kw">quot</span> v <span class="fl">1.0</span>))</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a>                                                      (<span class="kw">mod</span> v <span class="fl">1.0</span>)]) {<span class="at">:drop-column</span>? <span class="va">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 6]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th style="text-align: right;">:int-part</th>
<th style="text-align: right;">:frac-part</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>We can treat <code>0</code> or <code>0.0</code> as missing value</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb311"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a>(tc/separate-column DS <span class="at">:V3</span> [<span class="at">:int-part</span> <span class="at">:frac-part</span>] (<span class="kw">fn</span> [^<span class="kw">double</span> v]</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>                                                     [(<span class="kw">int</span> (<span class="kw">quot</span> v <span class="fl">1.0</span>))</span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a>                                                      (<span class="kw">mod</span> v <span class="fl">1.0</span>)]) {<span class="at">:missing-subst</span> [<span class="dv">0</span> <span class="fl">0.0</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:int-part</th>
<th style="text-align: right;">:frac-part</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Works on grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb312"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a>    (tc/separate-column <span class="at">:V3</span> [<span class="at">:int-part</span> <span class="at">:fract-part</span>] (<span class="kw">fn</span> [^<span class="kw">double</span> v]</span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a>                                                       [(<span class="kw">int</span> (<span class="kw">quot</span> v <span class="fl">1.0</span>))</span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true" tabindex="-1"></a>                                                        (<span class="kw">mod</span> v <span class="fl">1.0</span>)]))</span>
<span id="cb312-6"><a href="#cb312-6" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:int-part</th>
<th style="text-align: right;">:fract-part</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Separate using separator returning sequence of maps.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb313"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>(tc/separate-column DS <span class="at">:V3</span> (<span class="kw">fn</span> [^<span class="kw">double</span> v]</span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>                              {<span class="at">:int-part</span> (<span class="kw">int</span> (<span class="kw">quot</span> v <span class="fl">1.0</span>))</span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">:fract-part</span> (<span class="kw">mod</span> v <span class="fl">1.0</span>)}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:int-part</th>
<th style="text-align: right;">:fract-part</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<p>Keeping all columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb314"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a>(tc/separate-column DS <span class="at">:V3</span> <span class="va">nil</span> (<span class="kw">fn</span> [^<span class="kw">double</span> v]</span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a>                                  {<span class="at">:int-part</span> (<span class="kw">int</span> (<span class="kw">quot</span> v <span class="fl">1.0</span>))</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">:fract-part</span> (<span class="kw">mod</span> v <span class="fl">1.0</span>)}) {<span class="at">:drop-column</span>? <span class="va">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 6]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th style="text-align: right;">:int-part</th>
<th style="text-align: right;">:fract-part</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<p>Droping all colums but separated</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb315"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>(tc/separate-column DS <span class="at">:V3</span> <span class="va">nil</span> (<span class="kw">fn</span> [^<span class="kw">double</span> v]</span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>                                 {<span class="at">:int-part</span> (<span class="kw">int</span> (<span class="kw">quot</span> v <span class="fl">1.0</span>))</span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">:fract-part</span> (<span class="kw">mod</span> v <span class="fl">1.0</span>)}) {<span class="at">:drop-column</span>? <span class="at">:all</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:int-part</th>
<th style="text-align: right;">:fract-part</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
</tr>
</tbody>
</table>
</div>
<p>Infering column names</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb316"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a>(tc/separate-column DS <span class="at">:V3</span> (<span class="kw">fn</span> [^<span class="kw">double</span> v]</span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a>                             [(<span class="kw">int</span> (<span class="kw">quot</span> v <span class="fl">1.0</span>)) (<span class="kw">mod</span> v <span class="fl">1.0</span>)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3-0</th>
<th style="text-align: right;">:V3-1</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Join and separate together.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb317"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DSm</span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>    (tc/join-columns <span class="at">:joined</span> [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V4</span>] {<span class="at">:result-type</span> <span class="at">:map</span>})</span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a>    (tc/separate-column <span class="at">:joined</span> [<span class="at">:v1</span> <span class="at">:v2</span> <span class="at">:v4</span>] (<span class="kw">juxt</span> <span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
<th style="text-align: right;">:v1</th>
<th style="text-align: right;">:v2</th>
<th>:v4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">6</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">9</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb318"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DSm</span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a>    (tc/join-columns <span class="at">:joined</span> [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V4</span>] {<span class="at">:result-type</span> <span class="at">:seq</span>})</span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a>    (tc/separate-column <span class="at">:joined</span> [<span class="at">:v1</span> <span class="at">:v2</span> <span class="at">:v4</span>] <span class="kw">identity</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
<th style="text-align: right;">:v1</th>
<th style="text-align: right;">:v2</th>
<th>:v4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">6</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">9</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<section id="tidyr-examples-1" class="level5">
<h5 class="anchored" data-anchor-id="tidyr-examples-1">Tidyr examples</h5>
<p><a href="https://tidyr.tidyverse.org/reference/separate.html">separate source</a> <a href="https://tidyr.tidyverse.org/reference/extract.html">extract source</a></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb319"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> df-separate </span>(tc/dataset {<span class="at">:x</span> [<span class="va">nil</span> <span class="st">"a.b"</span> <span class="st">"a.d"</span> <span class="st">"b.c"</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb320"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> df-separate2 </span>(tc/dataset {<span class="at">:x</span> [<span class="st">"a"</span> <span class="st">"a b"</span> <span class="va">nil</span> <span class="st">"a b c"</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb321"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> df-separate3 </span>(tc/dataset {<span class="at">:x</span> [<span class="st">"a?b"</span> <span class="va">nil</span> <span class="st">"a.b"</span> <span class="st">"b:c"</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb322"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> df-extract </span>(tc/dataset {<span class="at">:x</span> [<span class="va">nil</span> <span class="st">"a-b"</span> <span class="st">"a-d"</span> <span class="st">"b-c"</span> <span class="st">"d-e"</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb323"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>df-separate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>a.b</td>
</tr>
<tr class="odd">
<td>a.d</td>
</tr>
<tr class="even">
<td>b.c</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb324"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>df-separate2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a</td>
</tr>
<tr class="even">
<td>a b</td>
</tr>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>a b c</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb325"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a>df-separate3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a?b</td>
</tr>
<tr class="even">
<td></td>
</tr>
<tr class="odd">
<td>a.b</td>
</tr>
<tr class="even">
<td>b:c</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb326"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a>df-extract</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>a-b</td>
</tr>
<tr class="odd">
<td>a-d</td>
</tr>
<tr class="even">
<td>b-c</td>
</tr>
<tr class="odd">
<td>d-e</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb327"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>(tc/separate-column df-separate <span class="at">:x</span> [<span class="at">:A</span> <span class="at">:B</span>] <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:A</th>
<th>:B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
</tr>
<tr class="even">
<td>a</td>
<td>b</td>
</tr>
<tr class="odd">
<td>a</td>
<td>d</td>
</tr>
<tr class="even">
<td>b</td>
<td>c</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>You can drop columns after separation by setting <code>nil</code> as a name. We need second value here.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb328"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>(tc/separate-column df-separate <span class="at">:x</span> [<span class="va">nil</span> <span class="at">:B</span>] <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>b</td>
</tr>
<tr class="odd">
<td>d</td>
</tr>
<tr class="even">
<td>c</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Extra data is dropped</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb329"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a>(tc/separate-column df-separate2 <span class="at">:x</span> [<span class="st">"a"</span> <span class="st">"b"</span>] <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a</td>
<td></td>
</tr>
<tr class="even">
<td>a</td>
<td>b</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
</tr>
<tr class="even">
<td>a</td>
<td>b</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Split with regular expression</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb330"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>(tc/separate-column df-separate3 <span class="at">:x</span> [<span class="st">"a"</span> <span class="st">"b"</span>] <span class="st">"[?</span><span class="sc">\\</span><span class="st">.:]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a</td>
<td>b</td>
</tr>
<tr class="even">
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>a</td>
<td>b</td>
</tr>
<tr class="even">
<td>b</td>
<td>c</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Or just regular expression to extract values</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb331"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a>(tc/separate-column df-separate3 <span class="at">:x</span> [<span class="st">"a"</span> <span class="st">"b"</span>] <span class="ss">#"(.).(.)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a</td>
<td>b</td>
</tr>
<tr class="even">
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>a</td>
<td>b</td>
</tr>
<tr class="even">
<td>b</td>
<td>c</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Extract first value only</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb332"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a>(tc/separate-column df-extract <span class="at">:x</span> [<span class="st">"A"</span>] <span class="st">"-"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th>A</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
</tr>
<tr class="even">
<td>a</td>
</tr>
<tr class="odd">
<td>a</td>
</tr>
<tr class="even">
<td>b</td>
</tr>
<tr class="odd">
<td>d</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Split with regex</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb333"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a>(tc/separate-column df-extract <span class="at">:x</span> [<span class="st">"A"</span> <span class="st">"B"</span>] <span class="ss">#"(\p{Alnum})-(\p{Alnum})"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>A</th>
<th>B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
</tr>
<tr class="even">
<td>a</td>
<td>b</td>
</tr>
<tr class="odd">
<td>a</td>
<td>d</td>
</tr>
<tr class="even">
<td>b</td>
<td>c</td>
</tr>
<tr class="odd">
<td>d</td>
<td>e</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Only <code>a,b,c,d</code> strings</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb334"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a>(tc/separate-column df-extract <span class="at">:x</span> [<span class="st">"A"</span> <span class="st">"B"</span>] <span class="ss">#"([a-d]+)-([a-d]+)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>A</th>
<th>B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
</tr>
<tr class="even">
<td>a</td>
<td>b</td>
</tr>
<tr class="odd">
<td>a</td>
<td>d</td>
</tr>
<tr class="even">
<td>b</td>
<td>c</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="array-column-conversion" class="level4">
<h4 class="anchored" data-anchor-id="array-column-conversion">Array column conversion</h4>
<p>A dataset can have as well columns of type java array. We can convert from normal columns to a single array column and back like this:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb335"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tc/dataset {<span class="at">:x</span> [(<span class="kw">double-array</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>])</span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a>                     (<span class="kw">double-array</span> [<span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span>])]</span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:y</span> [<span class="at">:a</span> <span class="at">:b</span>]})</span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a>    (tc/array-column-&gt;columns <span class="at">:x</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:y</th>
<th style="text-align: right;">0</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:a</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">3.0</td>
</tr>
<tr class="even">
<td>:b</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">6.0</td>
</tr>
</tbody>
</table>
</div>
<p>and the other way around:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb336"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tc/dataset {<span class="dv">0</span> [<span class="fl">0.0</span> <span class="dv">1</span> <span class="dv">2</span>]</span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">1</span> [<span class="fl">3.0</span> <span class="dv">4</span> <span class="dv">5</span>]</span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:x</span> [<span class="at">:a</span> <span class="at">:b</span> <span class="at">:c</span>]})</span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true" tabindex="-1"></a>    (tc/columns-&gt;array-column [<span class="dv">0</span> <span class="dv">1</span>] <span class="at">:y</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:x</th>
<th>:y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:a</td>
<td>[D@1631199a</td>
</tr>
<tr class="even">
<td>:b</td>
<td>[D@6f8374d9</td>
</tr>
<tr class="odd">
<td>:c</td>
<td>[D@13981f62</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="foldunroll-rows" class="level3">
<h3 class="anchored" data-anchor-id="foldunroll-rows">Fold/Unroll Rows</h3>
<p>To pack or unpack the data into single value you can use <code>fold-by</code> and <code>unroll</code> functions.</p>
<p><code>fold-by</code> groups dataset and packs columns data from each group separately into desired datastructure (like vector or sequence). <code>unroll</code> does the opposite.</p>
<section id="fold-by" class="level4">
<h4 class="anchored" data-anchor-id="fold-by">Fold-by</h4>
<p>Group-by and pack columns into vector</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb337"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a>(tc/fold-by DS [<span class="at">:V3</span> <span class="at">:V4</span> <span class="at">:V1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th>:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">1</td>
<td>[1 7]</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">2</td>
<td>[2 8]</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">1</td>
<td>[3 9]</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">2</td>
<td>[4]</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">1</td>
<td>[5]</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">2</td>
<td>[6]</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>You can pack several columns at once.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb338"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a>(tc/fold-by DS [<span class="at">:V4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th>:V1</th>
<th>:V2</th>
<th>:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>[1 2 1]</td>
<td>[1 4 7]</td>
<td>[0.5 0.5 0.5]</td>
</tr>
<tr class="even">
<td>B</td>
<td>[2 1 2]</td>
<td>[2 5 8]</td>
<td>[1.0 1.0 1.0]</td>
</tr>
<tr class="odd">
<td>C</td>
<td>[1 2 1]</td>
<td>[3 6 9]</td>
<td>[1.5 1.5 1.5]</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>You can use custom packing function</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb339"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>(tc/fold-by DS [<span class="at">:V4</span>] <span class="kw">seq</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th>:V1</th>
<th>:V2</th>
<th>:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>(1 2 1)</td>
<td>(1 4 7)</td>
<td>(0.5 0.5 0.5)</td>
</tr>
<tr class="even">
<td>B</td>
<td>(2 1 2)</td>
<td>(2 5 8)</td>
<td>(1.0 1.0 1.0)</td>
</tr>
<tr class="odd">
<td>C</td>
<td>(1 2 1)</td>
<td>(3 6 9)</td>
<td>(1.5 1.5 1.5)</td>
</tr>
</tbody>
</table>
</div>
<p>or</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb340"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a>(tc/fold-by DS [<span class="at">:V4</span>] <span class="kw">set</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th>:V1</th>
<th>:V2</th>
<th>:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>#{1 2}</td>
<td>#{7 1 4}</td>
<td>#{0.5}</td>
</tr>
<tr class="even">
<td>B</td>
<td>#{1 2}</td>
<td>#{2 5 8}</td>
<td>#{1.0}</td>
</tr>
<tr class="odd">
<td>C</td>
<td>#{1 2}</td>
<td>#{6 3 9}</td>
<td>#{1.5}</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>This works also on grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb341"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V1</span>)</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>    (tc/fold-by <span class="at">:V4</span>)</span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th>:V1</th>
<th>:V2</th>
<th>:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>[1 1]</td>
<td>[1 7]</td>
<td>[0.5 0.5]</td>
</tr>
<tr class="even">
<td>C</td>
<td>[1 1]</td>
<td>[3 9]</td>
<td>[1.5 1.5]</td>
</tr>
<tr class="odd">
<td>B</td>
<td>[1]</td>
<td>[5]</td>
<td>[1.0]</td>
</tr>
<tr class="even">
<td>B</td>
<td>[2 2]</td>
<td>[2 8]</td>
<td>[1.0 1.0]</td>
</tr>
<tr class="odd">
<td>A</td>
<td>[2]</td>
<td>[4]</td>
<td>[0.5]</td>
</tr>
<tr class="even">
<td>C</td>
<td>[2]</td>
<td>[6]</td>
<td>[1.5]</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="unroll" class="level4">
<h4 class="anchored" data-anchor-id="unroll">Unroll</h4>
<p><code>unroll</code> unfolds sequences stored in data, multiplying other ones when necessary. You can unroll more than one column at once (folded data should have the same size!).</p>
<p>Options:</p>
<ul>
<li><code>:indexes?</code> if true (or column name), information about index of unrolled sequence is added.</li>
<li><code>:datatypes</code> list of datatypes which should be applied to restored columns, a map</li>
</ul>
<hr>
<p>Unroll one column</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb342"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a>(tc/unroll (tc/fold-by DS [<span class="at">:V4</span>]) [<span class="at">:V1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th>:V2</th>
<th>:V3</th>
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>[1 4 7]</td>
<td>[0.5 0.5 0.5]</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>A</td>
<td>[1 4 7]</td>
<td>[0.5 0.5 0.5]</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td>A</td>
<td>[1 4 7]</td>
<td>[0.5 0.5 0.5]</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>B</td>
<td>[2 5 8]</td>
<td>[1.0 1.0 1.0]</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td>B</td>
<td>[2 5 8]</td>
<td>[1.0 1.0 1.0]</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>B</td>
<td>[2 5 8]</td>
<td>[1.0 1.0 1.0]</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td>C</td>
<td>[3 6 9]</td>
<td>[1.5 1.5 1.5]</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>C</td>
<td>[3 6 9]</td>
<td>[1.5 1.5 1.5]</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td>C</td>
<td>[3 6 9]</td>
<td>[1.5 1.5 1.5]</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Unroll all folded columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb343"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>(tc/unroll (tc/fold-by DS [<span class="at">:V4</span>]) [<span class="at">:V1</span> <span class="at">:V2</span> <span class="at">:V3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Unroll one by one leads to cartesian product</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb344"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a>    (tc/fold-by [<span class="at">:V4</span> <span class="at">:V1</span>])</span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a>    (tc/unroll [<span class="at">:V2</span>])</span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a>    (tc/unroll [<span class="at">:V3</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [15 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>You can add indexes</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb345"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a>(tc/unroll (tc/fold-by DS [<span class="at">:V1</span>]) [<span class="at">:V4</span> <span class="at">:V2</span> <span class="at">:V3</span>] {<span class="at">:indexes</span>? <span class="va">true</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:indexes</th>
<th>:V4</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>C</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td>B</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td>A</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td>C</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td>B</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td>A</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>C</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td>B</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb346"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a>(tc/unroll (tc/fold-by DS [<span class="at">:V1</span>]) [<span class="at">:V4</span> <span class="at">:V2</span> <span class="at">:V3</span>] {<span class="at">:indexes</span>? <span class="st">"vector idx"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">vector idx</th>
<th>:V4</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>C</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td>B</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td>A</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td>C</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td>B</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td>A</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td>C</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td>B</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>You can also force datatypes</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb347"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a>    (tc/fold-by [<span class="at">:V1</span>])</span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a>    (tc/unroll [<span class="at">:V4</span> <span class="at">:V2</span> <span class="at">:V3</span>] {<span class="at">:datatypes</span> {<span class="at">:V4</span> <span class="at">:string</span></span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">:V2</span> <span class="at">:int16</span></span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">:V3</span> <span class="at">:float32</span>}})</span>
<span id="cb347-6"><a href="#cb347-6" aria-hidden="true" tabindex="-1"></a>    (tc/info <span class="at">:columns</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed :column info [4 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:name</th>
<th>:datatype</th>
<th style="text-align: right;">:n-elems</th>
<th>:categorical?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:V1</td>
<td>:int64</td>
<td style="text-align: right;">9</td>
<td></td>
</tr>
<tr class="even">
<td>:V4</td>
<td>:string</td>
<td style="text-align: right;">9</td>
<td>true</td>
</tr>
<tr class="odd">
<td>:V2</td>
<td>:int16</td>
<td style="text-align: right;">9</td>
<td></td>
</tr>
<tr class="even">
<td>:V3</td>
<td>:float32</td>
<td style="text-align: right;">9</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>This works also on grouped dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb348"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V1</span>)</span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>    (tc/fold-by [<span class="at">:V1</span> <span class="at">:V4</span>])</span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a>    (tc/unroll <span class="at">:V3</span> {<span class="at">:indexes</span>? <span class="va">true</span>})</span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th>:V4</th>
<th>:V2</th>
<th style="text-align: right;">:indexes</th>
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>A</td>
<td>[1 7]</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>A</td>
<td>[1 7]</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>C</td>
<td>[3 9]</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>C</td>
<td>[3 9]</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>B</td>
<td>[5]</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>B</td>
<td>[2 8]</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>B</td>
<td>[2 8]</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>A</td>
<td>[4]</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>C</td>
<td>[6]</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.5</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="reshape" class="level3">
<h3 class="anchored" data-anchor-id="reshape">Reshape</h3>
<p>Reshaping data provides two types of operations:</p>
<ul>
<li><code>pivot-&gt;longer</code> - converting columns to rows</li>
<li><code>pivot-&gt;wider</code> - converting rows to columns</li>
</ul>
<p>Both functions are inspired on <a href="https://tidyr.tidyverse.org/articles/pivot.html">tidyr</a> R package and provide almost the same functionality.</p>
<p>All examples are taken from mentioned above documentation.</p>
<p>Both functions work only on regular dataset.</p>
<section id="longer" class="level4">
<h4 class="anchored" data-anchor-id="longer">Longer</h4>
<p><code>pivot-&gt;longer</code> converts columns to rows. Column names are treated as data.</p>
<p>Arguments:</p>
<ul>
<li>dataset</li>
<li>columns selector</li>
<li>options:
<ul>
<li><code>:target-columns</code> - names of the columns created or columns pattern (see below) (default: <code>:$column</code>)</li>
<li><code>:value-column-name</code> - name of the column for values (default: <code>:$value</code>)</li>
<li><code>:splitter</code> - string, regular expression or function which splits source column names into data</li>
<li><code>:drop-missing?</code> - remove rows with missing? (default: <code>true</code>)</li>
<li><code>:datatypes</code> - map of target columns data types</li>
<li><code>:coerce-to-number</code> - try to convert extracted values to numbers if possible (default: true)</li>
</ul></li>
</ul>
<p><code>:target-columns</code> - can be:</p>
<ul>
<li>column name - source columns names are put there as a data</li>
<li>column names as seqence - source columns names after split are put separately into <code>:target-columns</code> as data</li>
<li>pattern - is a sequence of names, where some of the names are <code>nil</code>. <code>nil</code> is replaced by a name taken from splitter and such column is used for values.</li>
</ul>
<hr>
<p>Create rows from all columns but <code>"religion"</code>.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb349"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> relig-income </span>(tc/dataset <span class="st">"data/relig_income.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb350"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>relig-income</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/relig_income.csv [18 11]:</p>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>religion</th>
<th style="text-align: right;">&lt;$10k</th>
<th style="text-align: right;">$10-20k</th>
<th style="text-align: right;">$20-30k</th>
<th style="text-align: right;">$30-40k</th>
<th style="text-align: right;">$40-50k</th>
<th style="text-align: right;">$50-75k</th>
<th style="text-align: right;">$75-100k</th>
<th style="text-align: right;">$100-150k</th>
<th style="text-align: right;">&gt;150k</th>
<th style="text-align: right;">Don’t know/refused</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Agnostic</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">137</td>
<td style="text-align: right;">122</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">96</td>
</tr>
<tr class="even">
<td>Atheist</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">76</td>
</tr>
<tr class="odd">
<td>Buddhist</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="even">
<td>Catholic</td>
<td style="text-align: right;">418</td>
<td style="text-align: right;">617</td>
<td style="text-align: right;">732</td>
<td style="text-align: right;">670</td>
<td style="text-align: right;">638</td>
<td style="text-align: right;">1116</td>
<td style="text-align: right;">949</td>
<td style="text-align: right;">792</td>
<td style="text-align: right;">633</td>
<td style="text-align: right;">1489</td>
</tr>
<tr class="odd">
<td>Don’t know/refused</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">116</td>
</tr>
<tr class="even">
<td>Evangelical Prot</td>
<td style="text-align: right;">575</td>
<td style="text-align: right;">869</td>
<td style="text-align: right;">1064</td>
<td style="text-align: right;">982</td>
<td style="text-align: right;">881</td>
<td style="text-align: right;">1486</td>
<td style="text-align: right;">949</td>
<td style="text-align: right;">723</td>
<td style="text-align: right;">414</td>
<td style="text-align: right;">1529</td>
</tr>
<tr class="odd">
<td>Hindu</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">37</td>
</tr>
<tr class="even">
<td>Historically Black Prot</td>
<td style="text-align: right;">228</td>
<td style="text-align: right;">244</td>
<td style="text-align: right;">236</td>
<td style="text-align: right;">238</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">223</td>
<td style="text-align: right;">131</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">78</td>
<td style="text-align: right;">339</td>
</tr>
<tr class="odd">
<td>Jehovah’s Witness</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">37</td>
</tr>
<tr class="even">
<td>Jewish</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">151</td>
<td style="text-align: right;">162</td>
</tr>
<tr class="odd">
<td>Mainline Prot</td>
<td style="text-align: right;">289</td>
<td style="text-align: right;">495</td>
<td style="text-align: right;">619</td>
<td style="text-align: right;">655</td>
<td style="text-align: right;">651</td>
<td style="text-align: right;">1107</td>
<td style="text-align: right;">939</td>
<td style="text-align: right;">753</td>
<td style="text-align: right;">634</td>
<td style="text-align: right;">1328</td>
</tr>
<tr class="even">
<td>Mormon</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">112</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">69</td>
</tr>
<tr class="odd">
<td>Muslim</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="even">
<td>Orthodox</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">73</td>
</tr>
<tr class="odd">
<td>Other Christian</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td>Other Faiths</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">71</td>
</tr>
<tr class="odd">
<td>Other World Religions</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td>Unaffiliated</td>
<td style="text-align: right;">217</td>
<td style="text-align: right;">299</td>
<td style="text-align: right;">374</td>
<td style="text-align: right;">365</td>
<td style="text-align: right;">341</td>
<td style="text-align: right;">528</td>
<td style="text-align: right;">407</td>
<td style="text-align: right;">321</td>
<td style="text-align: right;">258</td>
<td style="text-align: right;">597</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb351"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a>(tc/pivot-&gt;longer relig-income (<span class="kw">complement</span> #{<span class="st">"religion"</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/relig_income.csv [180 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>religion</th>
<th>:<span class="math inline">\(column | :\)</span>value</th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Agnostic</td>
<td>&lt;$10k</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="even">
<td>Atheist</td>
<td>&lt;$10k</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td>Buddhist</td>
<td>&lt;$10k</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="even">
<td>Catholic</td>
<td>&lt;$10k</td>
<td style="text-align: right;">418</td>
</tr>
<tr class="odd">
<td>Don’t know/refused</td>
<td>&lt;$10k</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td>Evangelical Prot</td>
<td>&lt;$10k</td>
<td style="text-align: right;">575</td>
</tr>
<tr class="odd">
<td>Hindu</td>
<td>&lt;$10k</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>Historically Black Prot</td>
<td>&lt;$10k</td>
<td style="text-align: right;">228</td>
</tr>
<tr class="odd">
<td>Jehovah’s Witness</td>
<td>&lt;$10k</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="even">
<td>Jewish</td>
<td>&lt;$10k</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td>Historically Black Prot</td>
<td>&gt;150k</td>
<td style="text-align: right;">78</td>
</tr>
<tr class="odd">
<td>Jehovah’s Witness</td>
<td>&gt;150k</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td>Jewish</td>
<td>&gt;150k</td>
<td style="text-align: right;">151</td>
</tr>
<tr class="odd">
<td>Mainline Prot</td>
<td>&gt;150k</td>
<td style="text-align: right;">634</td>
</tr>
<tr class="even">
<td>Mormon</td>
<td>&gt;150k</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="odd">
<td>Muslim</td>
<td>&gt;150k</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td>Orthodox</td>
<td>&gt;150k</td>
<td style="text-align: right;">46</td>
</tr>
<tr class="odd">
<td>Other Christian</td>
<td>&gt;150k</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td>Other Faiths</td>
<td>&gt;150k</td>
<td style="text-align: right;">41</td>
</tr>
<tr class="odd">
<td>Other World Religions</td>
<td>&gt;150k</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td>Unaffiliated</td>
<td>&gt;150k</td>
<td style="text-align: right;">258</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Convert only columns starting with <code>"wk"</code> and pack them into <code>:week</code> column, values go to <code>:rank</code> column</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb352"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> bilboard </span>(<span class="kw">-&gt;</span> (tc/dataset <span class="st">"data/billboard.csv.gz"</span>)</span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>                  (tc/drop-columns <span class="at">:type/boolean</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>drop some boolean columns, tidyr just skips them</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb353"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;&gt;</span> bilboard</span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a>     (tc/column-names)</span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a>     (<span class="kw">take</span> <span class="dv">13</span>)</span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a>     (tc/select-columns bilboard))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/billboard.csv.gz [317 13]:</p>
<table class="table">
<colgroup>
<col style="width: 16%">
<col style="width: 23%">
<col style="width: 12%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th>artist</th>
<th>track</th>
<th>date.entered</th>
<th style="text-align: right;">wk1</th>
<th style="text-align: right;">wk2</th>
<th style="text-align: right;">wk3</th>
<th style="text-align: right;">wk4</th>
<th style="text-align: right;">wk5</th>
<th style="text-align: right;">wk6</th>
<th style="text-align: right;">wk7</th>
<th style="text-align: right;">wk8</th>
<th style="text-align: right;">wk9</th>
<th style="text-align: right;">wk10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2 Pac</td>
<td>Baby Don’t Cry (Keep…</td>
<td>2000-02-26</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">82</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">94</td>
<td style="text-align: right;">99</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>2Ge+her</td>
<td>The Hardest Part Of …</td>
<td>2000-09-02</td>
<td style="text-align: right;">91</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">92</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td>3 Doors Down</td>
<td>Kryptonite</td>
<td>2000-04-08</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">51</td>
</tr>
<tr class="even">
<td>3 Doors Down</td>
<td>Loser</td>
<td>2000-10-21</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">61</td>
</tr>
<tr class="odd">
<td>504 Boyz</td>
<td>Wobble Wobble</td>
<td>2000-04-15</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">57</td>
</tr>
<tr class="even">
<td>98^0</td>
<td>Give Me Just One Nig…</td>
<td>2000-08-19</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td>A*Teens</td>
<td>Dancing Queen</td>
<td>2000-07-08</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>Aaliyah</td>
<td>I Don’t Wanna</td>
<td>2000-01-29</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">36</td>
</tr>
<tr class="odd">
<td>Aaliyah</td>
<td>Try Again</td>
<td>2000-03-18</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td>Adams, Yolanda</td>
<td>Open My Heart</td>
<td>2000-08-26</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">59</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td>Wallflowers, The</td>
<td>Sleepwalker</td>
<td>2000-10-28</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td>Westlife</td>
<td>Swear It Again</td>
<td>2000-04-01</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">82</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="even">
<td>Williams, Robbie</td>
<td>Angels</td>
<td>1999-11-20</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">53</td>
</tr>
<tr class="odd">
<td>Wills, Mark</td>
<td>Back At One</td>
<td>2000-01-15</td>
<td style="text-align: right;">89</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">46</td>
</tr>
<tr class="even">
<td>Worley, Darryl</td>
<td>When You Need My Lov…</td>
<td>2000-06-17</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">92</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">80</td>
</tr>
<tr class="odd">
<td>Wright, Chely</td>
<td>It Was</td>
<td>2000-03-04</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">78</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">98</td>
</tr>
<tr class="even">
<td>Yankee Grey</td>
<td>Another Nine Minutes</td>
<td>2000-04-29</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">79</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td>Yearwood, Trisha</td>
<td>Real Live Woman</td>
<td>2000-04-01</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">82</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">91</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>Ying Yang Twins</td>
<td>Whistle While You Tw…</td>
<td>2000-03-18</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">94</td>
<td style="text-align: right;">91</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">78</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">78</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">89</td>
</tr>
<tr class="odd">
<td>Zombie Nation</td>
<td>Kernkraft 400</td>
<td>2000-09-02</td>
<td style="text-align: right;">99</td>
<td style="text-align: right;">99</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>matchbox twenty</td>
<td>Bent</td>
<td>2000-04-29</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">12</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb354"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a>(tc/pivot-&gt;longer bilboard #(clojure.string/starts-with? <span class="va">%</span> <span class="st">"wk"</span>) {<span class="at">:target-columns</span> <span class="at">:week</span></span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">:value-column-name</span> <span class="at">:rank</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/billboard.csv.gz [5307 5]:</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 35%">
<col style="width: 19%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>artist</th>
<th>track</th>
<th>date.entered</th>
<th>:week</th>
<th style="text-align: right;">:rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3 Doors Down</td>
<td>Kryptonite</td>
<td>2000-04-08</td>
<td>wk35</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td>Braxton, Toni</td>
<td>He Wasn’t Man Enough</td>
<td>2000-03-18</td>
<td>wk35</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="odd">
<td>Creed</td>
<td>Higher</td>
<td>1999-09-11</td>
<td>wk35</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="even">
<td>Creed</td>
<td>With Arms Wide Open</td>
<td>2000-05-13</td>
<td>wk35</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td>Hill, Faith</td>
<td>Breathe</td>
<td>1999-11-06</td>
<td>wk35</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td>Joe</td>
<td>I Wanna Know</td>
<td>2000-01-01</td>
<td>wk35</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td>Lonestar</td>
<td>Amazed</td>
<td>1999-06-05</td>
<td>wk35</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="even">
<td>Vertical Horizon</td>
<td>Everything You Want</td>
<td>2000-01-22</td>
<td>wk35</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="odd">
<td>matchbox twenty</td>
<td>Bent</td>
<td>2000-04-29</td>
<td>wk35</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="even">
<td>Creed</td>
<td>Higher</td>
<td>1999-09-11</td>
<td>wk55</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td>Savage Garden</td>
<td>I Knew I Loved You</td>
<td>1999-10-23</td>
<td>wk24</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td>Sisqo</td>
<td>Incomplete</td>
<td>2000-06-24</td>
<td>wk24</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="even">
<td>Sisqo</td>
<td>Thong Song</td>
<td>2000-01-29</td>
<td>wk24</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td>Smash Mouth</td>
<td>Then The Morning Com…</td>
<td>1999-10-30</td>
<td>wk24</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="even">
<td>Son By Four</td>
<td>A Puro Dolor (Purest…</td>
<td>2000-04-08</td>
<td>wk24</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="odd">
<td>Sonique</td>
<td>It Feels So Good</td>
<td>2000-01-22</td>
<td>wk24</td>
<td style="text-align: right;">49</td>
</tr>
<tr class="even">
<td>SoulDecision</td>
<td>Faded</td>
<td>2000-07-08</td>
<td>wk24</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td>Sting</td>
<td>Desert Rose</td>
<td>2000-05-13</td>
<td>wk24</td>
<td style="text-align: right;">45</td>
</tr>
<tr class="even">
<td>Train</td>
<td>Meet Virginia</td>
<td>1999-10-09</td>
<td>wk24</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="odd">
<td>Vertical Horizon</td>
<td>Everything You Want</td>
<td>2000-01-22</td>
<td>wk24</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td>matchbox twenty</td>
<td>Bent</td>
<td>2000-04-29</td>
<td>wk24</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>We can create numerical column out of column names</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb355"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a>(tc/pivot-&gt;longer bilboard #(clojure.string/starts-with? <span class="va">%</span> <span class="st">"wk"</span>) {<span class="at">:target-columns</span> <span class="at">:week</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">:value-column-name</span> <span class="at">:rank</span></span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">:splitter</span> <span class="ss">#"wk(.*)"</span></span>
<span id="cb355-4"><a href="#cb355-4" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">:datatypes</span> {<span class="at">:week</span> <span class="at">:int16</span>}})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/billboard.csv.gz [5307 5]:</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 35%">
<col style="width: 19%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>artist</th>
<th>track</th>
<th>date.entered</th>
<th style="text-align: right;">:week</th>
<th style="text-align: right;">:rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3 Doors Down</td>
<td>Kryptonite</td>
<td>2000-04-08</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="even">
<td>Creed</td>
<td>Higher</td>
<td>1999-09-11</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td>Creed</td>
<td>With Arms Wide Open</td>
<td>2000-05-13</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">37</td>
</tr>
<tr class="even">
<td>Hill, Faith</td>
<td>Breathe</td>
<td>1999-11-06</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="odd">
<td>Lonestar</td>
<td>Amazed</td>
<td>1999-06-05</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>3 Doors Down</td>
<td>Kryptonite</td>
<td>2000-04-08</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="odd">
<td>Creed</td>
<td>Higher</td>
<td>1999-09-11</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="even">
<td>Hill, Faith</td>
<td>Breathe</td>
<td>1999-11-06</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">49</td>
</tr>
<tr class="odd">
<td>Lonestar</td>
<td>Amazed</td>
<td>1999-06-05</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td>2 Pac</td>
<td>Baby Don’t Cry (Keep…</td>
<td>2000-02-26</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">94</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td>matchbox twenty</td>
<td>Bent</td>
<td>2000-04-29</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="odd">
<td>3 Doors Down</td>
<td>Kryptonite</td>
<td>2000-04-08</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td>Braxton, Toni</td>
<td>He Wasn’t Man Enough</td>
<td>2000-03-18</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="odd">
<td>Creed</td>
<td>Higher</td>
<td>1999-09-11</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="even">
<td>Creed</td>
<td>With Arms Wide Open</td>
<td>2000-05-13</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td>Hill, Faith</td>
<td>Breathe</td>
<td>1999-11-06</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>Joe</td>
<td>I Wanna Know</td>
<td>2000-01-01</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td>Lonestar</td>
<td>Amazed</td>
<td>1999-06-05</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td>Nelly</td>
<td>(Hot S**t) Country G…</td>
<td>2000-04-29</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">49</td>
</tr>
<tr class="odd">
<td>Vertical Horizon</td>
<td>Everything You Want</td>
<td>2000-01-22</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="even">
<td>matchbox twenty</td>
<td>Bent</td>
<td>2000-04-29</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">30</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>When column names contain observation data, such column names can be splitted and data can be restored into separate columns.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb356"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> who </span>(tc/dataset <span class="st">"data/who.csv.gz"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb357"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;&gt;</span> who</span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a>     (tc/column-names)</span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a>     (<span class="kw">take</span> <span class="dv">10</span>)</span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a>     (tc/select-columns who))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/who.csv.gz [7240 10]:</p>
<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>country</th>
<th>iso2</th>
<th>iso3</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">new_sp_m014</th>
<th style="text-align: right;">new_sp_m1524</th>
<th style="text-align: right;">new_sp_m2534</th>
<th style="text-align: right;">new_sp_m3544</th>
<th style="text-align: right;">new_sp_m4554</th>
<th style="text-align: right;">new_sp_m5564</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Afghanistan</td>
<td>AF</td>
<td>AFG</td>
<td style="text-align: right;">1980</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>Afghanistan</td>
<td>AF</td>
<td>AFG</td>
<td style="text-align: right;">1981</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td>Afghanistan</td>
<td>AF</td>
<td>AFG</td>
<td style="text-align: right;">1982</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>Afghanistan</td>
<td>AF</td>
<td>AFG</td>
<td style="text-align: right;">1983</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td>Afghanistan</td>
<td>AF</td>
<td>AFG</td>
<td style="text-align: right;">1984</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>Afghanistan</td>
<td>AF</td>
<td>AFG</td>
<td style="text-align: right;">1985</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td>Afghanistan</td>
<td>AF</td>
<td>AFG</td>
<td style="text-align: right;">1986</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>Afghanistan</td>
<td>AF</td>
<td>AFG</td>
<td style="text-align: right;">1987</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td>Afghanistan</td>
<td>AF</td>
<td>AFG</td>
<td style="text-align: right;">1988</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>Afghanistan</td>
<td>AF</td>
<td>AFG</td>
<td style="text-align: right;">1989</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td>Zimbabwe</td>
<td>ZW</td>
<td>ZWE</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;">133</td>
<td style="text-align: right;">874</td>
<td style="text-align: right;">3048</td>
<td style="text-align: right;">2228</td>
<td style="text-align: right;">981</td>
<td style="text-align: right;">367</td>
</tr>
<tr class="odd">
<td>Zimbabwe</td>
<td>ZW</td>
<td>ZWE</td>
<td style="text-align: right;">2004</td>
<td style="text-align: right;">187</td>
<td style="text-align: right;">833</td>
<td style="text-align: right;">2908</td>
<td style="text-align: right;">2298</td>
<td style="text-align: right;">1056</td>
<td style="text-align: right;">366</td>
</tr>
<tr class="even">
<td>Zimbabwe</td>
<td>ZW</td>
<td>ZWE</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">837</td>
<td style="text-align: right;">2264</td>
<td style="text-align: right;">1855</td>
<td style="text-align: right;">762</td>
<td style="text-align: right;">295</td>
</tr>
<tr class="odd">
<td>Zimbabwe</td>
<td>ZW</td>
<td>ZWE</td>
<td style="text-align: right;">2006</td>
<td style="text-align: right;">215</td>
<td style="text-align: right;">736</td>
<td style="text-align: right;">2391</td>
<td style="text-align: right;">1939</td>
<td style="text-align: right;">896</td>
<td style="text-align: right;">348</td>
</tr>
<tr class="even">
<td>Zimbabwe</td>
<td>ZW</td>
<td>ZWE</td>
<td style="text-align: right;">2007</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">500</td>
<td style="text-align: right;">3693</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">716</td>
<td style="text-align: right;">292</td>
</tr>
<tr class="odd">
<td>Zimbabwe</td>
<td>ZW</td>
<td>ZWE</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">614</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3316</td>
<td style="text-align: right;">704</td>
<td style="text-align: right;">263</td>
</tr>
<tr class="even">
<td>Zimbabwe</td>
<td>ZW</td>
<td>ZWE</td>
<td style="text-align: right;">2009</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">578</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3471</td>
<td style="text-align: right;">681</td>
<td style="text-align: right;">293</td>
</tr>
<tr class="odd">
<td>Zimbabwe</td>
<td>ZW</td>
<td>ZWE</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">710</td>
<td style="text-align: right;">2208</td>
<td style="text-align: right;">1682</td>
<td style="text-align: right;">761</td>
<td style="text-align: right;">350</td>
</tr>
<tr class="even">
<td>Zimbabwe</td>
<td>ZW</td>
<td>ZWE</td>
<td style="text-align: right;">2011</td>
<td style="text-align: right;">152</td>
<td style="text-align: right;">784</td>
<td style="text-align: right;">2467</td>
<td style="text-align: right;">2071</td>
<td style="text-align: right;">780</td>
<td style="text-align: right;">377</td>
</tr>
<tr class="odd">
<td>Zimbabwe</td>
<td>ZW</td>
<td>ZWE</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">783</td>
<td style="text-align: right;">2421</td>
<td style="text-align: right;">2086</td>
<td style="text-align: right;">796</td>
<td style="text-align: right;">360</td>
</tr>
<tr class="even">
<td>Zimbabwe</td>
<td>ZW</td>
<td>ZWE</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb358"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a>(tc/pivot-&gt;longer who #(clojure.string/starts-with? <span class="va">%</span> <span class="st">"new"</span>) {<span class="at">:target-columns</span> [<span class="at">:diagnosis</span> <span class="at">:gender</span> <span class="at">:age</span>]</span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">:splitter</span> <span class="ss">#"new_?(.*)_(.)(.*)"</span></span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">:value-column-name</span> <span class="at">:count</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/who.csv.gz [76046 8]:</p>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th>country</th>
<th>iso2</th>
<th>iso3</th>
<th style="text-align: right;">year</th>
<th>:diagnosis</th>
<th>:gender</th>
<th style="text-align: right;">:age</th>
<th style="text-align: right;">:count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Albania</td>
<td>AL</td>
<td>ALB</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">1524</td>
<td style="text-align: right;">60</td>
</tr>
<tr class="even">
<td>Algeria</td>
<td>DZ</td>
<td>DZA</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">1524</td>
<td style="text-align: right;">1021</td>
</tr>
<tr class="odd">
<td>Andorra</td>
<td>AD</td>
<td>AND</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">1524</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>Angola</td>
<td>AO</td>
<td>AGO</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">1524</td>
<td style="text-align: right;">2992</td>
</tr>
<tr class="odd">
<td>Anguilla</td>
<td>AI</td>
<td>AIA</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">1524</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>Antigua and Barbuda</td>
<td>AG</td>
<td>ATG</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">1524</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td>Argentina</td>
<td>AR</td>
<td>ARG</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">1524</td>
<td style="text-align: right;">1124</td>
</tr>
<tr class="even">
<td>Armenia</td>
<td>AM</td>
<td>ARM</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">1524</td>
<td style="text-align: right;">116</td>
</tr>
<tr class="odd">
<td>Australia</td>
<td>AU</td>
<td>AUS</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">1524</td>
<td style="text-align: right;">105</td>
</tr>
<tr class="even">
<td>Austria</td>
<td>AT</td>
<td>AUT</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">1524</td>
<td style="text-align: right;">44</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td>United Arab Emirates</td>
<td>AE</td>
<td>ARE</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">2534</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td>United Kingdom of Great Britain and Northern Ireland</td>
<td>GB</td>
<td>GBR</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">2534</td>
<td style="text-align: right;">1158</td>
</tr>
<tr class="even">
<td>United States of America</td>
<td>US</td>
<td>USA</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">2534</td>
<td style="text-align: right;">829</td>
</tr>
<tr class="odd">
<td>Uruguay</td>
<td>UY</td>
<td>URY</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">2534</td>
<td style="text-align: right;">142</td>
</tr>
<tr class="even">
<td>Uzbekistan</td>
<td>UZ</td>
<td>UZB</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">2534</td>
<td style="text-align: right;">2371</td>
</tr>
<tr class="odd">
<td>Vanuatu</td>
<td>VU</td>
<td>VUT</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">2534</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td>Venezuela (Bolivarian Republic of)</td>
<td>VE</td>
<td>VEN</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">2534</td>
<td style="text-align: right;">739</td>
</tr>
<tr class="odd">
<td>Viet Nam</td>
<td>VN</td>
<td>VNM</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">2534</td>
<td style="text-align: right;">6302</td>
</tr>
<tr class="even">
<td>Yemen</td>
<td>YE</td>
<td>YEM</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">2534</td>
<td style="text-align: right;">1113</td>
</tr>
<tr class="odd">
<td>Zambia</td>
<td>ZM</td>
<td>ZMB</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">2534</td>
<td style="text-align: right;">7808</td>
</tr>
<tr class="even">
<td>Zimbabwe</td>
<td>ZW</td>
<td>ZWE</td>
<td style="text-align: right;">2013</td>
<td>rel</td>
<td>m</td>
<td style="text-align: right;">2534</td>
<td style="text-align: right;">5331</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>When data contains multiple observations per row, we can use splitter and pattern for target columns to create new columns and put values there. In following dataset we have two obseravations <code>dob</code> and <code>gender</code> for two childs. We want to put child infomation into the column and leave dob and gender for values.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb359"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> family </span>(tc/dataset <span class="st">"data/family.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb360"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a>family</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/family.csv [5 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">family</th>
<th>dob_child1</th>
<th>dob_child2</th>
<th style="text-align: right;">gender_child1</th>
<th style="text-align: right;">gender_child2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>1998-11-26</td>
<td>2000-01-29</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>1996-06-22</td>
<td></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>2002-07-11</td>
<td>2004-04-05</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>2004-10-10</td>
<td>2009-08-27</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td>2000-12-05</td>
<td>2005-02-28</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb361"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a>(tc/pivot-&gt;longer family (<span class="kw">complement</span> #{<span class="st">"family"</span>}) {<span class="at">:target-columns</span> [<span class="va">nil</span> <span class="at">:child</span>]</span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">:splitter</span> <span class="st">"_"</span></span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">:datatypes</span> {<span class="st">"gender"</span> <span class="at">:int16</span>}})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/family.csv [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">family</th>
<th>:child</th>
<th>dob</th>
<th style="text-align: right;">gender</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>child1</td>
<td>1998-11-26</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>child1</td>
<td>1996-06-22</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>child1</td>
<td>2002-07-11</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>child1</td>
<td>2004-10-10</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td>child1</td>
<td>2000-12-05</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>child2</td>
<td>2000-01-29</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>child2</td>
<td>2004-04-05</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>child2</td>
<td>2009-08-27</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td>child2</td>
<td>2005-02-28</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Similar here, we have two observations: <code>x</code> and <code>y</code> in four groups.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb362"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> anscombe </span>(tc/dataset <span class="st">"data/anscombe.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb363"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a>anscombe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/anscombe.csv [11 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">x1</th>
<th style="text-align: right;">x2</th>
<th style="text-align: right;">x3</th>
<th style="text-align: right;">x4</th>
<th style="text-align: right;">y1</th>
<th style="text-align: right;">y2</th>
<th style="text-align: right;">y3</th>
<th style="text-align: right;">y4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8.04</td>
<td style="text-align: right;">9.14</td>
<td style="text-align: right;">7.46</td>
<td style="text-align: right;">6.58</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">6.95</td>
<td style="text-align: right;">8.14</td>
<td style="text-align: right;">6.77</td>
<td style="text-align: right;">5.76</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">7.58</td>
<td style="text-align: right;">8.74</td>
<td style="text-align: right;">12.74</td>
<td style="text-align: right;">7.71</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8.81</td>
<td style="text-align: right;">8.77</td>
<td style="text-align: right;">7.11</td>
<td style="text-align: right;">8.84</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8.33</td>
<td style="text-align: right;">9.26</td>
<td style="text-align: right;">7.81</td>
<td style="text-align: right;">8.47</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9.96</td>
<td style="text-align: right;">8.10</td>
<td style="text-align: right;">8.84</td>
<td style="text-align: right;">7.04</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">7.24</td>
<td style="text-align: right;">6.13</td>
<td style="text-align: right;">6.08</td>
<td style="text-align: right;">5.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">4.26</td>
<td style="text-align: right;">3.10</td>
<td style="text-align: right;">5.39</td>
<td style="text-align: right;">12.50</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">10.84</td>
<td style="text-align: right;">9.13</td>
<td style="text-align: right;">8.15</td>
<td style="text-align: right;">5.56</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4.82</td>
<td style="text-align: right;">7.26</td>
<td style="text-align: right;">6.42</td>
<td style="text-align: right;">7.91</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">5.68</td>
<td style="text-align: right;">4.74</td>
<td style="text-align: right;">5.73</td>
<td style="text-align: right;">6.89</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb364"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a>(tc/pivot-&gt;longer anscombe <span class="at">:all</span> {<span class="at">:splitter</span> <span class="ss">#"(.)(.)"</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">:target-columns</span> [<span class="va">nil</span> <span class="at">:set</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/anscombe.csv [44 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:set</th>
<th style="text-align: right;">x</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">8.04</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">6.95</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">7.58</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">8.81</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">8.33</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">9.96</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">7.24</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4.26</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">10.84</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4.82</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">6.58</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">5.76</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">7.71</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8.84</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8.47</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">7.04</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">5.25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">12.50</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">5.56</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">7.91</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">6.89</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb365"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> pnl </span>(tc/dataset {<span class="at">:x</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>]</span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:a</span> [<span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span>]</span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:b</span> [<span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span>]</span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:y1</span> (<span class="kw">repeatedly</span> <span class="dv">4</span> <span class="kw">rand</span>)</span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:y2</span> (<span class="kw">repeatedly</span> <span class="dv">4</span> <span class="kw">rand</span>)</span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:z1</span> [<span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span>]</span>
<span id="cb365-8"><a href="#cb365-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:z2</span> [-<span class="dv">2</span> -<span class="dv">2</span> -<span class="dv">2</span> -<span class="dv">2</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb366"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>pnl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 7]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:x</th>
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:y1</th>
<th style="text-align: right;">:y2</th>
<th style="text-align: right;">:z1</th>
<th style="text-align: right;">:z2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.69127183</td>
<td style="text-align: right;">0.41625028</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.11085224</td>
<td style="text-align: right;">0.74719559</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.38598424</td>
<td style="text-align: right;">0.34354355</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.85275504</td>
<td style="text-align: right;">0.41933923</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-2</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb367"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>(tc/pivot-&gt;longer pnl [<span class="at">:y1</span> <span class="at">:y2</span> <span class="at">:z1</span> <span class="at">:z2</span>] {<span class="at">:target-columns</span> [<span class="va">nil</span> <span class="at">:times</span>]</span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">:splitter</span> <span class="ss">#":(.)(.)"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [8 6]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:x</th>
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:times</th>
<th style="text-align: right;">y</th>
<th style="text-align: right;">z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.69127183</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.11085224</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.38598424</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.85275504</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.41625028</td>
<td style="text-align: right;">-2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.74719559</td>
<td style="text-align: right;">-2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.34354355</td>
<td style="text-align: right;">-2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.41933923</td>
<td style="text-align: right;">-2</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="wider" class="level4">
<h4 class="anchored" data-anchor-id="wider">Wider</h4>
<p><code>pivot-&gt;wider</code> converts rows to columns.</p>
<p>Arguments:</p>
<ul>
<li>dataset</li>
<li><code>columns-selector</code> - values from selected columns are converted to new columns</li>
<li><code>value-columns</code> - what are values</li>
</ul>
<p>When multiple columns are used as columns selector, names are joined using <code>:concat-columns-with</code> option. <code>:concat-columns-with</code> can be a string or function (default: “_“). Function accepts sequence of names.</p>
<p>When <code>columns-selector</code> creates non unique set of values, they are folded using <code>:fold-fn</code> (default: <code>vec</code>) option.</p>
<p>When <code>value-columns</code> is a sequence, multiple observations as columns are created appending value column names into new columns. Column names are joined using <code>:concat-value-with</code> option. <code>:concat-value-with</code> can be a string or function (default: “-”). Function accepts current column name and value.</p>
<hr>
<p>Use <code>station</code> as a name source for columns and <code>seen</code> for values</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb368"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> fish </span>(tc/dataset <span class="st">"data/fish_encounters.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb369"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a>fish</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/fish_encounters.csv [114 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">fish</th>
<th>station</th>
<th style="text-align: right;">seen</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4842</td>
<td>Release</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4842</td>
<td>I80_1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4842</td>
<td>Lisbon</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4842</td>
<td>Rstr</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4842</td>
<td>Base_TD</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4842</td>
<td>BCE</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4842</td>
<td>BCW</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4842</td>
<td>BCE2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4842</td>
<td>BCW2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4842</td>
<td>MAE</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">4862</td>
<td>BCE</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4862</td>
<td>BCW</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4862</td>
<td>BCE2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4862</td>
<td>BCW2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4863</td>
<td>Release</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4863</td>
<td>I80_1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4864</td>
<td>Release</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4864</td>
<td>I80_1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4865</td>
<td>Release</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4865</td>
<td>I80_1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4865</td>
<td>Lisbon</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb370"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a>(tc/pivot-&gt;wider fish <span class="st">"station"</span> <span class="st">"seen"</span> {<span class="at">:drop-missing</span>? <span class="va">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/fish_encounters.csv [19 12]:</p>
<table class="table">
<colgroup>
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">fish</th>
<th style="text-align: right;">Release</th>
<th style="text-align: right;">I80_1</th>
<th style="text-align: right;">Lisbon</th>
<th style="text-align: right;">Rstr</th>
<th style="text-align: right;">Base_TD</th>
<th style="text-align: right;">BCE</th>
<th style="text-align: right;">BCW</th>
<th style="text-align: right;">BCE2</th>
<th style="text-align: right;">BCW2</th>
<th style="text-align: right;">MAE</th>
<th style="text-align: right;">MAW</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4842</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4843</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4844</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4858</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4861</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4857</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4862</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4850</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4845</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4855</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4859</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4848</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4847</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4865</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4849</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4851</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4854</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4863</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4864</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>If selected columns contain multiple values, such values should be folded.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb371"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> warpbreaks </span>(tc/dataset <span class="st">"data/warpbreaks.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb372"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>warpbreaks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/warpbreaks.csv [54 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">breaks</th>
<th>wool</th>
<th>tension</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">26</td>
<td>A</td>
<td>L</td>
</tr>
<tr class="even">
<td style="text-align: right;">30</td>
<td>A</td>
<td>L</td>
</tr>
<tr class="odd">
<td style="text-align: right;">54</td>
<td>A</td>
<td>L</td>
</tr>
<tr class="even">
<td style="text-align: right;">25</td>
<td>A</td>
<td>L</td>
</tr>
<tr class="odd">
<td style="text-align: right;">70</td>
<td>A</td>
<td>L</td>
</tr>
<tr class="even">
<td style="text-align: right;">52</td>
<td>A</td>
<td>L</td>
</tr>
<tr class="odd">
<td style="text-align: right;">51</td>
<td>A</td>
<td>L</td>
</tr>
<tr class="even">
<td style="text-align: right;">26</td>
<td>A</td>
<td>L</td>
</tr>
<tr class="odd">
<td style="text-align: right;">67</td>
<td>A</td>
<td>L</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td>A</td>
<td>M</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td style="text-align: right;">39</td>
<td>B</td>
<td>M</td>
</tr>
<tr class="odd">
<td style="text-align: right;">29</td>
<td>B</td>
<td>M</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td>B</td>
<td>H</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21</td>
<td>B</td>
<td>H</td>
</tr>
<tr class="even">
<td style="text-align: right;">24</td>
<td>B</td>
<td>H</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td>B</td>
<td>H</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td>B</td>
<td>H</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td>B</td>
<td>H</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td>B</td>
<td>H</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td>B</td>
<td>H</td>
</tr>
<tr class="even">
<td style="text-align: right;">28</td>
<td>B</td>
<td>H</td>
</tr>
</tbody>
</table>
</div>
<p>Let’s see how many values are for each type of <code>wool</code> and <code>tension</code> groups</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb373"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> warpbreaks</span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="st">"wool"</span> <span class="st">"tension"</span>])</span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate {<span class="at">:n</span> tc/row-count}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>wool</th>
<th>tension</th>
<th style="text-align: right;">:n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>L</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td>A</td>
<td>M</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td>A</td>
<td>H</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td>B</td>
<td>L</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td>B</td>
<td>M</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td>B</td>
<td>H</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb374"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> warpbreaks</span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>    (tc/reorder-columns [<span class="st">"wool"</span> <span class="st">"tension"</span> <span class="st">"breaks"</span>])</span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>    (tc/pivot-&gt;wider <span class="st">"wool"</span> <span class="st">"breaks"</span> {<span class="at">:fold-fn</span> <span class="kw">vec</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/warpbreaks.csv [3 3]:</p>
<table class="table">
<colgroup>
<col style="width: 13%">
<col style="width: 43%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>tension</th>
<th>A</th>
<th>B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>L</td>
<td>[26 30 54 25 70 52 51 26 67]</td>
<td>[27 14 29 19 29 31 41 20 44]</td>
</tr>
<tr class="even">
<td>M</td>
<td>[18 21 29 17 12 18 35 30 36]</td>
<td>[42 26 19 16 39 28 21 39 29]</td>
</tr>
<tr class="odd">
<td>H</td>
<td>[36 21 24 18 10 43 28 15 26]</td>
<td>[20 21 24 17 13 15 15 16 28]</td>
</tr>
</tbody>
</table>
</div>
<p>We can also calculate mean (aggreate values)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb375"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> warpbreaks</span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>    (tc/reorder-columns [<span class="st">"wool"</span> <span class="st">"tension"</span> <span class="st">"breaks"</span>])</span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a>    (tc/pivot-&gt;wider <span class="st">"wool"</span> <span class="st">"breaks"</span> {<span class="at">:fold-fn</span> tech.v3.datatype.functional/mean}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/warpbreaks.csv [3 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>tension</th>
<th style="text-align: right;">A</th>
<th style="text-align: right;">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>L</td>
<td style="text-align: right;">44.55555556</td>
<td style="text-align: right;">28.22222222</td>
</tr>
<tr class="even">
<td>M</td>
<td style="text-align: right;">24.00000000</td>
<td style="text-align: right;">28.77777778</td>
</tr>
<tr class="odd">
<td>H</td>
<td style="text-align: right;">24.55555556</td>
<td style="text-align: right;">18.77777778</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Multiple source columns, joined with default separator.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb376"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> production </span>(tc/dataset <span class="st">"data/production.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb377"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a>production</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/production.csv [45 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>product</th>
<th>country</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">production</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>AI</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">1.63727158</td>
</tr>
<tr class="even">
<td>A</td>
<td>AI</td>
<td style="text-align: right;">2001</td>
<td style="text-align: right;">0.15870784</td>
</tr>
<tr class="odd">
<td>A</td>
<td>AI</td>
<td style="text-align: right;">2002</td>
<td style="text-align: right;">-1.56797745</td>
</tr>
<tr class="even">
<td>A</td>
<td>AI</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;">-0.44455509</td>
</tr>
<tr class="odd">
<td>A</td>
<td>AI</td>
<td style="text-align: right;">2004</td>
<td style="text-align: right;">-0.07133701</td>
</tr>
<tr class="even">
<td>A</td>
<td>AI</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">1.61183090</td>
</tr>
<tr class="odd">
<td>A</td>
<td>AI</td>
<td style="text-align: right;">2006</td>
<td style="text-align: right;">-0.70434682</td>
</tr>
<tr class="even">
<td>A</td>
<td>AI</td>
<td style="text-align: right;">2007</td>
<td style="text-align: right;">-1.53550542</td>
</tr>
<tr class="odd">
<td>A</td>
<td>AI</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">0.83907155</td>
</tr>
<tr class="even">
<td>A</td>
<td>AI</td>
<td style="text-align: right;">2009</td>
<td style="text-align: right;">-0.37424110</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td>B</td>
<td>EI</td>
<td style="text-align: right;">2004</td>
<td style="text-align: right;">0.62564999</td>
</tr>
<tr class="odd">
<td>B</td>
<td>EI</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">-1.34530299</td>
</tr>
<tr class="even">
<td>B</td>
<td>EI</td>
<td style="text-align: right;">2006</td>
<td style="text-align: right;">-0.97184975</td>
</tr>
<tr class="odd">
<td>B</td>
<td>EI</td>
<td style="text-align: right;">2007</td>
<td style="text-align: right;">-1.69715821</td>
</tr>
<tr class="even">
<td>B</td>
<td>EI</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">0.04556128</td>
</tr>
<tr class="odd">
<td>B</td>
<td>EI</td>
<td style="text-align: right;">2009</td>
<td style="text-align: right;">1.19315043</td>
</tr>
<tr class="even">
<td>B</td>
<td>EI</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">-1.60557503</td>
</tr>
<tr class="odd">
<td>B</td>
<td>EI</td>
<td style="text-align: right;">2011</td>
<td style="text-align: right;">-0.77235497</td>
</tr>
<tr class="even">
<td>B</td>
<td>EI</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">-2.50262738</td>
</tr>
<tr class="odd">
<td>B</td>
<td>EI</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">-1.62753769</td>
</tr>
<tr class="even">
<td>B</td>
<td>EI</td>
<td style="text-align: right;">2014</td>
<td style="text-align: right;">0.03329645</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb378"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>(tc/pivot-&gt;wider production [<span class="st">"product"</span> <span class="st">"country"</span>] <span class="st">"production"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/production.csv [15 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">A_AI</th>
<th style="text-align: right;">B_AI</th>
<th style="text-align: right;">B_EI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2000</td>
<td style="text-align: right;">1.63727158</td>
<td style="text-align: right;">-0.02617661</td>
<td style="text-align: right;">1.40470848</td>
</tr>
<tr class="even">
<td style="text-align: right;">2001</td>
<td style="text-align: right;">0.15870784</td>
<td style="text-align: right;">-0.68863576</td>
<td style="text-align: right;">-0.59618369</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2002</td>
<td style="text-align: right;">-1.56797745</td>
<td style="text-align: right;">0.06248741</td>
<td style="text-align: right;">-0.26568579</td>
</tr>
<tr class="even">
<td style="text-align: right;">2003</td>
<td style="text-align: right;">-0.44455509</td>
<td style="text-align: right;">-0.72339686</td>
<td style="text-align: right;">0.65257808</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2004</td>
<td style="text-align: right;">-0.07133701</td>
<td style="text-align: right;">0.47248952</td>
<td style="text-align: right;">0.62564999</td>
</tr>
<tr class="even">
<td style="text-align: right;">2005</td>
<td style="text-align: right;">1.61183090</td>
<td style="text-align: right;">-0.94173861</td>
<td style="text-align: right;">-1.34530299</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2006</td>
<td style="text-align: right;">-0.70434682</td>
<td style="text-align: right;">-0.34782108</td>
<td style="text-align: right;">-0.97184975</td>
</tr>
<tr class="even">
<td style="text-align: right;">2007</td>
<td style="text-align: right;">-1.53550542</td>
<td style="text-align: right;">0.52425284</td>
<td style="text-align: right;">-1.69715821</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2008</td>
<td style="text-align: right;">0.83907155</td>
<td style="text-align: right;">1.83230937</td>
<td style="text-align: right;">0.04556128</td>
</tr>
<tr class="even">
<td style="text-align: right;">2009</td>
<td style="text-align: right;">-0.37424110</td>
<td style="text-align: right;">0.10706491</td>
<td style="text-align: right;">1.19315043</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2010</td>
<td style="text-align: right;">-0.71158926</td>
<td style="text-align: right;">-0.32903664</td>
<td style="text-align: right;">-1.60557503</td>
</tr>
<tr class="even">
<td style="text-align: right;">2011</td>
<td style="text-align: right;">1.12805634</td>
<td style="text-align: right;">-1.78319121</td>
<td style="text-align: right;">-0.77235497</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2012</td>
<td style="text-align: right;">1.45718247</td>
<td style="text-align: right;">0.61125798</td>
<td style="text-align: right;">-2.50262738</td>
</tr>
<tr class="even">
<td style="text-align: right;">2013</td>
<td style="text-align: right;">-1.55934101</td>
<td style="text-align: right;">-0.78526092</td>
<td style="text-align: right;">-1.62753769</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">-0.11695838</td>
<td style="text-align: right;">0.97843635</td>
<td style="text-align: right;">0.03329645</td>
</tr>
</tbody>
</table>
</div>
<p>Joined with custom function</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb379"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a>(tc/pivot-&gt;wider production [<span class="st">"product"</span> <span class="st">"country"</span>] <span class="st">"production"</span> {<span class="at">:concat-columns-with</span> <span class="kw">vec</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/production.csv [15 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">[A AI]</th>
<th style="text-align: right;">[B AI]</th>
<th style="text-align: right;">[B EI]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2000</td>
<td style="text-align: right;">1.63727158</td>
<td style="text-align: right;">-0.02617661</td>
<td style="text-align: right;">1.40470848</td>
</tr>
<tr class="even">
<td style="text-align: right;">2001</td>
<td style="text-align: right;">0.15870784</td>
<td style="text-align: right;">-0.68863576</td>
<td style="text-align: right;">-0.59618369</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2002</td>
<td style="text-align: right;">-1.56797745</td>
<td style="text-align: right;">0.06248741</td>
<td style="text-align: right;">-0.26568579</td>
</tr>
<tr class="even">
<td style="text-align: right;">2003</td>
<td style="text-align: right;">-0.44455509</td>
<td style="text-align: right;">-0.72339686</td>
<td style="text-align: right;">0.65257808</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2004</td>
<td style="text-align: right;">-0.07133701</td>
<td style="text-align: right;">0.47248952</td>
<td style="text-align: right;">0.62564999</td>
</tr>
<tr class="even">
<td style="text-align: right;">2005</td>
<td style="text-align: right;">1.61183090</td>
<td style="text-align: right;">-0.94173861</td>
<td style="text-align: right;">-1.34530299</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2006</td>
<td style="text-align: right;">-0.70434682</td>
<td style="text-align: right;">-0.34782108</td>
<td style="text-align: right;">-0.97184975</td>
</tr>
<tr class="even">
<td style="text-align: right;">2007</td>
<td style="text-align: right;">-1.53550542</td>
<td style="text-align: right;">0.52425284</td>
<td style="text-align: right;">-1.69715821</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2008</td>
<td style="text-align: right;">0.83907155</td>
<td style="text-align: right;">1.83230937</td>
<td style="text-align: right;">0.04556128</td>
</tr>
<tr class="even">
<td style="text-align: right;">2009</td>
<td style="text-align: right;">-0.37424110</td>
<td style="text-align: right;">0.10706491</td>
<td style="text-align: right;">1.19315043</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2010</td>
<td style="text-align: right;">-0.71158926</td>
<td style="text-align: right;">-0.32903664</td>
<td style="text-align: right;">-1.60557503</td>
</tr>
<tr class="even">
<td style="text-align: right;">2011</td>
<td style="text-align: right;">1.12805634</td>
<td style="text-align: right;">-1.78319121</td>
<td style="text-align: right;">-0.77235497</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2012</td>
<td style="text-align: right;">1.45718247</td>
<td style="text-align: right;">0.61125798</td>
<td style="text-align: right;">-2.50262738</td>
</tr>
<tr class="even">
<td style="text-align: right;">2013</td>
<td style="text-align: right;">-1.55934101</td>
<td style="text-align: right;">-0.78526092</td>
<td style="text-align: right;">-1.62753769</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">-0.11695838</td>
<td style="text-align: right;">0.97843635</td>
<td style="text-align: right;">0.03329645</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Multiple value columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb380"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> income </span>(tc/dataset <span class="st">"data/us_rent_income.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb381"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>income</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/us_rent_income.csv [104 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">GEOID</th>
<th>NAME</th>
<th>variable</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">moe</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>Alabama</td>
<td>income</td>
<td style="text-align: right;">24476</td>
<td style="text-align: right;">136</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>Alabama</td>
<td>rent</td>
<td style="text-align: right;">747</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>Alaska</td>
<td>income</td>
<td style="text-align: right;">32940</td>
<td style="text-align: right;">508</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>Alaska</td>
<td>rent</td>
<td style="text-align: right;">1200</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td>Arizona</td>
<td>income</td>
<td style="text-align: right;">27517</td>
<td style="text-align: right;">148</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>Arizona</td>
<td>rent</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td>Arkansas</td>
<td>income</td>
<td style="text-align: right;">23789</td>
<td style="text-align: right;">165</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td>Arkansas</td>
<td>rent</td>
<td style="text-align: right;">709</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td>California</td>
<td>income</td>
<td style="text-align: right;">29454</td>
<td style="text-align: right;">109</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td>California</td>
<td>rent</td>
<td style="text-align: right;">1358</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">51</td>
<td>Virginia</td>
<td>rent</td>
<td style="text-align: right;">1166</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">53</td>
<td>Washington</td>
<td>income</td>
<td style="text-align: right;">32318</td>
<td style="text-align: right;">113</td>
</tr>
<tr class="even">
<td style="text-align: right;">53</td>
<td>Washington</td>
<td>rent</td>
<td style="text-align: right;">1120</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">54</td>
<td>West Virginia</td>
<td>income</td>
<td style="text-align: right;">23707</td>
<td style="text-align: right;">203</td>
</tr>
<tr class="even">
<td style="text-align: right;">54</td>
<td>West Virginia</td>
<td>rent</td>
<td style="text-align: right;">681</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">55</td>
<td>Wisconsin</td>
<td>income</td>
<td style="text-align: right;">29868</td>
<td style="text-align: right;">135</td>
</tr>
<tr class="even">
<td style="text-align: right;">55</td>
<td>Wisconsin</td>
<td>rent</td>
<td style="text-align: right;">813</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">56</td>
<td>Wyoming</td>
<td>income</td>
<td style="text-align: right;">30854</td>
<td style="text-align: right;">342</td>
</tr>
<tr class="even">
<td style="text-align: right;">56</td>
<td>Wyoming</td>
<td>rent</td>
<td style="text-align: right;">828</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">72</td>
<td>Puerto Rico</td>
<td>income</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">72</td>
<td>Puerto Rico</td>
<td>rent</td>
<td style="text-align: right;">464</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb382"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a>(tc/pivot-&gt;wider income <span class="st">"variable"</span> [<span class="st">"estimate"</span> <span class="st">"moe"</span>] {<span class="at">:drop-missing</span>? <span class="va">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/us_rent_income.csv [52 6]:</p>
<table class="table">
<colgroup>
<col style="width: 8%">
<col style="width: 26%">
<col style="width: 20%">
<col style="width: 14%">
<col style="width: 18%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">GEOID</th>
<th>NAME</th>
<th style="text-align: right;">income-estimate</th>
<th style="text-align: right;">income-moe</th>
<th style="text-align: right;">rent-estimate</th>
<th style="text-align: right;">rent-moe</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>Alabama</td>
<td style="text-align: right;">24476</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">747</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>Alaska</td>
<td style="text-align: right;">32940</td>
<td style="text-align: right;">508</td>
<td style="text-align: right;">1200</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td>Arizona</td>
<td style="text-align: right;">27517</td>
<td style="text-align: right;">148</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td>Arkansas</td>
<td style="text-align: right;">23789</td>
<td style="text-align: right;">165</td>
<td style="text-align: right;">709</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td>California</td>
<td style="text-align: right;">29454</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">1358</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td>Colorado</td>
<td style="text-align: right;">32401</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">1125</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td>Connecticut</td>
<td style="text-align: right;">35326</td>
<td style="text-align: right;">195</td>
<td style="text-align: right;">1123</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td>Delaware</td>
<td style="text-align: right;">31560</td>
<td style="text-align: right;">247</td>
<td style="text-align: right;">1076</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td>District of Columbia</td>
<td style="text-align: right;">43198</td>
<td style="text-align: right;">681</td>
<td style="text-align: right;">1424</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td>Florida</td>
<td style="text-align: right;">25952</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">1077</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">46</td>
<td>South Dakota</td>
<td style="text-align: right;">28821</td>
<td style="text-align: right;">276</td>
<td style="text-align: right;">696</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">47</td>
<td>Tennessee</td>
<td style="text-align: right;">25453</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">808</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">48</td>
<td>Texas</td>
<td style="text-align: right;">28063</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">952</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">49</td>
<td>Utah</td>
<td style="text-align: right;">27928</td>
<td style="text-align: right;">239</td>
<td style="text-align: right;">948</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">50</td>
<td>Vermont</td>
<td style="text-align: right;">29351</td>
<td style="text-align: right;">361</td>
<td style="text-align: right;">945</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">51</td>
<td>Virginia</td>
<td style="text-align: right;">32545</td>
<td style="text-align: right;">202</td>
<td style="text-align: right;">1166</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">53</td>
<td>Washington</td>
<td style="text-align: right;">32318</td>
<td style="text-align: right;">113</td>
<td style="text-align: right;">1120</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">54</td>
<td>West Virginia</td>
<td style="text-align: right;">23707</td>
<td style="text-align: right;">203</td>
<td style="text-align: right;">681</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">55</td>
<td>Wisconsin</td>
<td style="text-align: right;">29868</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">813</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">56</td>
<td>Wyoming</td>
<td style="text-align: right;">30854</td>
<td style="text-align: right;">342</td>
<td style="text-align: right;">828</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: right;">72</td>
<td>Puerto Rico</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">464</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
<p>Value concatenated by custom function</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb383"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>(tc/pivot-&gt;wider income <span class="st">"variable"</span> [<span class="st">"estimate"</span> <span class="st">"moe"</span>] {<span class="at">:concat-columns-with</span> <span class="kw">vec</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">:concat-value-with</span> <span class="kw">vector</span></span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">:drop-missing</span>? <span class="va">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/us_rent_income.csv [52 6]:</p>
<table class="table">
<colgroup>
<col style="width: 7%">
<col style="width: 24%">
<col style="width: 20%">
<col style="width: 15%">
<col style="width: 18%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">GEOID</th>
<th>NAME</th>
<th style="text-align: right;">[income estimate]</th>
<th style="text-align: right;">[income moe]</th>
<th style="text-align: right;">[rent estimate]</th>
<th style="text-align: right;">[rent moe]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>Alabama</td>
<td style="text-align: right;">24476</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">747</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>Alaska</td>
<td style="text-align: right;">32940</td>
<td style="text-align: right;">508</td>
<td style="text-align: right;">1200</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td>Arizona</td>
<td style="text-align: right;">27517</td>
<td style="text-align: right;">148</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td>Arkansas</td>
<td style="text-align: right;">23789</td>
<td style="text-align: right;">165</td>
<td style="text-align: right;">709</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td>California</td>
<td style="text-align: right;">29454</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">1358</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td>Colorado</td>
<td style="text-align: right;">32401</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">1125</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td>Connecticut</td>
<td style="text-align: right;">35326</td>
<td style="text-align: right;">195</td>
<td style="text-align: right;">1123</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td>Delaware</td>
<td style="text-align: right;">31560</td>
<td style="text-align: right;">247</td>
<td style="text-align: right;">1076</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td>District of Columbia</td>
<td style="text-align: right;">43198</td>
<td style="text-align: right;">681</td>
<td style="text-align: right;">1424</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td>Florida</td>
<td style="text-align: right;">25952</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">1077</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">46</td>
<td>South Dakota</td>
<td style="text-align: right;">28821</td>
<td style="text-align: right;">276</td>
<td style="text-align: right;">696</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">47</td>
<td>Tennessee</td>
<td style="text-align: right;">25453</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">808</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">48</td>
<td>Texas</td>
<td style="text-align: right;">28063</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">952</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">49</td>
<td>Utah</td>
<td style="text-align: right;">27928</td>
<td style="text-align: right;">239</td>
<td style="text-align: right;">948</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">50</td>
<td>Vermont</td>
<td style="text-align: right;">29351</td>
<td style="text-align: right;">361</td>
<td style="text-align: right;">945</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">51</td>
<td>Virginia</td>
<td style="text-align: right;">32545</td>
<td style="text-align: right;">202</td>
<td style="text-align: right;">1166</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">53</td>
<td>Washington</td>
<td style="text-align: right;">32318</td>
<td style="text-align: right;">113</td>
<td style="text-align: right;">1120</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">54</td>
<td>West Virginia</td>
<td style="text-align: right;">23707</td>
<td style="text-align: right;">203</td>
<td style="text-align: right;">681</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">55</td>
<td>Wisconsin</td>
<td style="text-align: right;">29868</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">813</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">56</td>
<td>Wyoming</td>
<td style="text-align: right;">30854</td>
<td style="text-align: right;">342</td>
<td style="text-align: right;">828</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: right;">72</td>
<td>Puerto Rico</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">464</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Reshape contact data</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb384"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> contacts </span>(tc/dataset <span class="st">"data/contacts.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb385"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>contacts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/contacts.csv [6 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>field</th>
<th>value</th>
<th style="text-align: right;">person_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>name</td>
<td>Jiena McLellan</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>company</td>
<td>Toyota</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td>name</td>
<td>John Smith</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td>company</td>
<td>google</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td>email</td>
<td>john@google.com</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td>name</td>
<td>Huxley Ratcliffe</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb386"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a>(tc/pivot-&gt;wider contacts <span class="st">"field"</span> <span class="st">"value"</span> {<span class="at">:drop-missing</span>? <span class="va">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/contacts.csv [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">person_id</th>
<th>name</th>
<th>company</th>
<th>email</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>John Smith</td>
<td>google</td>
<td>john@google.com</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>Jiena McLellan</td>
<td>Toyota</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>Huxley Ratcliffe</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="reshaping" class="level4">
<h4 class="anchored" data-anchor-id="reshaping">Reshaping</h4>
<p>A couple of <code>tidyr</code> examples of more complex reshaping.</p>
<hr>
<p><a href="https://tidyr.tidyverse.org/articles/pivot.html#world-bank">World bank</a></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb387"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> world-bank-pop </span>(tc/dataset <span class="st">"data/world_bank_pop.csv.gz"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb388"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;&gt;</span> world-bank-pop</span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a>     (tc/column-names)</span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a>     (<span class="kw">take</span> <span class="dv">8</span>)</span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a>     (tc/select-columns world-bank-pop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/world_bank_pop.csv.gz [1056 8]:</p>
<table class="table">
<colgroup>
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>country</th>
<th>indicator</th>
<th style="text-align: right;">2000</th>
<th style="text-align: right;">2001</th>
<th style="text-align: right;">2002</th>
<th style="text-align: right;">2003</th>
<th style="text-align: right;">2004</th>
<th style="text-align: right;">2005</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ABW</td>
<td>SP.URB.TOTL</td>
<td style="text-align: right;">4.24440000E+04</td>
<td style="text-align: right;">4.30480000E+04</td>
<td style="text-align: right;">4.36700000E+04</td>
<td style="text-align: right;">4.42460000E+04</td>
<td style="text-align: right;">4.46690000E+04</td>
<td style="text-align: right;">4.48890000E+04</td>
</tr>
<tr class="even">
<td>ABW</td>
<td>SP.URB.GROW</td>
<td style="text-align: right;">1.18263237E+00</td>
<td style="text-align: right;">1.41302122E+00</td>
<td style="text-align: right;">1.43455953E+00</td>
<td style="text-align: right;">1.31036044E+00</td>
<td style="text-align: right;">9.51477684E-01</td>
<td style="text-align: right;">4.91302715E-01</td>
</tr>
<tr class="odd">
<td>ABW</td>
<td>SP.POP.TOTL</td>
<td style="text-align: right;">9.08530000E+04</td>
<td style="text-align: right;">9.28980000E+04</td>
<td style="text-align: right;">9.49920000E+04</td>
<td style="text-align: right;">9.70170000E+04</td>
<td style="text-align: right;">9.87370000E+04</td>
<td style="text-align: right;">1.00031000E+05</td>
</tr>
<tr class="even">
<td>ABW</td>
<td>SP.POP.GROW</td>
<td style="text-align: right;">2.05502678E+00</td>
<td style="text-align: right;">2.22593013E+00</td>
<td style="text-align: right;">2.22905605E+00</td>
<td style="text-align: right;">2.10935434E+00</td>
<td style="text-align: right;">1.75735287E+00</td>
<td style="text-align: right;">1.30203884E+00</td>
</tr>
<tr class="odd">
<td>AFG</td>
<td>SP.URB.TOTL</td>
<td style="text-align: right;">4.43629900E+06</td>
<td style="text-align: right;">4.64805500E+06</td>
<td style="text-align: right;">4.89295100E+06</td>
<td style="text-align: right;">5.15568600E+06</td>
<td style="text-align: right;">5.42677000E+06</td>
<td style="text-align: right;">5.69182300E+06</td>
</tr>
<tr class="even">
<td>AFG</td>
<td>SP.URB.GROW</td>
<td style="text-align: right;">3.91222846E+00</td>
<td style="text-align: right;">4.66283822E+00</td>
<td style="text-align: right;">5.13467454E+00</td>
<td style="text-align: right;">5.23045853E+00</td>
<td style="text-align: right;">5.12439302E+00</td>
<td style="text-align: right;">4.76864700E+00</td>
</tr>
<tr class="odd">
<td>AFG</td>
<td>SP.POP.TOTL</td>
<td style="text-align: right;">2.00937560E+07</td>
<td style="text-align: right;">2.09664630E+07</td>
<td style="text-align: right;">2.19799230E+07</td>
<td style="text-align: right;">2.30648510E+07</td>
<td style="text-align: right;">2.41189790E+07</td>
<td style="text-align: right;">2.50707980E+07</td>
</tr>
<tr class="even">
<td>AFG</td>
<td>SP.POP.GROW</td>
<td style="text-align: right;">3.49465874E+00</td>
<td style="text-align: right;">4.25150411E+00</td>
<td style="text-align: right;">4.72052846E+00</td>
<td style="text-align: right;">4.81804112E+00</td>
<td style="text-align: right;">4.46891840E+00</td>
<td style="text-align: right;">3.87047016E+00</td>
</tr>
<tr class="odd">
<td>AGO</td>
<td>SP.URB.TOTL</td>
<td style="text-align: right;">8.23476600E+06</td>
<td style="text-align: right;">8.70800000E+06</td>
<td style="text-align: right;">9.21878700E+06</td>
<td style="text-align: right;">9.76519700E+06</td>
<td style="text-align: right;">1.03435060E+07</td>
<td style="text-align: right;">1.09494240E+07</td>
</tr>
<tr class="even">
<td>AGO</td>
<td>SP.URB.GROW</td>
<td style="text-align: right;">5.43749411E+00</td>
<td style="text-align: right;">5.58771954E+00</td>
<td style="text-align: right;">5.70013237E+00</td>
<td style="text-align: right;">5.75812711E+00</td>
<td style="text-align: right;">5.75341450E+00</td>
<td style="text-align: right;">5.69279690E+00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td>ZAF</td>
<td>SP.URB.GROW</td>
<td style="text-align: right;">2.32229180E+00</td>
<td style="text-align: right;">2.26080492E+00</td>
<td style="text-align: right;">2.29242659E+00</td>
<td style="text-align: right;">2.25719919E+00</td>
<td style="text-align: right;">2.18014731E+00</td>
<td style="text-align: right;">2.09725981E+00</td>
</tr>
<tr class="odd">
<td>ZAF</td>
<td>SP.POP.TOTL</td>
<td style="text-align: right;">4.57283150E+07</td>
<td style="text-align: right;">4.63850060E+07</td>
<td style="text-align: right;">4.70261730E+07</td>
<td style="text-align: right;">4.76487270E+07</td>
<td style="text-align: right;">4.82473950E+07</td>
<td style="text-align: right;">4.88205860E+07</td>
</tr>
<tr class="even">
<td>ZAF</td>
<td>SP.POP.GROW</td>
<td style="text-align: right;">1.47499416E+00</td>
<td style="text-align: right;">1.42585702E+00</td>
<td style="text-align: right;">1.37280586E+00</td>
<td style="text-align: right;">1.31515951E+00</td>
<td style="text-align: right;">1.24859226E+00</td>
<td style="text-align: right;">1.18102315E+00</td>
</tr>
<tr class="odd">
<td>ZMB</td>
<td>SP.URB.TOTL</td>
<td style="text-align: right;">3.66507600E+06</td>
<td style="text-align: right;">3.78866000E+06</td>
<td style="text-align: right;">3.94496500E+06</td>
<td style="text-align: right;">4.10631700E+06</td>
<td style="text-align: right;">4.27387500E+06</td>
<td style="text-align: right;">4.44857100E+06</td>
</tr>
<tr class="even">
<td>ZMB</td>
<td>SP.URB.GROW</td>
<td style="text-align: right;">1.50532147E+00</td>
<td style="text-align: right;">3.31633227E+00</td>
<td style="text-align: right;">4.04276877E+00</td>
<td style="text-align: right;">4.00864374E+00</td>
<td style="text-align: right;">3.99943902E+00</td>
<td style="text-align: right;">4.00620111E+00</td>
</tr>
<tr class="odd">
<td>ZMB</td>
<td>SP.POP.TOTL</td>
<td style="text-align: right;">1.05312210E+07</td>
<td style="text-align: right;">1.08241250E+07</td>
<td style="text-align: right;">1.11204090E+07</td>
<td style="text-align: right;">1.14219840E+07</td>
<td style="text-align: right;">1.17317460E+07</td>
<td style="text-align: right;">1.20521560E+07</td>
</tr>
<tr class="even">
<td>ZMB</td>
<td>SP.POP.GROW</td>
<td style="text-align: right;">2.80705843E+00</td>
<td style="text-align: right;">2.74331654E+00</td>
<td style="text-align: right;">2.70046295E+00</td>
<td style="text-align: right;">2.67578507E+00</td>
<td style="text-align: right;">2.67585813E+00</td>
<td style="text-align: right;">2.69450644E+00</td>
</tr>
<tr class="odd">
<td>ZWE</td>
<td>SP.URB.TOTL</td>
<td style="text-align: right;">4.12598700E+06</td>
<td style="text-align: right;">4.22551900E+06</td>
<td style="text-align: right;">4.32330700E+06</td>
<td style="text-align: right;">4.35604100E+06</td>
<td style="text-align: right;">4.38192000E+06</td>
<td style="text-align: right;">4.41384500E+06</td>
</tr>
<tr class="even">
<td>ZWE</td>
<td>SP.URB.GROW</td>
<td style="text-align: right;">2.52373518E+00</td>
<td style="text-align: right;">2.38368296E+00</td>
<td style="text-align: right;">2.28785252E+00</td>
<td style="text-align: right;">7.54299867E-01</td>
<td style="text-align: right;">5.92336717E-01</td>
<td style="text-align: right;">7.25920717E-01</td>
</tr>
<tr class="odd">
<td>ZWE</td>
<td>SP.POP.TOTL</td>
<td style="text-align: right;">1.22222510E+07</td>
<td style="text-align: right;">1.23661650E+07</td>
<td style="text-align: right;">1.25005250E+07</td>
<td style="text-align: right;">1.26338970E+07</td>
<td style="text-align: right;">1.27775110E+07</td>
<td style="text-align: right;">1.29400320E+07</td>
</tr>
<tr class="even">
<td>ZWE</td>
<td>SP.POP.GROW</td>
<td style="text-align: right;">1.29878201E+00</td>
<td style="text-align: right;">1.17059711E+00</td>
<td style="text-align: right;">1.08065293E+00</td>
<td style="text-align: right;">1.06127964E+00</td>
<td style="text-align: right;">1.13032327E+00</td>
<td style="text-align: right;">1.26390895E+00</td>
</tr>
</tbody>
</table>
</div>
<p>Step 1 - convert years column into values</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb389"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> pop2 </span>(tc/pivot-&gt;longer world-bank-pop (<span class="kw">map</span> <span class="kw">str</span> (<span class="kw">range</span> <span class="dv">2000</span> <span class="dv">2018</span>)) {<span class="at">:drop-missing</span>? <span class="va">false</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="at">:target-columns</span> [<span class="st">"year"</span>]</span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="at">:value-column-name</span> <span class="st">"value"</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb390"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a>pop2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/world_bank_pop.csv.gz [19008 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>country</th>
<th>indicator</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ABW</td>
<td>SP.URB.TOTL</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">4.43600000E+04</td>
</tr>
<tr class="even">
<td>ABW</td>
<td>SP.URB.GROW</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">6.69503994E-01</td>
</tr>
<tr class="odd">
<td>ABW</td>
<td>SP.POP.TOTL</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">1.03187000E+05</td>
</tr>
<tr class="even">
<td>ABW</td>
<td>SP.POP.GROW</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">5.92914005E-01</td>
</tr>
<tr class="odd">
<td>AFG</td>
<td>SP.URB.TOTL</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">7.73396400E+06</td>
</tr>
<tr class="even">
<td>AFG</td>
<td>SP.URB.GROW</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">4.19297967E+00</td>
</tr>
<tr class="odd">
<td>AFG</td>
<td>SP.POP.TOTL</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">3.17316880E+07</td>
</tr>
<tr class="even">
<td>AFG</td>
<td>SP.POP.GROW</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">3.31522413E+00</td>
</tr>
<tr class="odd">
<td>AGO</td>
<td>SP.URB.TOTL</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">1.61194910E+07</td>
</tr>
<tr class="even">
<td>AGO</td>
<td>SP.URB.GROW</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">4.72272270E+00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td>ZAF</td>
<td>SP.URB.GROW</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">2.23077040E+00</td>
</tr>
<tr class="odd">
<td>ZAF</td>
<td>SP.POP.TOTL</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">5.29982130E+07</td>
</tr>
<tr class="even">
<td>ZAF</td>
<td>SP.POP.GROW</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">1.39596592E+00</td>
</tr>
<tr class="odd">
<td>ZMB</td>
<td>SP.URB.TOTL</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">5.93201300E+06</td>
</tr>
<tr class="even">
<td>ZMB</td>
<td>SP.URB.GROW</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">4.25944078E+00</td>
</tr>
<tr class="odd">
<td>ZMB</td>
<td>SP.POP.TOTL</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">1.46999370E+07</td>
</tr>
<tr class="even">
<td>ZMB</td>
<td>SP.POP.GROW</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">3.00513283E+00</td>
</tr>
<tr class="odd">
<td>ZWE</td>
<td>SP.URB.TOTL</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">4.83015300E+06</td>
</tr>
<tr class="even">
<td>ZWE</td>
<td>SP.URB.GROW</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">1.67857380E+00</td>
</tr>
<tr class="odd">
<td>ZWE</td>
<td>SP.POP.TOTL</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">1.47108260E+07</td>
</tr>
<tr class="even">
<td>ZWE</td>
<td>SP.POP.GROW</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">2.22830616E+00</td>
</tr>
</tbody>
</table>
</div>
<p>Step 2 - separate <code>"indicate"</code> column</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb391"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> pop3 </span>(tc/separate-column pop2</span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"indicator"</span> [<span class="st">"area"</span> <span class="st">"variable"</span>]</span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a>                               #(<span class="kw">rest</span> (clojure.string/split <span class="va">%</span> <span class="ss">#"\."</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb392"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a>pop3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/world_bank_pop.csv.gz [19008 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th>country</th>
<th>area</th>
<th>variable</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ABW</td>
<td>URB</td>
<td>TOTL</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">4.43600000E+04</td>
</tr>
<tr class="even">
<td>ABW</td>
<td>URB</td>
<td>GROW</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">6.69503994E-01</td>
</tr>
<tr class="odd">
<td>ABW</td>
<td>POP</td>
<td>TOTL</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">1.03187000E+05</td>
</tr>
<tr class="even">
<td>ABW</td>
<td>POP</td>
<td>GROW</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">5.92914005E-01</td>
</tr>
<tr class="odd">
<td>AFG</td>
<td>URB</td>
<td>TOTL</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">7.73396400E+06</td>
</tr>
<tr class="even">
<td>AFG</td>
<td>URB</td>
<td>GROW</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">4.19297967E+00</td>
</tr>
<tr class="odd">
<td>AFG</td>
<td>POP</td>
<td>TOTL</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">3.17316880E+07</td>
</tr>
<tr class="even">
<td>AFG</td>
<td>POP</td>
<td>GROW</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">3.31522413E+00</td>
</tr>
<tr class="odd">
<td>AGO</td>
<td>URB</td>
<td>TOTL</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">1.61194910E+07</td>
</tr>
<tr class="even">
<td>AGO</td>
<td>URB</td>
<td>GROW</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">4.72272270E+00</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td>ZAF</td>
<td>URB</td>
<td>GROW</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">2.23077040E+00</td>
</tr>
<tr class="odd">
<td>ZAF</td>
<td>POP</td>
<td>TOTL</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">5.29982130E+07</td>
</tr>
<tr class="even">
<td>ZAF</td>
<td>POP</td>
<td>GROW</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">1.39596592E+00</td>
</tr>
<tr class="odd">
<td>ZMB</td>
<td>URB</td>
<td>TOTL</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">5.93201300E+06</td>
</tr>
<tr class="even">
<td>ZMB</td>
<td>URB</td>
<td>GROW</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">4.25944078E+00</td>
</tr>
<tr class="odd">
<td>ZMB</td>
<td>POP</td>
<td>TOTL</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">1.46999370E+07</td>
</tr>
<tr class="even">
<td>ZMB</td>
<td>POP</td>
<td>GROW</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">3.00513283E+00</td>
</tr>
<tr class="odd">
<td>ZWE</td>
<td>URB</td>
<td>TOTL</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">4.83015300E+06</td>
</tr>
<tr class="even">
<td>ZWE</td>
<td>URB</td>
<td>GROW</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">1.67857380E+00</td>
</tr>
<tr class="odd">
<td>ZWE</td>
<td>POP</td>
<td>TOTL</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">1.47108260E+07</td>
</tr>
<tr class="even">
<td>ZWE</td>
<td>POP</td>
<td>GROW</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">2.22830616E+00</td>
</tr>
</tbody>
</table>
</div>
<p>Step 3 - Make columns based on <code>"variable"</code> values.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb393"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a>(tc/pivot-&gt;wider pop3 <span class="st">"variable"</span> <span class="st">"value"</span> {<span class="at">:drop-missing</span>? <span class="va">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/world_bank_pop.csv.gz [9504 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th>country</th>
<th>area</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">TOTL</th>
<th style="text-align: right;">GROW</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ABW</td>
<td>URB</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">4.43600000E+04</td>
<td style="text-align: right;">0.66950399</td>
</tr>
<tr class="even">
<td>ABW</td>
<td>POP</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">1.03187000E+05</td>
<td style="text-align: right;">0.59291401</td>
</tr>
<tr class="odd">
<td>AFG</td>
<td>URB</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">7.73396400E+06</td>
<td style="text-align: right;">4.19297967</td>
</tr>
<tr class="even">
<td>AFG</td>
<td>POP</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">3.17316880E+07</td>
<td style="text-align: right;">3.31522413</td>
</tr>
<tr class="odd">
<td>AGO</td>
<td>URB</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">1.61194910E+07</td>
<td style="text-align: right;">4.72272270</td>
</tr>
<tr class="even">
<td>AGO</td>
<td>POP</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">2.59983400E+07</td>
<td style="text-align: right;">3.53182419</td>
</tr>
<tr class="odd">
<td>ALB</td>
<td>URB</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">1.60350500E+06</td>
<td style="text-align: right;">1.74363937</td>
</tr>
<tr class="even">
<td>ALB</td>
<td>POP</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">2.89509200E+06</td>
<td style="text-align: right;">-0.18321138</td>
</tr>
<tr class="odd">
<td>AND</td>
<td>URB</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">7.15270000E+04</td>
<td style="text-align: right;">-2.11923331</td>
</tr>
<tr class="even">
<td>AND</td>
<td>POP</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">8.07880000E+04</td>
<td style="text-align: right;">-2.01331401</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td>WSM</td>
<td>POP</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">1.89194000E+05</td>
<td style="text-align: right;">0.81144852</td>
</tr>
<tr class="odd">
<td>XKX</td>
<td>URB</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>XKX</td>
<td>POP</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">1.80520000E+06</td>
<td style="text-align: right;">0.78972659</td>
</tr>
<tr class="odd">
<td>YEM</td>
<td>URB</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">8.20982800E+06</td>
<td style="text-align: right;">4.49478765</td>
</tr>
<tr class="even">
<td>YEM</td>
<td>POP</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">2.49099690E+07</td>
<td style="text-align: right;">2.67605025</td>
</tr>
<tr class="odd">
<td>ZAF</td>
<td>URB</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">3.35330290E+07</td>
<td style="text-align: right;">2.23077040</td>
</tr>
<tr class="even">
<td>ZAF</td>
<td>POP</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">5.29982130E+07</td>
<td style="text-align: right;">1.39596592</td>
</tr>
<tr class="odd">
<td>ZMB</td>
<td>URB</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">5.93201300E+06</td>
<td style="text-align: right;">4.25944078</td>
</tr>
<tr class="even">
<td>ZMB</td>
<td>POP</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">1.46999370E+07</td>
<td style="text-align: right;">3.00513283</td>
</tr>
<tr class="odd">
<td>ZWE</td>
<td>URB</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">4.83015300E+06</td>
<td style="text-align: right;">1.67857380</td>
</tr>
<tr class="even">
<td>ZWE</td>
<td>POP</td>
<td style="text-align: right;">2012</td>
<td style="text-align: right;">1.47108260E+07</td>
<td style="text-align: right;">2.22830616</td>
</tr>
</tbody>
</table>
</div>
<hr>
<hr>
<p><a href="https://tidyr.tidyverse.org/articles/pivot.html#multi-choice">Multi-choice</a></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb394"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> multi </span>(tc/dataset {<span class="at">:id</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>]</span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">:choice1</span> [<span class="st">"A"</span> <span class="st">"C"</span> <span class="st">"D"</span> <span class="st">"B"</span>]</span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">:choice2</span> [<span class="st">"B"</span> <span class="st">"B"</span> <span class="va">nil</span> <span class="st">"D"</span>]</span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">:choice3</span> [<span class="st">"C"</span> <span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb395"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a>multi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:id</th>
<th>:choice1</th>
<th>:choice2</th>
<th>:choice3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>A</td>
<td>B</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>C</td>
<td>B</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>D</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>B</td>
<td>D</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>Step 1 - convert all choices into rows and add artificial column to all values which are not missing.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb396"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> multi2 </span>(<span class="kw">-&gt;</span> multi</span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a>                (tc/pivot-&gt;longer (<span class="kw">complement</span> #{<span class="at">:id</span>}))</span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a>                (tc/add-column <span class="at">:checked</span> <span class="va">true</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb397"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a>multi2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [8 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:id</th>
<th>:<span class="math inline">\(column | :\)</span>value</th>
<th>:checked</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>:choice1</td>
<td>A</td>
<td>true</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>:choice1</td>
<td>C</td>
<td>true</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>:choice1</td>
<td>D</td>
<td>true</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>:choice1</td>
<td>B</td>
<td>true</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>:choice2</td>
<td>B</td>
<td>true</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>:choice2</td>
<td>B</td>
<td>true</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td>:choice2</td>
<td>D</td>
<td>true</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>:choice3</td>
<td>C</td>
<td>true</td>
</tr>
</tbody>
</table>
</div>
<p>Step 2 - Convert back to wide form with actual choices as columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb398"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> multi2</span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a>    (tc/drop-columns :$column)</span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true" tabindex="-1"></a>    (tc/pivot-&gt;wider :$value <span class="at">:checked</span> {<span class="at">:drop-missing</span>? <span class="va">false</span>})</span>
<span id="cb398-5"><a href="#cb398-5" aria-hidden="true" tabindex="-1"></a>    (tc/order-by <span class="at">:id</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:id</th>
<th>A</th>
<th>C</th>
<th>D</th>
<th>B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>true</td>
<td>true</td>
<td></td>
<td>true</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td></td>
<td>true</td>
<td></td>
<td>true</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td></td>
<td></td>
<td>true</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td></td>
<td></td>
<td>true</td>
<td>true</td>
</tr>
</tbody>
</table>
</div>
<hr>
<hr>
<p><a href="https://tidyr.tidyverse.org/articles/pivot.html#by-hand">Construction</a></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb399"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> construction </span>(tc/dataset <span class="st">"data/construction.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb400"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> construction-unit-map </span>{<span class="st">"1 unit"</span> <span class="st">"1"</span></span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"2 to 4 units"</span> <span class="st">"2-4"</span></span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"5 units or more"</span> <span class="st">"5+"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb401"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a>construction</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/construction.csv [9 9]:</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Year</th>
<th>Month</th>
<th style="text-align: right;">1 unit</th>
<th>2 to 4 units</th>
<th style="text-align: right;">5 units or more</th>
<th style="text-align: right;">Northeast</th>
<th style="text-align: right;">Midwest</th>
<th style="text-align: right;">South</th>
<th style="text-align: right;">West</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>January</td>
<td style="text-align: right;">859</td>
<td></td>
<td style="text-align: right;">348</td>
<td style="text-align: right;">114</td>
<td style="text-align: right;">169</td>
<td style="text-align: right;">596</td>
<td style="text-align: right;">339</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>February</td>
<td style="text-align: right;">882</td>
<td></td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">655</td>
<td style="text-align: right;">336</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>March</td>
<td style="text-align: right;">862</td>
<td></td>
<td style="text-align: right;">356</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">595</td>
<td style="text-align: right;">330</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>April</td>
<td style="text-align: right;">797</td>
<td></td>
<td style="text-align: right;">447</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">613</td>
<td style="text-align: right;">304</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>May</td>
<td style="text-align: right;">875</td>
<td></td>
<td style="text-align: right;">364</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">169</td>
<td style="text-align: right;">673</td>
<td style="text-align: right;">319</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>June</td>
<td style="text-align: right;">867</td>
<td></td>
<td style="text-align: right;">342</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">610</td>
<td style="text-align: right;">360</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>July</td>
<td style="text-align: right;">829</td>
<td></td>
<td style="text-align: right;">360</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">183</td>
<td style="text-align: right;">594</td>
<td style="text-align: right;">310</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>August</td>
<td style="text-align: right;">939</td>
<td></td>
<td style="text-align: right;">286</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">205</td>
<td style="text-align: right;">649</td>
<td style="text-align: right;">286</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>September</td>
<td style="text-align: right;">835</td>
<td></td>
<td style="text-align: right;">304</td>
<td style="text-align: right;">117</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">560</td>
<td style="text-align: right;">296</td>
</tr>
</tbody>
</table>
</div>
<p>Conversion 1 - Group two column types</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb402"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> construction</span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a>    (tc/pivot-&gt;longer <span class="ss">#"^[125NWS].*|Midwest"</span> {<span class="at">:target-columns</span> [<span class="at">:units</span> <span class="at">:region</span>]</span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">:splitter</span> (<span class="kw">fn</span> [col-name]</span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true" tabindex="-1"></a>                                                           (<span class="kw">if</span> (<span class="kw">re-matches</span> <span class="ss">#"^[125].*"</span> col-name)</span>
<span id="cb402-5"><a href="#cb402-5" aria-hidden="true" tabindex="-1"></a>                                                             [(construction-unit-map col-name) <span class="va">nil</span>]</span>
<span id="cb402-6"><a href="#cb402-6" aria-hidden="true" tabindex="-1"></a>                                                             [<span class="va">nil</span> col-name]))</span>
<span id="cb402-7"><a href="#cb402-7" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">:value-column-name</span> <span class="at">:n</span></span>
<span id="cb402-8"><a href="#cb402-8" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">:drop-missing</span>? <span class="va">false</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/construction.csv [63 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">Year</th>
<th>Month</th>
<th>:units</th>
<th>:region</th>
<th style="text-align: right;">:n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>January</td>
<td>1</td>
<td></td>
<td style="text-align: right;">859</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>February</td>
<td>1</td>
<td></td>
<td style="text-align: right;">882</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>March</td>
<td>1</td>
<td></td>
<td style="text-align: right;">862</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>April</td>
<td>1</td>
<td></td>
<td style="text-align: right;">797</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>May</td>
<td>1</td>
<td></td>
<td style="text-align: right;">875</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>June</td>
<td>1</td>
<td></td>
<td style="text-align: right;">867</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>July</td>
<td>1</td>
<td></td>
<td style="text-align: right;">829</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>August</td>
<td>1</td>
<td></td>
<td style="text-align: right;">939</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>September</td>
<td>1</td>
<td></td>
<td style="text-align: right;">835</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>January</td>
<td>2-4</td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>August</td>
<td></td>
<td>South</td>
<td style="text-align: right;">649</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>September</td>
<td></td>
<td>South</td>
<td style="text-align: right;">560</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>January</td>
<td></td>
<td>West</td>
<td style="text-align: right;">339</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>February</td>
<td></td>
<td>West</td>
<td style="text-align: right;">336</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>March</td>
<td></td>
<td>West</td>
<td style="text-align: right;">330</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>April</td>
<td></td>
<td>West</td>
<td style="text-align: right;">304</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>May</td>
<td></td>
<td>West</td>
<td style="text-align: right;">319</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>June</td>
<td></td>
<td>West</td>
<td style="text-align: right;">360</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>July</td>
<td></td>
<td>West</td>
<td style="text-align: right;">310</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>August</td>
<td></td>
<td>West</td>
<td style="text-align: right;">286</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>September</td>
<td></td>
<td>West</td>
<td style="text-align: right;">296</td>
</tr>
</tbody>
</table>
</div>
<p>Conversion 2 - Convert to longer form and back and rename columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb403"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> construction</span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>    (tc/pivot-&gt;longer <span class="ss">#"^[125NWS].*|Midwest"</span> {<span class="at">:target-columns</span> [<span class="at">:units</span> <span class="at">:region</span>]</span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">:splitter</span> (<span class="kw">fn</span> [col-name]</span>
<span id="cb403-4"><a href="#cb403-4" aria-hidden="true" tabindex="-1"></a>                                                           (<span class="kw">if</span> (<span class="kw">re-matches</span> <span class="ss">#"^[125].*"</span> col-name)</span>
<span id="cb403-5"><a href="#cb403-5" aria-hidden="true" tabindex="-1"></a>                                                             [(construction-unit-map col-name) <span class="va">nil</span>]</span>
<span id="cb403-6"><a href="#cb403-6" aria-hidden="true" tabindex="-1"></a>                                                             [<span class="va">nil</span> col-name]))</span>
<span id="cb403-7"><a href="#cb403-7" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">:value-column-name</span> <span class="at">:n</span></span>
<span id="cb403-8"><a href="#cb403-8" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">:drop-missing</span>? <span class="va">false</span>})</span>
<span id="cb403-9"><a href="#cb403-9" aria-hidden="true" tabindex="-1"></a>    (tc/pivot-&gt;wider [<span class="at">:units</span> <span class="at">:region</span>] <span class="at">:n</span> {<span class="at">:drop-missing</span>? <span class="va">false</span>})</span>
<span id="cb403-10"><a href="#cb403-10" aria-hidden="true" tabindex="-1"></a>    (tc/rename-columns (<span class="kw">zipmap</span> (<span class="kw">vals</span> construction-unit-map)</span>
<span id="cb403-11"><a href="#cb403-11" aria-hidden="true" tabindex="-1"></a>                                (<span class="kw">keys</span> construction-unit-map))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/construction.csv [9 9]:</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 5%">
<col style="width: 16%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Year</th>
<th>Month</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">2 to 4 units</th>
<th style="text-align: right;">5 units or more</th>
<th style="text-align: right;">Northeast</th>
<th style="text-align: right;">Midwest</th>
<th style="text-align: right;">South</th>
<th style="text-align: right;">West</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>January</td>
<td style="text-align: right;">859</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">348</td>
<td style="text-align: right;">114</td>
<td style="text-align: right;">169</td>
<td style="text-align: right;">596</td>
<td style="text-align: right;">339</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>February</td>
<td style="text-align: right;">882</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">655</td>
<td style="text-align: right;">336</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>March</td>
<td style="text-align: right;">862</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">356</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">595</td>
<td style="text-align: right;">330</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>April</td>
<td style="text-align: right;">797</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">447</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">613</td>
<td style="text-align: right;">304</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>May</td>
<td style="text-align: right;">875</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">364</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">169</td>
<td style="text-align: right;">673</td>
<td style="text-align: right;">319</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>June</td>
<td style="text-align: right;">867</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">342</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">610</td>
<td style="text-align: right;">360</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>July</td>
<td style="text-align: right;">829</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">360</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">183</td>
<td style="text-align: right;">594</td>
<td style="text-align: right;">310</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td>August</td>
<td style="text-align: right;">939</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">286</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">205</td>
<td style="text-align: right;">649</td>
<td style="text-align: right;">286</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2018</td>
<td>September</td>
<td style="text-align: right;">835</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">304</td>
<td style="text-align: right;">117</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">560</td>
<td style="text-align: right;">296</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Various operations on stocks, examples taken from <a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a> and <a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a> manuals.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb404"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> stocks-tidyr </span>(tc/dataset <span class="st">"data/stockstidyr.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb405"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>stocks-tidyr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/stockstidyr.csv [10 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>time</th>
<th style="text-align: right;">X</th>
<th style="text-align: right;">Y</th>
<th style="text-align: right;">Z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2009-01-01</td>
<td style="text-align: right;">1.30989806</td>
<td style="text-align: right;">-1.89040193</td>
<td style="text-align: right;">-1.77946880</td>
</tr>
<tr class="even">
<td>2009-01-02</td>
<td style="text-align: right;">-0.29993804</td>
<td style="text-align: right;">-1.82473090</td>
<td style="text-align: right;">2.39892513</td>
</tr>
<tr class="odd">
<td>2009-01-03</td>
<td style="text-align: right;">0.53647501</td>
<td style="text-align: right;">-1.03606860</td>
<td style="text-align: right;">-3.98697977</td>
</tr>
<tr class="even">
<td>2009-01-04</td>
<td style="text-align: right;">-1.88390802</td>
<td style="text-align: right;">-0.52178390</td>
<td style="text-align: right;">-2.83065490</td>
</tr>
<tr class="odd">
<td>2009-01-05</td>
<td style="text-align: right;">-0.96052361</td>
<td style="text-align: right;">-2.21683349</td>
<td style="text-align: right;">1.43715171</td>
</tr>
<tr class="even">
<td>2009-01-06</td>
<td style="text-align: right;">-1.18528966</td>
<td style="text-align: right;">-2.89350924</td>
<td style="text-align: right;">3.39784140</td>
</tr>
<tr class="odd">
<td>2009-01-07</td>
<td style="text-align: right;">-0.85207056</td>
<td style="text-align: right;">-2.16794818</td>
<td style="text-align: right;">-1.20108258</td>
</tr>
<tr class="even">
<td>2009-01-08</td>
<td style="text-align: right;">0.25234172</td>
<td style="text-align: right;">-0.32854117</td>
<td style="text-align: right;">-1.53160473</td>
</tr>
<tr class="odd">
<td>2009-01-09</td>
<td style="text-align: right;">0.40257136</td>
<td style="text-align: right;">1.96407898</td>
<td style="text-align: right;">-6.80878830</td>
</tr>
<tr class="even">
<td>2009-01-10</td>
<td style="text-align: right;">-0.64383500</td>
<td style="text-align: right;">2.68618382</td>
<td style="text-align: right;">-2.55909321</td>
</tr>
</tbody>
</table>
</div>
<p>Convert to longer form</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb406"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> stocks-long </span>(tc/pivot-&gt;longer stocks-tidyr [<span class="st">"X"</span> <span class="st">"Y"</span> <span class="st">"Z"</span>] {<span class="at">:value-column-name</span> <span class="at">:price</span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a>                                                                <span class="at">:target-columns</span> <span class="at">:stocks</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb407"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a>stocks-long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/stockstidyr.csv [30 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>time</th>
<th>:stocks</th>
<th style="text-align: right;">:price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2009-01-01</td>
<td>X</td>
<td style="text-align: right;">1.30989806</td>
</tr>
<tr class="even">
<td>2009-01-02</td>
<td>X</td>
<td style="text-align: right;">-0.29993804</td>
</tr>
<tr class="odd">
<td>2009-01-03</td>
<td>X</td>
<td style="text-align: right;">0.53647501</td>
</tr>
<tr class="even">
<td>2009-01-04</td>
<td>X</td>
<td style="text-align: right;">-1.88390802</td>
</tr>
<tr class="odd">
<td>2009-01-05</td>
<td>X</td>
<td style="text-align: right;">-0.96052361</td>
</tr>
<tr class="even">
<td>2009-01-06</td>
<td>X</td>
<td style="text-align: right;">-1.18528966</td>
</tr>
<tr class="odd">
<td>2009-01-07</td>
<td>X</td>
<td style="text-align: right;">-0.85207056</td>
</tr>
<tr class="even">
<td>2009-01-08</td>
<td>X</td>
<td style="text-align: right;">0.25234172</td>
</tr>
<tr class="odd">
<td>2009-01-09</td>
<td>X</td>
<td style="text-align: right;">0.40257136</td>
</tr>
<tr class="even">
<td>2009-01-10</td>
<td>X</td>
<td style="text-align: right;">-0.64383500</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td>2009-01-10</td>
<td>Y</td>
<td style="text-align: right;">2.68618382</td>
</tr>
<tr class="odd">
<td>2009-01-01</td>
<td>Z</td>
<td style="text-align: right;">-1.77946880</td>
</tr>
<tr class="even">
<td>2009-01-02</td>
<td>Z</td>
<td style="text-align: right;">2.39892513</td>
</tr>
<tr class="odd">
<td>2009-01-03</td>
<td>Z</td>
<td style="text-align: right;">-3.98697977</td>
</tr>
<tr class="even">
<td>2009-01-04</td>
<td>Z</td>
<td style="text-align: right;">-2.83065490</td>
</tr>
<tr class="odd">
<td>2009-01-05</td>
<td>Z</td>
<td style="text-align: right;">1.43715171</td>
</tr>
<tr class="even">
<td>2009-01-06</td>
<td>Z</td>
<td style="text-align: right;">3.39784140</td>
</tr>
<tr class="odd">
<td>2009-01-07</td>
<td>Z</td>
<td style="text-align: right;">-1.20108258</td>
</tr>
<tr class="even">
<td>2009-01-08</td>
<td>Z</td>
<td style="text-align: right;">-1.53160473</td>
</tr>
<tr class="odd">
<td>2009-01-09</td>
<td>Z</td>
<td style="text-align: right;">-6.80878830</td>
</tr>
<tr class="even">
<td>2009-01-10</td>
<td>Z</td>
<td style="text-align: right;">-2.55909321</td>
</tr>
</tbody>
</table>
</div>
<p>Convert back to wide form</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb408"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a>(tc/pivot-&gt;wider stocks-long <span class="at">:stocks</span> <span class="at">:price</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/stockstidyr.csv [10 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>time</th>
<th style="text-align: right;">X</th>
<th style="text-align: right;">Y</th>
<th style="text-align: right;">Z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2009-01-01</td>
<td style="text-align: right;">1.30989806</td>
<td style="text-align: right;">-1.89040193</td>
<td style="text-align: right;">-1.77946880</td>
</tr>
<tr class="even">
<td>2009-01-02</td>
<td style="text-align: right;">-0.29993804</td>
<td style="text-align: right;">-1.82473090</td>
<td style="text-align: right;">2.39892513</td>
</tr>
<tr class="odd">
<td>2009-01-03</td>
<td style="text-align: right;">0.53647501</td>
<td style="text-align: right;">-1.03606860</td>
<td style="text-align: right;">-3.98697977</td>
</tr>
<tr class="even">
<td>2009-01-04</td>
<td style="text-align: right;">-1.88390802</td>
<td style="text-align: right;">-0.52178390</td>
<td style="text-align: right;">-2.83065490</td>
</tr>
<tr class="odd">
<td>2009-01-05</td>
<td style="text-align: right;">-0.96052361</td>
<td style="text-align: right;">-2.21683349</td>
<td style="text-align: right;">1.43715171</td>
</tr>
<tr class="even">
<td>2009-01-06</td>
<td style="text-align: right;">-1.18528966</td>
<td style="text-align: right;">-2.89350924</td>
<td style="text-align: right;">3.39784140</td>
</tr>
<tr class="odd">
<td>2009-01-07</td>
<td style="text-align: right;">-0.85207056</td>
<td style="text-align: right;">-2.16794818</td>
<td style="text-align: right;">-1.20108258</td>
</tr>
<tr class="even">
<td>2009-01-08</td>
<td style="text-align: right;">0.25234172</td>
<td style="text-align: right;">-0.32854117</td>
<td style="text-align: right;">-1.53160473</td>
</tr>
<tr class="odd">
<td>2009-01-09</td>
<td style="text-align: right;">0.40257136</td>
<td style="text-align: right;">1.96407898</td>
<td style="text-align: right;">-6.80878830</td>
</tr>
<tr class="even">
<td>2009-01-10</td>
<td style="text-align: right;">-0.64383500</td>
<td style="text-align: right;">2.68618382</td>
<td style="text-align: right;">-2.55909321</td>
</tr>
</tbody>
</table>
</div>
<p>Convert to wide form on time column (let’s limit values to a couple of rows)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb409"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> stocks-long</span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows (<span class="kw">range</span> <span class="dv">0</span> <span class="dv">30</span> <span class="dv">4</span>))</span>
<span id="cb409-4"><a href="#cb409-4" aria-hidden="true" tabindex="-1"></a>    (tc/pivot-&gt;wider <span class="st">"time"</span> <span class="at">:price</span> {<span class="at">:drop-missing</span>? <span class="va">false</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>data/stockstidyr.csv [3 6]:</p>
<table class="table">
<colgroup>
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th>:stocks</th>
<th style="text-align: right;">2009-01-01</th>
<th style="text-align: right;">2009-01-05</th>
<th style="text-align: right;">2009-01-09</th>
<th style="text-align: right;">2009-01-03</th>
<th style="text-align: right;">2009-01-07</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Y</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">-1.0360686</td>
<td style="text-align: right;">-2.16794818</td>
</tr>
<tr class="even">
<td>X</td>
<td style="text-align: right;">1.30989806</td>
<td style="text-align: right;">-0.96052361</td>
<td style="text-align: right;">0.40257136</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td>Z</td>
<td style="text-align: right;">-1.77946880</td>
<td style="text-align: right;">1.43715171</td>
<td style="text-align: right;">-6.80878830</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="joinconcat-datasets" class="level3">
<h3 class="anchored" data-anchor-id="joinconcat-datasets">Join/Concat Datasets</h3>
<p>Dataset join and concatenation functions.</p>
<p>Joins accept left-side and right-side datasets and columns selector. Options are the same as in <code>tech.ml.dataset</code> functions.</p>
<p>A column selector can be a map with <code>:left</code> and <code>:right</code> keys to specify column names separate for left and right dataset.</p>
<p>The difference between <code>tech.ml.dataset</code> join functions are: arguments order (first datasets) and possibility to join on multiple columns.</p>
<p>Multiple columns joins create temporary index column from column selection. The method for creating index is based on <code>:hashing</code> option and defaults to <code>identity</code>. Prior to <code>7.000-beta-50</code> <code>hash</code> function was used, which caused hash collision for certain cases.</p>
<p>Additionally set operations are defined: <code>intersect</code> and <code>difference</code>.</p>
<p>To concat two datasets rowwise you can choose:</p>
<ul>
<li><code>concat</code> - concats rows for matching columns, the number of columns should be equal.</li>
<li><code>union</code> - like concat but returns unique values</li>
<li><code>bind</code> - concats rows add missing, empty columns</li>
</ul>
<p>To add two datasets columnwise use <code>bind</code>. The number of rows should be equal.</p>
<p>Datasets used in examples:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb410"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> ds1 </span>(tc/dataset {<span class="at">:a</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="va">nil</span> <span class="va">nil</span> <span class="dv">4</span>]</span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:b</span> (<span class="kw">range</span> <span class="dv">101</span> <span class="dv">110</span>)</span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:c</span> (<span class="kw">map</span> <span class="kw">str</span> <span class="st">"abs tract"</span>)}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb411"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> ds2 </span>(tc/dataset {<span class="at">:a</span> [<span class="va">nil</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">4</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">1</span> <span class="va">nil</span>]</span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:b</span> (<span class="kw">range</span> <span class="dv">110</span> <span class="dv">101</span> -<span class="dv">1</span>)</span>
<span id="cb411-3"><a href="#cb411-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:c</span> (<span class="kw">map</span> <span class="kw">str</span> <span class="st">"datatable"</span>)</span>
<span id="cb411-4"><a href="#cb411-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:d</span> (<span class="kw">symbol</span> <span class="st">"X"</span>)</span>
<span id="cb411-5"><a href="#cb411-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:e</span> [<span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="va">nil</span> <span class="dv">8</span> <span class="dv">1</span> <span class="dv">1</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb412"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a>ds1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb413"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a>ds2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<section id="left" class="level4">
<h4 class="anchored" data-anchor-id="left">Left</h4>
<div class="sourceClojure">
<div class="sourceCode" id="cb414"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a>(tc/left-join ds1 ds2 <span class="at">:b</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>left-outer-join [9 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:a</th>
<th>:c</th>
<th style="text-align: right;">:right.b</th>
<th style="text-align: right;">:right.a</th>
<th>:right.c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">109</td>
<td style="text-align: right;">4</td>
<td>t</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">1</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">108</td>
<td style="text-align: right;"></td>
<td>c</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">2</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">107</td>
<td style="text-align: right;"></td>
<td>a</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">5</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td>r</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">105</td>
<td style="text-align: right;">3</td>
<td>t</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">3</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">104</td>
<td style="text-align: right;">2</td>
<td></td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">2</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
<td>s</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">102</td>
<td style="text-align: right;">2</td>
<td>b</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;"></td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">101</td>
<td style="text-align: right;">1</td>
<td>a</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb415"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a>(tc/left-join ds2 ds1 <span class="at">:b</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>left-outer-join [9 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:a</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:right.b</th>
<th style="text-align: right;">:right.a</th>
<th>:right.c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">102</td>
<td style="text-align: right;"></td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">2</td>
<td>b</td>
</tr>
<tr class="even">
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
<td>s</td>
</tr>
<tr class="odd">
<td style="text-align: right;">104</td>
<td style="text-align: right;">2</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">2</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">105</td>
<td style="text-align: right;">3</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">3</td>
<td>t</td>
</tr>
<tr class="odd">
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td>r</td>
</tr>
<tr class="even">
<td style="text-align: right;">107</td>
<td style="text-align: right;">5</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;"></td>
<td>a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">108</td>
<td style="text-align: right;">2</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;"></td>
<td>c</td>
</tr>
<tr class="even">
<td style="text-align: right;">109</td>
<td style="text-align: right;">1</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">4</td>
<td>t</td>
</tr>
<tr class="odd">
<td style="text-align: right;">110</td>
<td style="text-align: right;"></td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb416"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a>(tc/left-join ds1 ds2 [<span class="at">:a</span> <span class="at">:b</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>left-outer-join [9 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb417"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a>(tc/left-join ds2 ds1 [<span class="at">:a</span> <span class="at">:b</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>left-outer-join [9 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb418"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a>(tc/left-join ds1 ds2 {<span class="at">:left</span> <span class="at">:a</span> <span class="at">:right</span> <span class="at">:e</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>left-outer-join [11 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
<th>:d</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb419"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a>(tc/left-join ds2 ds1 {<span class="at">:left</span> <span class="at">:e</span> <span class="at">:right</span> <span class="at">:a</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>left-outer-join [13 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb420"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a>(tc/left-join ds2 ds1 {<span class="at">:left</span> [<span class="at">:b</span> <span class="at">:e</span>] <span class="at">:right</span> [<span class="at">:b</span> <span class="at">:a</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>left-outer-join [9 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="right" class="level4">
<h4 class="anchored" data-anchor-id="right">Right</h4>
<div class="sourceClojure">
<div class="sourceCode" id="cb421"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a>(tc/right-join ds1 ds2 <span class="at">:b</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>right-outer-join [9 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:a</th>
<th>:c</th>
<th style="text-align: right;">:right.b</th>
<th style="text-align: right;">:right.a</th>
<th>:right.c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">109</td>
<td style="text-align: right;">4</td>
<td>t</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">1</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">108</td>
<td style="text-align: right;"></td>
<td>c</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">2</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">107</td>
<td style="text-align: right;"></td>
<td>a</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">5</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td>r</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">105</td>
<td style="text-align: right;">3</td>
<td>t</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">3</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">104</td>
<td style="text-align: right;">2</td>
<td></td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">2</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
<td>s</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">102</td>
<td style="text-align: right;">2</td>
<td>b</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;"></td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">110</td>
<td style="text-align: right;"></td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb422"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a>(tc/right-join ds2 ds1 <span class="at">:b</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>right-outer-join [9 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:a</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:right.b</th>
<th style="text-align: right;">:right.a</th>
<th>:right.c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">102</td>
<td style="text-align: right;"></td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">2</td>
<td>b</td>
</tr>
<tr class="even">
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
<td>s</td>
</tr>
<tr class="odd">
<td style="text-align: right;">104</td>
<td style="text-align: right;">2</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">2</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">105</td>
<td style="text-align: right;">3</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">3</td>
<td>t</td>
</tr>
<tr class="odd">
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td>r</td>
</tr>
<tr class="even">
<td style="text-align: right;">107</td>
<td style="text-align: right;">5</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;"></td>
<td>a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">108</td>
<td style="text-align: right;">2</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;"></td>
<td>c</td>
</tr>
<tr class="even">
<td style="text-align: right;">109</td>
<td style="text-align: right;">1</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">4</td>
<td>t</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">1</td>
<td>a</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb423"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a>(tc/right-join ds1 ds2 [<span class="at">:a</span> <span class="at">:b</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>right-outer-join [9 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb424"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a>(tc/right-join ds2 ds1 [<span class="at">:a</span> <span class="at">:b</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>right-outer-join [9 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb425"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a>(tc/right-join ds1 ds2 {<span class="at">:left</span> <span class="at">:a</span> <span class="at">:right</span> <span class="at">:e</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>right-outer-join [13 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
<th>:d</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb426"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a>(tc/right-join ds2 ds1 {<span class="at">:left</span> <span class="at">:e</span> <span class="at">:right</span> <span class="at">:a</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>right-outer-join [11 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="inner" class="level4">
<h4 class="anchored" data-anchor-id="inner">Inner</h4>
<div class="sourceClojure">
<div class="sourceCode" id="cb427"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a>(tc/inner-join ds1 ds2 <span class="at">:b</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [8 7]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:a</th>
<th>:c</th>
<th style="text-align: right;">:right.a</th>
<th>:right.c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">109</td>
<td style="text-align: right;">4</td>
<td>t</td>
<td style="text-align: right;">1</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">108</td>
<td style="text-align: right;"></td>
<td>c</td>
<td style="text-align: right;">2</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">107</td>
<td style="text-align: right;"></td>
<td>a</td>
<td style="text-align: right;">5</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td>r</td>
<td style="text-align: right;">4</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">105</td>
<td style="text-align: right;">3</td>
<td>t</td>
<td style="text-align: right;">3</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">104</td>
<td style="text-align: right;">2</td>
<td></td>
<td style="text-align: right;">2</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
<td>s</td>
<td style="text-align: right;">1</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">102</td>
<td style="text-align: right;">2</td>
<td>b</td>
<td style="text-align: right;"></td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb428"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a>(tc/inner-join ds2 ds1 <span class="at">:b</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [8 7]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:a</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:right.a</th>
<th>:right.c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">102</td>
<td style="text-align: right;"></td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td>b</td>
</tr>
<tr class="even">
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>s</td>
</tr>
<tr class="odd">
<td style="text-align: right;">104</td>
<td style="text-align: right;">2</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">105</td>
<td style="text-align: right;">3</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td>t</td>
</tr>
<tr class="odd">
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td>r</td>
</tr>
<tr class="even">
<td style="text-align: right;">107</td>
<td style="text-align: right;">5</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;"></td>
<td>a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">108</td>
<td style="text-align: right;">2</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;"></td>
<td>c</td>
</tr>
<tr class="even">
<td style="text-align: right;">109</td>
<td style="text-align: right;">1</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td>t</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb429"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a>(tc/inner-join ds1 ds2 [<span class="at">:a</span> <span class="at">:b</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [4 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb430"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a>(tc/inner-join ds2 ds1 [<span class="at">:a</span> <span class="at">:b</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [4 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb431"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a>(tc/inner-join ds1 ds2 {<span class="at">:left</span> <span class="at">:a</span> <span class="at">:right</span> <span class="at">:e</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [9 7]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
<th>:d</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb432"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a>(tc/inner-join ds2 ds1 {<span class="at">:left</span> <span class="at">:e</span> <span class="at">:right</span> <span class="at">:a</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [9 7]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">105</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">106</td>
<td>r</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">107</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">108</td>
<td>c</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">109</td>
<td>t</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="full" class="level4">
<h4 class="anchored" data-anchor-id="full">Full</h4>
<p>Join keeping all rows</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb433"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a>(tc/full-join ds1 ds2 <span class="at">:b</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>outer-join [10 7]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:a</th>
<th>:c</th>
<th style="text-align: right;">:right.a</th>
<th>:right.c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">109</td>
<td style="text-align: right;">4</td>
<td>t</td>
<td style="text-align: right;">1</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">108</td>
<td style="text-align: right;"></td>
<td>c</td>
<td style="text-align: right;">2</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">107</td>
<td style="text-align: right;"></td>
<td>a</td>
<td style="text-align: right;">5</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td>r</td>
<td style="text-align: right;">4</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">105</td>
<td style="text-align: right;">3</td>
<td>t</td>
<td style="text-align: right;">3</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">104</td>
<td style="text-align: right;">2</td>
<td></td>
<td style="text-align: right;">2</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
<td>s</td>
<td style="text-align: right;">1</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">102</td>
<td style="text-align: right;">2</td>
<td>b</td>
<td style="text-align: right;"></td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">101</td>
<td style="text-align: right;">1</td>
<td>a</td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">110</td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb434"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a>(tc/full-join ds2 ds1 <span class="at">:b</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>outer-join [10 7]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:a</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:right.a</th>
<th>:right.c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">102</td>
<td style="text-align: right;"></td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td>b</td>
</tr>
<tr class="even">
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>s</td>
</tr>
<tr class="odd">
<td style="text-align: right;">104</td>
<td style="text-align: right;">2</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">105</td>
<td style="text-align: right;">3</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td>t</td>
</tr>
<tr class="odd">
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td>r</td>
</tr>
<tr class="even">
<td style="text-align: right;">107</td>
<td style="text-align: right;">5</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;"></td>
<td>a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">108</td>
<td style="text-align: right;">2</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;"></td>
<td>c</td>
</tr>
<tr class="even">
<td style="text-align: right;">109</td>
<td style="text-align: right;">1</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td>t</td>
</tr>
<tr class="odd">
<td style="text-align: right;">110</td>
<td style="text-align: right;"></td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">101</td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
<td>a</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb435"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a>(tc/full-join ds1 ds2 [<span class="at">:a</span> <span class="at">:b</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>outer-join [14 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb436"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a>(tc/full-join ds2 ds1 [<span class="at">:a</span> <span class="at">:b</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>outer-join [14 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb437"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a>(tc/full-join ds1 ds2 {<span class="at">:left</span> <span class="at">:a</span> <span class="at">:right</span> <span class="at">:e</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>outer-join [15 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
<th>:d</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb438"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a>(tc/full-join ds2 ds1 {<span class="at">:left</span> <span class="at">:e</span> <span class="at">:right</span> <span class="at">:a</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>outer-join [15 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="semi" class="level4">
<h4 class="anchored" data-anchor-id="semi">Semi</h4>
<p>Return rows from ds1 matching ds2</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb439"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a>(tc/semi-join ds1 ds2 <span class="at">:b</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [8 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb440"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a>(tc/semi-join ds2 ds1 <span class="at">:b</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [8 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb441"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a>(tc/semi-join ds1 ds2 [<span class="at">:a</span> <span class="at">:b</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb442"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a>(tc/semi-join ds2 ds1 [<span class="at">:a</span> <span class="at">:b</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb443"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a>(tc/semi-join ds1 ds2 {<span class="at">:left</span> <span class="at">:a</span> <span class="at">:right</span> <span class="at">:e</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [7 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb444"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a>(tc/semi-join ds2 ds1 {<span class="at">:left</span> <span class="at">:e</span> <span class="at">:right</span> <span class="at">:a</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="anti" class="level4">
<h4 class="anchored" data-anchor-id="anti">Anti</h4>
<p>Return rows from ds1 not matching ds2</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb445"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a>(tc/anti-join ds1 ds2 <span class="at">:b</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb446"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a>(tc/anti-join ds2 ds1 <span class="at">:b</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb447"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a>(tc/anti-join ds1 ds2 [<span class="at">:a</span> <span class="at">:b</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb448"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a>(tc/anti-join ds1 ds2 {<span class="at">:left</span> <span class="at">:a</span> <span class="at">:right</span> <span class="at">:e</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb449"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a>(tc/anti-join ds2 ds1 {<span class="at">:left</span> <span class="at">:e</span> <span class="at">:right</span> <span class="at">:a</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="hashing" class="level4">
<h4 class="anchored" data-anchor-id="hashing">Hashing</h4>
<p>When <code>:hashing</code> option is used, data from join columns are preprocessed by applying <code>join-columns</code> funtion with <code>:result-type</code> set to the value of <code>:hashing</code>. This helps to create custom joining behaviour. Function used for hashing will get vector of row values from join columns.</p>
<p>In the following example we will join columns on value modulo 5.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb450"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a>(tc/left-join ds1 ds2 <span class="at">:b</span> {<span class="at">:hashing</span> (<span class="kw">fn</span> [[v]] (<span class="kw">mod</span> v <span class="dv">5</span>))})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>left-outer-join [16 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
<th>:right.c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="cross" class="level4">
<h4 class="anchored" data-anchor-id="cross">Cross</h4>
<p>Cross product from selected columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb451"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a>(tc/cross-join ds1 ds2 [<span class="at">:a</span> <span class="at">:b</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>cross-join [81 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:right.a</th>
<th style="text-align: right;">:right.b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb452"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a>(tc/cross-join ds1 ds2 {<span class="at">:left</span> [<span class="at">:a</span> <span class="at">:b</span>] <span class="at">:right</span> <span class="at">:e</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>cross-join [81 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="expand" class="level4">
<h4 class="anchored" data-anchor-id="expand">Expand</h4>
<p>Similar to cross product but works on a single dataset.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb453"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a>(tc/expand ds2 <span class="at">:a</span> <span class="at">:c</span> <span class="at">:d</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>cross-join [36 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th>:c</th>
<th>:d</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td>d</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>a</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>t</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>b</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>l</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>e</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>d</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>t</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>b</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td>t</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>b</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td>l</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>e</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>d</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td>a</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>t</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td>b</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>l</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td>e</td>
<td>X</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Columns can be also bundled (nested) in tuples which are treated as a single entity during cross product.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb454"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a>(tc/expand ds2 [<span class="at">:a</span> <span class="at">:c</span>] [<span class="at">:e</span> <span class="at">:b</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>cross-join [81 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th>:c</th>
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td>d</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">110</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>d</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>d</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">108</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>d</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">107</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>d</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">106</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>d</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">105</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>d</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">104</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>d</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>d</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">102</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>a</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">110</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>l</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>l</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">102</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">110</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">108</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">107</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">106</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">105</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">104</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">102</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="complete" class="level4">
<h4 class="anchored" data-anchor-id="complete">Complete</h4>
<p>Same as expand with all other columns preserved (filled with missing values if necessary).</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb455"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a>(tc/complete ds2 <span class="at">:a</span> <span class="at">:c</span> <span class="at">:d</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>left-outer-join [36 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">104</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb456"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a>(tc/complete ds2 [<span class="at">:a</span> <span class="at">:c</span>] [<span class="at">:e</span> <span class="at">:b</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>left-outer-join [81 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th>:c</th>
<th style="text-align: right;">:e</th>
<th style="text-align: right;">:b</th>
<th>:d</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td>d</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">110</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>a</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>t</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">108</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td>a</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">107</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td>t</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">106</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td>a</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">105</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>b</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">104</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>l</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">102</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>d</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>l</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">105</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>l</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">104</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>l</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">102</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">110</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">108</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">107</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">106</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">105</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">104</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>e</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="asof" class="level4">
<h4 class="anchored" data-anchor-id="asof">asof</h4>
<div class="sourceClojure">
<div class="sourceCode" id="cb457"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> left-ds </span>(tc/dataset {<span class="at">:a</span> [<span class="dv">1</span> <span class="dv">5</span> <span class="dv">10</span>]</span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">:left-val</span> [<span class="st">"a"</span> <span class="st">"b"</span> <span class="st">"c"</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb458"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> right-ds </span>(tc/dataset {<span class="at">:a</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">7</span>]</span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">:right-val</span> [<span class="at">:a</span> <span class="at">:b</span> <span class="at">:c</span> <span class="at">:d</span> <span class="at">:e</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb459"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a>left-ds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th>:left-val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td>b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td>c</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb460"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a>right-ds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th>:right-val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>:a</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>:b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>:c</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td>:d</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td>:e</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb461"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a>(tc/asof-join left-ds right-ds <span class="at">:a</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>asof-&lt;= [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th>:left-val</th>
<th style="text-align: right;">:right.a</th>
<th>:right-val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>a</td>
<td style="text-align: right;">1</td>
<td>:a</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td>b</td>
<td style="text-align: right;">6</td>
<td>:d</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td>c</td>
<td style="text-align: right;"></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb462"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a>(tc/asof-join left-ds right-ds <span class="at">:a</span> {<span class="at">:asof-op</span> <span class="at">:nearest</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>asof-nearest [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th>:left-val</th>
<th style="text-align: right;">:right.a</th>
<th>:right-val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>a</td>
<td style="text-align: right;">1</td>
<td>:a</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td>b</td>
<td style="text-align: right;">6</td>
<td>:d</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td>c</td>
<td style="text-align: right;">7</td>
<td>:e</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb463"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a>(tc/asof-join left-ds right-ds <span class="at">:a</span> {<span class="at">:asof-op</span> :&gt;=})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>asof-&gt;= [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th>:left-val</th>
<th style="text-align: right;">:right.a</th>
<th>:right-val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>a</td>
<td style="text-align: right;">1</td>
<td>:a</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td>b</td>
<td style="text-align: right;">3</td>
<td>:c</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td>c</td>
<td style="text-align: right;">7</td>
<td>:e</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="concat" class="level4">
<h4 class="anchored" data-anchor-id="concat">Concat</h4>
<p><code>contact</code> joins rows from other datasets</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb464"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a>(tc/concat ds1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p><code>concat-copying</code> ensures all readers are evaluated.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb465"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a>(tc/concat-copying ds1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb466"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a>(tc/concat ds1 (tc/drop-columns ds2 <span class="at">:d</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [18 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb467"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb467-2"><a href="#cb467-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">apply</span> tc/concat (<span class="kw">repeatedly</span> <span class="dv">3</span> #(tc/random DS)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [27 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td>…</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<section id="concat-grouped-dataset" class="level5">
<h5 class="anchored" data-anchor-id="concat-grouped-dataset">Concat grouped dataset</h5>
<p>Concatenation of grouped datasets results also in grouped dataset.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb468"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a>(tc/concat (tc/group-by DS [<span class="at">:V3</span>])</span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a>           (tc/group-by DS [<span class="at">:V4</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:name</th>
<th style="text-align: right;">:group-id</th>
<th>:data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>{:V3 0.5}</td>
<td style="text-align: right;">0</td>
<td>Group: {:V3 0.5} [3 4]:</td>
</tr>
<tr class="even">
<td>{:V3 1.0}</td>
<td style="text-align: right;">1</td>
<td>Group: {:V3 1.0} [3 4]:</td>
</tr>
<tr class="odd">
<td>{:V3 1.5}</td>
<td style="text-align: right;">2</td>
<td>Group: {:V3 1.5} [3 4]:</td>
</tr>
<tr class="even">
<td>{:V4 A}</td>
<td style="text-align: right;">3</td>
<td>Group: {:V4 “A”} [3 4]:</td>
</tr>
<tr class="odd">
<td>{:V4 B}</td>
<td style="text-align: right;">4</td>
<td>Group: {:V4 “B”} [3 4]:</td>
</tr>
<tr class="even">
<td>{:V4 C}</td>
<td style="text-align: right;">5</td>
<td>Group: {:V4 “C”} [3 4]:</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="union" class="level4">
<h4 class="anchored" data-anchor-id="union">Union</h4>
<p>The same as <code>concat</code> but returns unique rows</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb469"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">apply</span> tc/union (tc/drop-columns ds2 <span class="at">:d</span>) (<span class="kw">repeat</span> <span class="dv">10</span> ds1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>union [18 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb470"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">apply</span> tc/union (<span class="kw">repeatedly</span> <span class="dv">10</span> #(tc/random DS)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>union [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="bind" class="level4">
<h4 class="anchored" data-anchor-id="bind">Bind</h4>
<p><code>bind</code> adds empty columns during concat</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb471"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a>(tc/bind ds1 ds2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [18 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th style="text-align: right;">:e</th>
<th>:d</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td style="text-align: right;">3</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td style="text-align: right;">4</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td style="text-align: right;">5</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td style="text-align: right;">6</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td style="text-align: right;">7</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td style="text-align: right;"></td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td style="text-align: right;">8</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td style="text-align: right;">1</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td style="text-align: right;">1</td>
<td>X</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb472"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a>(tc/bind ds2 ds1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [18 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
<td></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="append" class="level4">
<h4 class="anchored" data-anchor-id="append">Append</h4>
<p><code>append</code> concats columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb473"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a>(tc/append ds1 ds2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 8]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th>:c</th>
<th>:d</th>
<th style="text-align: right;">:e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td>a</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">110</td>
<td>d</td>
<td>X</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">102</td>
<td>b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>s</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">108</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td></td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">107</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>t</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>t</td>
<td>X</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">106</td>
<td>r</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">105</td>
<td>a</td>
<td>X</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;">107</td>
<td>a</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104</td>
<td>b</td>
<td>X</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: right;">108</td>
<td>c</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">103</td>
<td>l</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">109</td>
<td>t</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">102</td>
<td>e</td>
<td>X</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="intersection" class="level4">
<h4 class="anchored" data-anchor-id="intersection">Intersection</h4>
<div class="sourceClojure">
<div class="sourceCode" id="cb474"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true" tabindex="-1"></a>(tc/intersect (tc/select-columns ds1 <span class="at">:b</span>)</span>
<span id="cb474-2"><a href="#cb474-2" aria-hidden="true" tabindex="-1"></a>              (tc/select-columns ds2 <span class="at">:b</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>intersection [8 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">109</td>
</tr>
<tr class="even">
<td style="text-align: right;">108</td>
</tr>
<tr class="odd">
<td style="text-align: right;">107</td>
</tr>
<tr class="even">
<td style="text-align: right;">106</td>
</tr>
<tr class="odd">
<td style="text-align: right;">105</td>
</tr>
<tr class="even">
<td style="text-align: right;">104</td>
</tr>
<tr class="odd">
<td style="text-align: right;">103</td>
</tr>
<tr class="even">
<td style="text-align: right;">102</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="difference" class="level4">
<h4 class="anchored" data-anchor-id="difference">Difference</h4>
<div class="sourceClojure">
<div class="sourceCode" id="cb475"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a>(tc/difference (tc/select-columns ds1 <span class="at">:b</span>)</span>
<span id="cb475-2"><a href="#cb475-2" aria-hidden="true" tabindex="-1"></a>               (tc/select-columns ds2 <span class="at">:b</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>difference [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">101</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="sourceClojure">
<div class="sourceCode" id="cb476"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a>(tc/difference (tc/select-columns ds2 <span class="at">:b</span>)</span>
<span id="cb476-2"><a href="#cb476-2" aria-hidden="true" tabindex="-1"></a>               (tc/select-columns ds1 <span class="at">:b</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>difference [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">110</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="split-into-traintest" class="level3">
<h3 class="anchored" data-anchor-id="split-into-traintest">Split into train/test</h3>
<p>In ML world very often you need to test given model and prepare collection of train and test datasets. <code>split</code> creates new dataset with two additional columns:</p>
<ul>
<li><code>:$split-name</code> - with <code>:train</code>, <code>:test</code>, <code>:split-2</code>, … values</li>
<li><code>:$split-id</code> - id of splitted group (for k-fold and repeating)</li>
</ul>
<p><code>split-type</code> can be one of the following:</p>
<ul>
<li><code>:kfold</code> (default) - k-fold strategy, <code>:k</code> defines number of folds (defaults to <code>5</code>), produces <code>k</code> splits</li>
<li><code>:bootstrap</code> - <code>:ratio</code> defines ratio of observations put into result (defaults to <code>1.0</code>), produces <code>1</code> split</li>
<li><code>:holdout</code> - split into two or more parts with given ratio(s) (defaults to <code>2/3</code>), produces <code>1</code> split</li>
<li><code>:holdouts</code> - splits into two parts for ascending ratio. Range of rations is given by <code>steps</code> option</li>
<li><code>:loo</code> - leave one out, produces the same number of splits as number of observations</li>
</ul>
<p><code>:holdout</code> can accept also probabilites or ratios and can split to more than 2 subdatasets</p>
<p>Additionally you can provide:</p>
<ul>
<li><code>:seed</code> - for random number generator</li>
<li><code>:shuffle?</code> - turn on/off shuffle of the rows (default: <code>true</code>)</li>
<li><code>:repeats</code> - repeat procedure <code>:repeats</code> times</li>
<li><code>:partition-selector</code> - same as in <code>group-by</code> for stratified splitting to reflect dataset structure in splits.</li>
<li><code>:split-names</code> names of subdatasets different than default, ie. <code>[:train :test :split-2 ...]</code></li>
<li><code>:split-col-name</code> - a column where name of split is stored, either <code>:train</code> or <code>:test</code> values (default: <code>:$split-name</code>)</li>
<li><code>:split-id-col-name</code> - a column where id of the train/test pair is stored (default: <code>:$split-id</code>)</li>
</ul>
<p>In case of grouped dataset each group is processed separately.</p>
<p>See <a href="https://www.mitpressjournals.org/doi/pdf/10.1162/EVCO_a_00069">more</a></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb477"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> for-splitting </span>(tc/dataset (map-indexed (<span class="kw">fn</span> [id v] {<span class="at">:id</span> id</span>
<span id="cb477-3"><a href="#cb477-3" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">:partition</span> v</span>
<span id="cb477-4"><a href="#cb477-4" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">:group</span> (<span class="kw">rand-nth</span> [<span class="at">:g1</span> <span class="at">:g2</span> <span class="at">:g3</span>])})</span>
<span id="cb477-5"><a href="#cb477-5" aria-hidden="true" tabindex="-1"></a>                                            (<span class="kw">concat</span> (<span class="kw">repeat</span> <span class="dv">20</span> <span class="at">:a</span>) (<span class="kw">repeat</span> <span class="dv">5</span> <span class="at">:b</span>)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb478"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb478-2"><a href="#cb478-2" aria-hidden="true" tabindex="-1"></a>for-splitting</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [25 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:id</th>
<th>:partition</th>
<th>:group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>:a</td>
<td>:g3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>:a</td>
<td>:g2</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td>:a</td>
<td>:g3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td>:a</td>
<td>:g3</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td>:a</td>
<td>:g3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td>:a</td>
<td>:g2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td>:a</td>
<td>:g3</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td>:a</td>
<td>:g2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td>:a</td>
<td>:g3</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td>:a</td>
<td>:g2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19</td>
<td>:a</td>
<td>:g2</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td>:b</td>
<td>:g3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21</td>
<td>:b</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">22</td>
<td>:b</td>
<td>:g2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23</td>
<td>:b</td>
<td>:g3</td>
</tr>
<tr class="even">
<td style="text-align: right;">24</td>
<td>:b</td>
<td>:g3</td>
</tr>
</tbody>
</table>
</div>
<section id="k-fold" class="level4">
<h4 class="anchored" data-anchor-id="k-fold">k-Fold</h4>
<p>Returns <code>k=5</code> maps</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb479"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> for-splitting</span>
<span id="cb479-3"><a href="#cb479-3" aria-hidden="true" tabindex="-1"></a>    (tc/split)</span>
<span id="cb479-4"><a href="#cb479-4" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed, (splitted) [30 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:id</th>
<th>:partition</th>
<th>:group</th>
<th>:<span class="math inline">\(split-name | :\)</span>split-id</th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">16</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">24</td>
<td>:b</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21</td>
<td>:b</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">17</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">22</td>
<td>:b</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20</td>
<td>:b</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">19</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td>:a</td>
<td>:g1</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">23</td>
<td>:b</td>
<td>:g3</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18</td>
<td>:a</td>
<td>:g2</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td>:a</td>
<td>:g3</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td>:a</td>
<td>:g2</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23</td>
<td>:b</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<p>Partition according to <code>:k</code> column to reflect it’s distribution</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb480"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb480-2"><a href="#cb480-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> for-splitting</span>
<span id="cb480-3"><a href="#cb480-3" aria-hidden="true" tabindex="-1"></a>    (tc/split <span class="at">:kfold</span> {<span class="at">:partition-selector</span> <span class="at">:partition</span>})</span>
<span id="cb480-4"><a href="#cb480-4" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed, (splitted) [30 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:id</th>
<th>:partition</th>
<th>:group</th>
<th>:<span class="math inline">\(split-name | :\)</span>split-id</th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">12</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">19</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td>:a</td>
<td>:g1</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td>:a</td>
<td>:g1</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td>:a</td>
<td>:g3</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td>:a</td>
<td>:g2</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="bootstrap" class="level4">
<h4 class="anchored" data-anchor-id="bootstrap">Bootstrap</h4>
<div class="sourceClojure">
<div class="sourceCode" id="cb481"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true" tabindex="-1"></a>(tc/split for-splitting <span class="at">:bootstrap</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed, (splitted) [34 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:id</th>
<th>:partition</th>
<th>:group</th>
<th>:<span class="math inline">\(split-name | :\)</span>split-id</th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">7</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">22</td>
<td>:b</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">19</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">22</td>
<td>:b</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>:a</td>
<td>:g2</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>:a</td>
<td>:g3</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>:a</td>
<td>:g3</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td>:a</td>
<td>:g3</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td>:a</td>
<td>:g1</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td>:a</td>
<td>:g1</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td>:a</td>
<td>:g1</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18</td>
<td>:a</td>
<td>:g2</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">21</td>
<td>:b</td>
<td>:g1</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<p>with repeats, to get 100 splits</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb482"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb482-2"><a href="#cb482-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> for-splitting</span>
<span id="cb482-3"><a href="#cb482-3" aria-hidden="true" tabindex="-1"></a>    (tc/split <span class="at">:bootstrap</span> {<span class="at">:repeats</span> <span class="dv">100</span>})</span>
<span id="cb482-4"><a href="#cb482-4" aria-hidden="true" tabindex="-1"></a>    (:$split-id)</span>
<span id="cb482-5"><a href="#cb482-5" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">distinct</span>)</span>
<span id="cb482-6"><a href="#cb482-6" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">count</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb483"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="holdout" class="level4">
<h4 class="anchored" data-anchor-id="holdout">Holdout</h4>
<p>with small ratio</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb484"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb484-2"><a href="#cb484-2" aria-hidden="true" tabindex="-1"></a>(tc/split for-splitting <span class="at">:holdout</span> {<span class="at">:ratio</span> <span class="fl">0.2</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed, (splitted) [25 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:id</th>
<th>:partition</th>
<th>:group</th>
<th>:<span class="math inline">\(split-name | :\)</span>split-id</th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">6</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20</td>
<td>:b</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>:a</td>
<td>:g3</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td>:a</td>
<td>:g1</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td>:a</td>
<td>:g1</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19</td>
<td>:a</td>
<td>:g2</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>:a</td>
<td>:g2</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>:a</td>
<td>:g3</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td>:a</td>
<td>:g1</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td>:a</td>
<td>:g1</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td>:a</td>
<td>:g2</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td>:a</td>
<td>:g3</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td>:a</td>
<td>:g2</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td>:a</td>
<td>:g3</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td>:a</td>
<td>:g1</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">24</td>
<td>:b</td>
<td>:g3</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">22</td>
<td>:b</td>
<td>:g2</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">17</td>
<td>:a</td>
<td>:g3</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<p>you can split to more than two subdatasets with holdout</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb485"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a>(tc/split for-splitting <span class="at">:holdout</span> {<span class="at">:ratio</span> [<span class="fl">0.1</span> <span class="fl">0.2</span> <span class="fl">0.3</span> <span class="fl">0.15</span> <span class="fl">0.25</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed, (splitted) [25 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:id</th>
<th>:partition</th>
<th>:group</th>
<th>:<span class="math inline">\(split-name | :\)</span>split-id</th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">23</td>
<td>:b</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td>:a</td>
<td>:g2</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>:a</td>
<td>:g3</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td>:a</td>
<td>:g1</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td>:b</td>
<td>:g3</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td>:a</td>
<td>:g1</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">21</td>
<td>:b</td>
<td>:g1</td>
<td>:split-2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td>:a</td>
<td>:g3</td>
<td>:split-2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td>:a</td>
<td>:g1</td>
<td>:split-2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>:a</td>
<td>:g3</td>
<td>:split-3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td>:a</td>
<td>:g3</td>
<td>:split-3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td>:a</td>
<td>:g2</td>
<td>:split-3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>:a</td>
<td>:g2</td>
<td>:split-4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td>:a</td>
<td>:g3</td>
<td>:split-4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td>:a</td>
<td>:g2</td>
<td>:split-4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td>:a</td>
<td>:g3</td>
<td>:split-4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td>:a</td>
<td>:g1</td>
<td>:split-4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">17</td>
<td>:a</td>
<td>:g3</td>
<td>:split-4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td>:a</td>
<td>:g1</td>
<td>:split-4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td>:a</td>
<td>:g2</td>
<td>:split-4</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<p>you can use also proportions with custom names</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb486"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb486-1"><a href="#cb486-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb486-2"><a href="#cb486-2" aria-hidden="true" tabindex="-1"></a>(tc/split for-splitting <span class="at">:holdout</span> {<span class="at">:ratio</span> [<span class="dv">5</span> <span class="dv">3</span> <span class="dv">11</span> <span class="dv">2</span>]</span>
<span id="cb486-3"><a href="#cb486-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">:split-names</span> [<span class="st">"small"</span> <span class="st">"smaller"</span> <span class="st">"big"</span> <span class="st">"the rest"</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed, (splitted) [25 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:id</th>
<th>:partition</th>
<th>:group</th>
<th>:<span class="math inline">\(split-name | :\)</span>split-id</th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td>:a</td>
<td>:g3</td>
<td>small</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td>:a</td>
<td>:g1</td>
<td>small</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td>:a</td>
<td>:g1</td>
<td>small</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td>:a</td>
<td>:g3</td>
<td>small</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21</td>
<td>:b</td>
<td>:g1</td>
<td>small</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td>:a</td>
<td>:g2</td>
<td>smaller</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td>:a</td>
<td>:g1</td>
<td>smaller</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">23</td>
<td>:b</td>
<td>:g3</td>
<td>smaller</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td>:a</td>
<td>:g3</td>
<td>big</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td>:a</td>
<td>:g2</td>
<td>big</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td>:a</td>
<td>:g3</td>
<td>big</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>:a</td>
<td>:g3</td>
<td>big</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>:a</td>
<td>:g2</td>
<td>big</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18</td>
<td>:a</td>
<td>:g2</td>
<td>big</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td>:a</td>
<td>:g2</td>
<td>big</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">24</td>
<td>:b</td>
<td>:g3</td>
<td>big</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td>:a</td>
<td>:g1</td>
<td>big</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19</td>
<td>:a</td>
<td>:g2</td>
<td>the rest</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">17</td>
<td>:a</td>
<td>:g3</td>
<td>the rest</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td>:a</td>
<td>:g1</td>
<td>the rest</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">22</td>
<td>:b</td>
<td>:g2</td>
<td>the rest</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="holdouts" class="level4">
<h4 class="anchored" data-anchor-id="holdouts">Holdouts</h4>
<p>With ratios from 5% to 95% of the dataset with step 1.5 generates 15 splits with ascending rows in train dataset.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb487"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb487-2"><a href="#cb487-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tc/split for-splitting <span class="at">:holdouts</span> {<span class="at">:steps</span> [<span class="fl">0.05</span> <span class="fl">0.95</span> <span class="fl">1.5</span>]</span>
<span id="cb487-3"><a href="#cb487-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">:shuffle</span>? <span class="va">false</span>})</span>
<span id="cb487-4"><a href="#cb487-4" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [:$split-id :$split-name]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [30 3]:</p>
<table class="table">
<colgroup>
<col style="width: 37%">
<col style="width: 10%">
<col style="width: 51%">
</colgroup>
<thead>
<tr class="header">
<th>:name</th>
<th style="text-align: right;">:group-id</th>
<th>:data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>{:<span class="math inline">\(split-id 0, :\)</span>split-name :train}</td>
<td style="text-align: right;">0</td>
<td>Group: {:<span class="math inline">\(split-id 0, :\)</span>split-name :train} [1 5]:</td>
</tr>
<tr class="even">
<td>{:<span class="math inline">\(split-id 0, :\)</span>split-name :test}</td>
<td style="text-align: right;">1</td>
<td>Group: {:<span class="math inline">\(split-id 0, :\)</span>split-name :test} [24 5]:</td>
</tr>
<tr class="odd">
<td>{:<span class="math inline">\(split-id 1, :\)</span>split-name :train}</td>
<td style="text-align: right;">2</td>
<td>Group: {:<span class="math inline">\(split-id 1, :\)</span>split-name :train} [2 5]:</td>
</tr>
<tr class="even">
<td>{:<span class="math inline">\(split-id 1, :\)</span>split-name :test}</td>
<td style="text-align: right;">3</td>
<td>Group: {:<span class="math inline">\(split-id 1, :\)</span>split-name :test} [23 5]:</td>
</tr>
<tr class="odd">
<td>{:<span class="math inline">\(split-id 2, :\)</span>split-name :train}</td>
<td style="text-align: right;">4</td>
<td>Group: {:<span class="math inline">\(split-id 2, :\)</span>split-name :train} [4 5]:</td>
</tr>
<tr class="even">
<td>{:<span class="math inline">\(split-id 2, :\)</span>split-name :test}</td>
<td style="text-align: right;">5</td>
<td>Group: {:<span class="math inline">\(split-id 2, :\)</span>split-name :test} [21 5]:</td>
</tr>
<tr class="odd">
<td>{:<span class="math inline">\(split-id 3, :\)</span>split-name :train}</td>
<td style="text-align: right;">6</td>
<td>Group: {:<span class="math inline">\(split-id 3, :\)</span>split-name :train} [5 5]:</td>
</tr>
<tr class="even">
<td>{:<span class="math inline">\(split-id 3, :\)</span>split-name :test}</td>
<td style="text-align: right;">7</td>
<td>Group: {:<span class="math inline">\(split-id 3, :\)</span>split-name :test} [20 5]:</td>
</tr>
<tr class="odd">
<td>{:<span class="math inline">\(split-id 4, :\)</span>split-name :train}</td>
<td style="text-align: right;">8</td>
<td>Group: {:<span class="math inline">\(split-id 4, :\)</span>split-name :train} [7 5]:</td>
</tr>
<tr class="even">
<td>{:<span class="math inline">\(split-id 4, :\)</span>split-name :test}</td>
<td style="text-align: right;">9</td>
<td>Group: {:<span class="math inline">\(split-id 4, :\)</span>split-name :test} [18 5]:</td>
</tr>
<tr class="odd">
<td>…</td>
<td style="text-align: right;">…</td>
<td>…</td>
</tr>
<tr class="even">
<td>{:<span class="math inline">\(split-id 9, :\)</span>split-name :test}</td>
<td style="text-align: right;">19</td>
<td>Group: {:<span class="math inline">\(split-id 9, :\)</span>split-name :test} [11 5]:</td>
</tr>
<tr class="odd">
<td>{:<span class="math inline">\(split-id 10, :\)</span>split-name :train}</td>
<td style="text-align: right;">20</td>
<td>Group: {:<span class="math inline">\(split-id 10, :\)</span>split-name :train} [16 5]:</td>
</tr>
<tr class="even">
<td>{:<span class="math inline">\(split-id 10, :\)</span>split-name :test}</td>
<td style="text-align: right;">21</td>
<td>Group: {:<span class="math inline">\(split-id 10, :\)</span>split-name :test} [9 5]:</td>
</tr>
<tr class="odd">
<td>{:<span class="math inline">\(split-id 11, :\)</span>split-name :train}</td>
<td style="text-align: right;">22</td>
<td>Group: {:<span class="math inline">\(split-id 11, :\)</span>split-name :train} [17 5]:</td>
</tr>
<tr class="even">
<td>{:<span class="math inline">\(split-id 11, :\)</span>split-name :test}</td>
<td style="text-align: right;">23</td>
<td>Group: {:<span class="math inline">\(split-id 11, :\)</span>split-name :test} [8 5]:</td>
</tr>
<tr class="odd">
<td>{:<span class="math inline">\(split-id 12, :\)</span>split-name :train}</td>
<td style="text-align: right;">24</td>
<td>Group: {:<span class="math inline">\(split-id 12, :\)</span>split-name :train} [19 5]:</td>
</tr>
<tr class="even">
<td>{:<span class="math inline">\(split-id 12, :\)</span>split-name :test}</td>
<td style="text-align: right;">25</td>
<td>Group: {:<span class="math inline">\(split-id 12, :\)</span>split-name :test} [6 5]:</td>
</tr>
<tr class="odd">
<td>{:<span class="math inline">\(split-id 13, :\)</span>split-name :train}</td>
<td style="text-align: right;">26</td>
<td>Group: {:<span class="math inline">\(split-id 13, :\)</span>split-name :train} [20 5]:</td>
</tr>
<tr class="even">
<td>{:<span class="math inline">\(split-id 13, :\)</span>split-name :test}</td>
<td style="text-align: right;">27</td>
<td>Group: {:<span class="math inline">\(split-id 13, :\)</span>split-name :test} [5 5]:</td>
</tr>
<tr class="odd">
<td>{:<span class="math inline">\(split-id 14, :\)</span>split-name :train}</td>
<td style="text-align: right;">28</td>
<td>Group: {:<span class="math inline">\(split-id 14, :\)</span>split-name :train} [22 5]:</td>
</tr>
<tr class="even">
<td>{:<span class="math inline">\(split-id 14, :\)</span>split-name :test}</td>
<td style="text-align: right;">29</td>
<td>Group: {:<span class="math inline">\(split-id 14, :\)</span>split-name :test} [3 5]:</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="leave-one-out" class="level4">
<h4 class="anchored" data-anchor-id="leave-one-out">Leave One Out</h4>
<div class="sourceClojure">
<div class="sourceCode" id="cb488"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb488-2"><a href="#cb488-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> for-splitting</span>
<span id="cb488-3"><a href="#cb488-3" aria-hidden="true" tabindex="-1"></a>    (tc/split <span class="at">:loo</span>)</span>
<span id="cb488-4"><a href="#cb488-4" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed, (splitted) [30 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:id</th>
<th>:partition</th>
<th>:group</th>
<th>:<span class="math inline">\(split-name | :\)</span>split-id</th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">18</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">22</td>
<td>:b</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td>:b</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23</td>
<td>:b</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">17</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">24</td>
<td>:b</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">19</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td>:a</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21</td>
<td>:b</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>:a</td>
<td>:g3</td>
<td>:test</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td>:a</td>
<td>:g3</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td>:a</td>
<td>:g1</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">22</td>
<td>:b</td>
<td>:g2</td>
<td>:train</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb489"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb489-2"><a href="#cb489-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> for-splitting</span>
<span id="cb489-3"><a href="#cb489-3" aria-hidden="true" tabindex="-1"></a>    (tc/split <span class="at">:loo</span>)</span>
<span id="cb489-4"><a href="#cb489-4" aria-hidden="true" tabindex="-1"></a>    (tc/row-count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb490"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="dv">625</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="grouped-dataset-with-partitioning" class="level4">
<h4 class="anchored" data-anchor-id="grouped-dataset-with-partitioning">Grouped dataset with partitioning</h4>
<div class="sourceClojure">
<div class="sourceCode" id="cb491"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb491-2"><a href="#cb491-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> for-splitting</span>
<span id="cb491-3"><a href="#cb491-3" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:group</span>)</span>
<span id="cb491-4"><a href="#cb491-4" aria-hidden="true" tabindex="-1"></a>    (tc/split <span class="at">:bootstrap</span> {<span class="at">:partition-selector</span> <span class="at">:partition</span> <span class="at">:seed</span> <span class="dv">11</span> <span class="at">:ratio</span> <span class="fl">0.8</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:name</th>
<th style="text-align: right;">:group-id</th>
<th>:data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>:g1</td>
<td style="text-align: right;">0</td>
<td>Group: :g1, (splitted) [9 5]:</td>
</tr>
<tr class="even">
<td>:g3</td>
<td style="text-align: right;">1</td>
<td>Group: :g3, (splitted) [12 5]:</td>
</tr>
<tr class="odd">
<td>:g2</td>
<td style="text-align: right;">2</td>
<td>Group: :g2, (splitted) [8 5]:</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="split-as-a-sequence" class="level4">
<h4 class="anchored" data-anchor-id="split-as-a-sequence">Split as a sequence</h4>
<p>To get a sequence of pairs, use <code>split-&gt;seq</code> function</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb492"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb492-2"><a href="#cb492-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> for-splitting</span>
<span id="cb492-3"><a href="#cb492-3" aria-hidden="true" tabindex="-1"></a>    (tc/split-&gt;seq <span class="at">:kfold</span> {<span class="at">:partition-selector</span> <span class="at">:partition</span>})</span>
<span id="cb492-4"><a href="#cb492-4" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">first</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>{</p><div style="margin-left:10%;width:110%;">
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>:train</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: 0 [20 3]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:id</th>
<th data-quarto-table-cell-role="th">:partition</th>
<th data-quarto-table-cell-role="th">:group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">19</td>
<td>:a</td>
<td>:g2</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td>:a</td>
<td>:g2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td>:a</td>
<td>:g3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td>:a</td>
<td>:g2</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>:a</td>
<td>:g3</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td>:a</td>
<td>:g3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td>:a</td>
<td>:g3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td>:a</td>
<td>:g3</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>:a</td>
<td>:g3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td>:a</td>
<td>:g2</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td>:a</td>
<td>:g2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23</td>
<td>:b</td>
<td>:g3</td>
</tr>
<tr class="even">
<td style="text-align: right;">24</td>
<td>:b</td>
<td>:g3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">22</td>
<td>:b</td>
<td>:g2</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td>:b</td>
<td>:g3</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>:test</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: 0 [5 3]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:id</th>
<th data-quarto-table-cell-role="th">:partition</th>
<th data-quarto-table-cell-role="th">:group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>:a</td>
<td>:g3</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>:a</td>
<td>:g2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21</td>
<td>:b</td>
<td>:g1</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
</div><p>}</p></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb495"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb495-2"><a href="#cb495-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> for-splitting</span>
<span id="cb495-3"><a href="#cb495-3" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:group</span>)</span>
<span id="cb495-4"><a href="#cb495-4" aria-hidden="true" tabindex="-1"></a>    (tc/split-&gt;seq <span class="at">:bootstrap</span> {<span class="at">:partition-selector</span> <span class="at">:partition</span> <span class="at">:seed</span> <span class="dv">11</span> <span class="at">:ratio</span> <span class="fl">0.8</span> <span class="at">:repeats</span> <span class="dv">2</span>})</span>
<span id="cb495-5"><a href="#cb495-5" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">first</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>[</p><div style="margin-left:10%;width:110%;"><div><pre><code class="sourceCode language-clojure printed-clojure">:g1
</code></pre></div><div><p>(</p><div style="margin-left:10%;width:110%;"><div><p>{</p><div style="margin-left:10%;width:110%;">
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>:train</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: 0 [7 3]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:id</th>
<th data-quarto-table-cell-role="th">:partition</th>
<th data-quarto-table-cell-role="th">:group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">15</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21</td>
<td>:b</td>
<td>:g1</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>:test</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: 0 [2 3]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:id</th>
<th data-quarto-table-cell-role="th">:partition</th>
<th data-quarto-table-cell-role="th">:group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">6</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td>:a</td>
<td>:g1</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
</div><p>}</p></div><div><p>{</p><div style="margin-left:10%;width:110%;">
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>:train</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: 1 [7 3]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:id</th>
<th data-quarto-table-cell-role="th">:partition</th>
<th data-quarto-table-cell-role="th">:group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21</td>
<td>:b</td>
<td>:g1</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>:test</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: 1 [2 3]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">:id</th>
<th data-quarto-table-cell-role="th">:partition</th>
<th data-quarto-table-cell-role="th">:group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">6</td>
<td>:a</td>
<td>:g1</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td>:a</td>
<td>:g1</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
</div><p>}</p></div></div><p>)</p></div></div><p>]</p></div>
</div>
</section>
</section>
</section>
<section id="column-api" class="level2">
<h2 class="anchored" data-anchor-id="column-api">Column API</h2>
<p>A <code>column</code> in tablecloth is a named sequence of typed data. It is the building block of the <code>dataset</code> since datasets are at base just a map of columns. Like <code>dataset</code>, the <code>column</code> is defined within <code>tech.ml.dataset</code>. In this section, we will show how you can interact with the column by itself.</p>
<p>Let’s begin by requiring the Column API, which we suggest you alias as <code>tcc</code>:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb500"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">require</span> '[tablecloth.column.api <span class="at">:as</span> tcc])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="creation-identity" class="level3">
<h3 class="anchored" data-anchor-id="creation-identity">Creation &amp; Identity</h3>
<p>Creating an empty column is pretty straightforward:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb501"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true" tabindex="-1"></a>(tcc/column)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb502"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb502-1"><a href="#cb502-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;boolean&amp;gt;[0]</span></span>
<span id="cb502-2"><a href="#cb502-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb502-3"><a href="#cb502-3" aria-hidden="true" tabindex="-1"></a>[]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also create a Column from a vector or a sequence</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb503"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true" tabindex="-1"></a>(tcc/column [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb504"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[5]</span></span>
<span id="cb504-2"><a href="#cb504-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb504-3"><a href="#cb504-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb505"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb505-1"><a href="#cb505-1" aria-hidden="true" tabindex="-1"></a>(tcc/column `(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb506"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[5]</span></span>
<span id="cb506-2"><a href="#cb506-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb506-3"><a href="#cb506-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also quickly create columns of ones or zeros:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb507"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb507-1"><a href="#cb507-1" aria-hidden="true" tabindex="-1"></a>(tcc/ones <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb508"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[10]</span></span>
<span id="cb508-2"><a href="#cb508-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb508-3"><a href="#cb508-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb509"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb509-1"><a href="#cb509-1" aria-hidden="true" tabindex="-1"></a>(tcc/zeros <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb510"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[10]</span></span>
<span id="cb510-2"><a href="#cb510-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb510-3"><a href="#cb510-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, to identify a column, you can use the <code>column?</code> function to check if an item is a column:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb511"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb511-1"><a href="#cb511-1" aria-hidden="true" tabindex="-1"></a>(tcc/column? [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb512"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="va">false</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb513"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb513-1"><a href="#cb513-1" aria-hidden="true" tabindex="-1"></a>(tcc/column? (tcc/column))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb514"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="va">true</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tablecloth’s datasets of course consists of columns:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb515"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true" tabindex="-1"></a>(tcc/column? (<span class="kw">-&gt;</span> (tc/dataset {<span class="at">:a</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span>]})</span>
<span id="cb515-2"><a href="#cb515-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:a</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb516"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="va">true</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="datatypes" class="level3">
<h3 class="anchored" data-anchor-id="datatypes">Datatypes</h3>
<p>The default set of types for a column are defined in the underlying “tech ml” system. We can see the set here:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb517"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true" tabindex="-1"></a>(tech.v3.datatype.casting/all-datatypes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb518"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:int32</span></span>
<span id="cb518-2"><a href="#cb518-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:int16</span></span>
<span id="cb518-3"><a href="#cb518-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:float32</span></span>
<span id="cb518-4"><a href="#cb518-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:float64</span></span>
<span id="cb518-5"><a href="#cb518-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:int64</span></span>
<span id="cb518-6"><a href="#cb518-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:uint64</span></span>
<span id="cb518-7"><a href="#cb518-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:string</span></span>
<span id="cb518-8"><a href="#cb518-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:uint16</span></span>
<span id="cb518-9"><a href="#cb518-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:int8</span></span>
<span id="cb518-10"><a href="#cb518-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:uint32</span></span>
<span id="cb518-11"><a href="#cb518-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:keyword</span></span>
<span id="cb518-12"><a href="#cb518-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:decimal</span></span>
<span id="cb518-13"><a href="#cb518-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:uuid</span></span>
<span id="cb518-14"><a href="#cb518-14" aria-hidden="true" tabindex="-1"></a> <span class="at">:boolean</span></span>
<span id="cb518-15"><a href="#cb518-15" aria-hidden="true" tabindex="-1"></a> <span class="at">:object</span></span>
<span id="cb518-16"><a href="#cb518-16" aria-hidden="true" tabindex="-1"></a> <span class="at">:char</span></span>
<span id="cb518-17"><a href="#cb518-17" aria-hidden="true" tabindex="-1"></a> <span class="at">:uint8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When you create a column, the underlying system will try to autodetect its type. We can illustrate that behavior using the <code>tcc/typeof</code> function to check the type of a column:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb519"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span>])</span>
<span id="cb519-2"><a href="#cb519-2" aria-hidden="true" tabindex="-1"></a>    (tcc/typeof))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb520"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="at">:int64</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb521"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column [<span class="at">:a</span> <span class="at">:b</span> <span class="at">:c</span> <span class="at">:d</span> <span class="at">:e</span>])</span>
<span id="cb521-2"><a href="#cb521-2" aria-hidden="true" tabindex="-1"></a>    (tcc/typeof))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb522"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="at">:keyword</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Columns containing heterogenous data will receive type <code>:object</code>:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb523"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column [<span class="dv">1</span> <span class="at">:b</span> <span class="dv">3</span> <span class="at">:c</span> <span class="dv">5</span>])</span>
<span id="cb523-2"><a href="#cb523-2" aria-hidden="true" tabindex="-1"></a>    (tcc/typeof))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb524"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="at">:object</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also use the <code>tcc/typeof?</code> function to check the value of a function as an asssertion:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb525"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb525-1"><a href="#cb525-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">6</span>])</span>
<span id="cb525-2"><a href="#cb525-2" aria-hidden="true" tabindex="-1"></a>    (tcc/typeof? <span class="at">:boolean</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb526"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="va">false</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb527"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb527-1"><a href="#cb527-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">6</span>])</span>
<span id="cb527-2"><a href="#cb527-2" aria-hidden="true" tabindex="-1"></a>    (tcc/typeof? <span class="at">:int64</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb528"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="va">true</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tablecloth has a concept of “concrete” and “general” types. A general type is the broad category of type and the concrete type is the actual type in memory. For example, a concrete type is a 64-bit integer <code>:int64</code>, which is also of the general type <code>:integer</code>.</p>
<p>The <code>typeof?</code> function supports checking both.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb529"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb529-1"><a href="#cb529-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">6</span>])</span>
<span id="cb529-2"><a href="#cb529-2" aria-hidden="true" tabindex="-1"></a>    (tcc/typeof? <span class="at">:int64</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb530"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="va">true</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb531"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb531-1"><a href="#cb531-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">6</span>])</span>
<span id="cb531-2"><a href="#cb531-2" aria-hidden="true" tabindex="-1"></a>    (tcc/typeof? <span class="at">:integer</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb532"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="va">true</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="access-manipulation" class="level3">
<h3 class="anchored" data-anchor-id="access-manipulation">Access &amp; Manipulation</h3>
<section id="column-access" class="level4">
<h4 class="anchored" data-anchor-id="column-access">Column Access</h4>
<p>The method for accessing a particular index position in a column is the same as for Clojure vectors:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb533"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb533-1"><a href="#cb533-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span>])</span>
<span id="cb533-2"><a href="#cb533-2" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">get</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb534"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb535"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb535-1"><a href="#cb535-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span>])</span>
<span id="cb535-2"><a href="#cb535-2" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">nth</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb536"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="slice" class="level4">
<h4 class="anchored" data-anchor-id="slice">Slice</h4>
<p>You can also slice a column</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb537"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb537-1"><a href="#cb537-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column (<span class="kw">range</span> <span class="dv">10</span>))</span>
<span id="cb537-2"><a href="#cb537-2" aria-hidden="true" tabindex="-1"></a>    (tcc/slice <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb538"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[5]</span></span>
<span id="cb538-2"><a href="#cb538-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb538-3"><a href="#cb538-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb539"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column (<span class="kw">range</span> <span class="dv">10</span>))</span>
<span id="cb539-2"><a href="#cb539-2" aria-hidden="true" tabindex="-1"></a>    (tcc/slice <span class="dv">1</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb540"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[4]</span></span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb540-3"><a href="#cb540-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb541"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb541-1"><a href="#cb541-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column (<span class="kw">range</span> <span class="dv">10</span>))</span>
<span id="cb541-2"><a href="#cb541-2" aria-hidden="true" tabindex="-1"></a>    (tcc/slice <span class="dv">0</span> <span class="dv">9</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb542"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[5]</span></span>
<span id="cb542-2"><a href="#cb542-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb542-3"><a href="#cb542-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>slice</code> method supports the <code>:end</code> and <code>:start</code> keywords, which can add clarity to your code:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb543"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb543-1"><a href="#cb543-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column (<span class="kw">range</span> <span class="dv">10</span>))</span>
<span id="cb543-2"><a href="#cb543-2" aria-hidden="true" tabindex="-1"></a>    (tcc/slice <span class="at">:start</span> <span class="at">:end</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb544"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[5]</span></span>
<span id="cb544-2"><a href="#cb544-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb544-3"><a href="#cb544-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="select-3" class="level4">
<h4 class="anchored" data-anchor-id="select-3">Select</h4>
<p>If you need to create a discontinuous subset of the column, you can use the <code>select</code> function. This method accepts an array of index positions or an array of booleans. When using boolean select, a true value will select the value at the index positions containing true values:</p>
<p>Select the values at index positions 1 and 9:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb545"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb545-1"><a href="#cb545-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column (<span class="kw">range</span> <span class="dv">10</span>))</span>
<span id="cb545-2"><a href="#cb545-2" aria-hidden="true" tabindex="-1"></a>    (tcc/select [<span class="dv">1</span> <span class="dv">9</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb546"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[2]</span></span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb546-3"><a href="#cb546-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">9</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Select the values at index positions 0 and 2 using booelan select:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb547"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb547-1"><a href="#cb547-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column (<span class="kw">range</span> <span class="dv">10</span>))</span>
<span id="cb547-2"><a href="#cb547-2" aria-hidden="true" tabindex="-1"></a>    (tcc/select (tcc/column [<span class="va">true</span> <span class="va">false</span> <span class="va">true</span>])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb548"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[2]</span></span>
<span id="cb548-2"><a href="#cb548-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb548-3"><a href="#cb548-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">0</span>, <span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The boolean select feature is particularly useful when used with the large number of operations (see <a href="#operations">below</a>) that the Column API includes:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb549"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb549-1"><a href="#cb549-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">let</span> [col (tcc/column (<span class="kw">range</span> <span class="dv">10</span>))]</span>
<span id="cb549-2"><a href="#cb549-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">-&gt;</span> col</span>
<span id="cb549-3"><a href="#cb549-3" aria-hidden="true" tabindex="-1"></a>      (tcc/odd?)</span>
<span id="cb549-4"><a href="#cb549-4" aria-hidden="true" tabindex="-1"></a>      (<span class="kw">-&gt;&gt;</span> (tcc/select col))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb550"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb550-1"><a href="#cb550-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[5]</span></span>
<span id="cb550-2"><a href="#cb550-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb550-3"><a href="#cb550-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, we used the <code>odd?</code> operator to create a boolean array indicating all index positions in the Column that included an odd value. Then we pass that boolean Column to the <code>select</code> function using the <code>-&gt;&gt;</code> to send it to the second argument position.</p>
</section>
<section id="sort" class="level4">
<h4 class="anchored" data-anchor-id="sort">Sort</h4>
<p>Use <code>sort-column</code> to sort a column:</p>
<p>Default sort is in ascending order:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb551"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb551-1"><a href="#cb551-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column [<span class="at">:c</span> <span class="at">:z</span> <span class="at">:a</span> <span class="at">:f</span>])</span>
<span id="cb551-2"><a href="#cb551-2" aria-hidden="true" tabindex="-1"></a>    (tcc/sort-column))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb552"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb552-1"><a href="#cb552-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;keyword&amp;gt;[4]</span></span>
<span id="cb552-2"><a href="#cb552-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb552-3"><a href="#cb552-3" aria-hidden="true" tabindex="-1"></a>[<span class="at">:a</span>, <span class="at">:c</span>, <span class="at">:f</span>, <span class="at">:z</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can provide the <code>:desc</code> and <code>:asc</code> keywords to change the default behavior:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb553"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb553-1"><a href="#cb553-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column [<span class="at">:c</span> <span class="at">:z</span> <span class="at">:a</span> <span class="at">:f</span>])</span>
<span id="cb553-2"><a href="#cb553-2" aria-hidden="true" tabindex="-1"></a>    (tcc/sort-column <span class="at">:desc</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb554"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb554-1"><a href="#cb554-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;keyword&amp;gt;[4]</span></span>
<span id="cb554-2"><a href="#cb554-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb554-3"><a href="#cb554-3" aria-hidden="true" tabindex="-1"></a>[<span class="at">:z</span>, <span class="at">:f</span>, <span class="at">:c</span>, <span class="at">:a</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also provide a comparator fn:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb555"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb555-1"><a href="#cb555-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tcc/column [{<span class="at">:position</span> <span class="dv">2</span></span>
<span id="cb555-2"><a href="#cb555-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:text</span> <span class="st">"and then stopped"</span>}</span>
<span id="cb555-3"><a href="#cb555-3" aria-hidden="true" tabindex="-1"></a>                 {<span class="at">:position</span> <span class="dv">1</span></span>
<span id="cb555-4"><a href="#cb555-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:text</span> <span class="st">"I ran fast"</span>}])</span>
<span id="cb555-5"><a href="#cb555-5" aria-hidden="true" tabindex="-1"></a>    (tcc/sort-column (<span class="kw">fn</span> [a b] (<span class="kw">&lt;</span> (<span class="at">:position</span> a) (<span class="at">:position</span> b)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb556"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb556-1"><a href="#cb556-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;persistent-map&amp;gt;[2]</span></span>
<span id="cb556-2"><a href="#cb556-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb556-3"><a href="#cb556-3" aria-hidden="true" tabindex="-1"></a>[{<span class="at">:position</span> <span class="dv">1</span>, <span class="at">:text</span> <span class="st">"I ran fast"</span>}, {<span class="at">:position</span> <span class="dv">2</span>, <span class="at">:text</span> <span class="st">"and then stopped"</span>}]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="operations" class="level3">
<h3 class="anchored" data-anchor-id="operations">Operations</h3>
<p>The Column API contains a large number of operations, which have been lifted from the underlying <code>tech.ml.dataset</code> library and adapted to Tablecloth. These operations all take one or more columns as an argument, and they return either a scalar value or a new column, depending on the operation. In other words, their signature is this general form:</p>
<pre><code>(column1 column2 ...) =&gt; column | scalar</code></pre>
<p>Because these functions all take a column as the first argument, they are easy to use with the pipe <code>-&gt;</code> macro, as with all functions in Tablecloth.</p>
<p>Given the incredibly large number of available functions, we will illustrate instead how these operations can be used.</p>
<p>We’ll start with two columns <code>a</code> and <code>b</code>:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb558"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb558-1"><a href="#cb558-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> a </span>(tcc/column [<span class="dv">20</span> <span class="dv">30</span> <span class="dv">40</span> <span class="dv">50</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb559"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb559-1"><a href="#cb559-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> b </span>(tcc/column (<span class="kw">range</span> <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here is a small sampling of operator functions:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb560"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb560-1"><a href="#cb560-1" aria-hidden="true" tabindex="-1"></a>(tcc/- a b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb561"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb561-1"><a href="#cb561-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[4]</span></span>
<span id="cb561-2"><a href="#cb561-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb561-3"><a href="#cb561-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">20</span>, <span class="dv">29</span>, <span class="dv">38</span>, <span class="dv">47</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb562"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb562-1"><a href="#cb562-1" aria-hidden="true" tabindex="-1"></a>(tcc/* a b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb563"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb563-1"><a href="#cb563-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[4]</span></span>
<span id="cb563-2"><a href="#cb563-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb563-3"><a href="#cb563-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">80</span>, <span class="dv">150</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb564"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true" tabindex="-1"></a>(tcc// a <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb565"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb565-1"><a href="#cb565-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[4]</span></span>
<span id="cb565-2"><a href="#cb565-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb565-3"><a href="#cb565-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb566"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb566-1"><a href="#cb566-1" aria-hidden="true" tabindex="-1"></a>(tcc/pow a <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb567"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb567-1"><a href="#cb567-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;float64&amp;gt;[4]</span></span>
<span id="cb567-2"><a href="#cb567-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb567-3"><a href="#cb567-3" aria-hidden="true" tabindex="-1"></a>[<span class="fl">400.0</span>, <span class="fl">900.0</span>, <span class="dv">1600</span>, <span class="dv">2500</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb568"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb568-1"><a href="#cb568-1" aria-hidden="true" tabindex="-1"></a>(tcc/* <span class="dv">10</span> (tcc/sin a))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb569"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb569-1"><a href="#cb569-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;float64&amp;gt;[4]</span></span>
<span id="cb569-2"><a href="#cb569-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb569-3"><a href="#cb569-3" aria-hidden="true" tabindex="-1"></a>[<span class="fl">9.129</span>, -<span class="fl">9.880</span>, <span class="fl">7.451</span>, -<span class="fl">2.624</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb570"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb570-1"><a href="#cb570-1" aria-hidden="true" tabindex="-1"></a>(tcc/&lt; a <span class="dv">35</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb571"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb571-1"><a href="#cb571-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;boolean&amp;gt;[4]</span></span>
<span id="cb571-2"><a href="#cb571-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb571-3"><a href="#cb571-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">true</span>, <span class="va">true</span>, <span class="va">false</span>, <span class="va">false</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>All these operations take a column as their first argument and return a column, so they can be chained easily.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb572"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb572-1"><a href="#cb572-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> a</span>
<span id="cb572-2"><a href="#cb572-2" aria-hidden="true" tabindex="-1"></a>    (tcc/* b)</span>
<span id="cb572-3"><a href="#cb572-3" aria-hidden="true" tabindex="-1"></a>    (tcc/&lt; <span class="dv">70</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb573"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb573-1"><a href="#cb573-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;boolean&amp;gt;[4]</span></span>
<span id="cb573-2"><a href="#cb573-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb573-3"><a href="#cb573-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">true</span>, <span class="va">true</span>, <span class="va">false</span>, <span class="va">false</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="missing-values" class="level3">
<h3 class="anchored" data-anchor-id="missing-values">Missing Values</h3>
<p>The <code>column</code> API includes utilities to handle missing values. Let’s go through them.</p>
<p>We start with a column that has missing values:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb574"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb574-1"><a href="#cb574-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> missing </span>(tcc/column [<span class="dv">1</span> <span class="dv">2</span> <span class="va">nil</span> <span class="dv">8</span> <span class="dv">10</span> <span class="va">nil</span> <span class="dv">20</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb575"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb575-1"><a href="#cb575-1" aria-hidden="true" tabindex="-1"></a>missing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb576"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb576-1"><a href="#cb576-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[7]</span></span>
<span id="cb576-2"><a href="#cb576-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb576-3"><a href="#cb576-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">2</span>, , <span class="dv">8</span>, <span class="dv">10</span>, , <span class="dv">20</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In many cases, running an operation on this column will still work without any handling:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb577"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb577-1"><a href="#cb577-1" aria-hidden="true" tabindex="-1"></a>(tcc/* missing (tcc/column [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb578"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb578-1"><a href="#cb578-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;float64&amp;gt;[7]</span></span>
<span id="cb578-2"><a href="#cb578-2" aria-hidden="true" tabindex="-1"></a>null</span>
<span id="cb578-3"><a href="#cb578-3" aria-hidden="true" tabindex="-1"></a>[<span class="fl">1.000</span>, <span class="fl">4.000</span>, , <span class="fl">32.00</span>, <span class="fl">50.00</span>, , <span class="fl">140.0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can count the number of missing values.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb579"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb579-1"><a href="#cb579-1" aria-hidden="true" tabindex="-1"></a>(tcc/count-missing missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb580"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb580-1"><a href="#cb580-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can drop them.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb581"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb581-1"><a href="#cb581-1" aria-hidden="true" tabindex="-1"></a>(tcc/drop-missing missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb582"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb582-1"><a href="#cb582-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[5]</span></span>
<span id="cb582-2"><a href="#cb582-2" aria-hidden="true" tabindex="-1"></a><span class="at">:col</span></span>
<span id="cb582-3"><a href="#cb582-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">20</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can replace them. This function includes different strategies, and the default is <code>:nearest</code>.</p>
<ul>
<li><code>:down</code> - Take the previous value, or use provided value.</li>
<li><code>:up</code> - Take the next value, or use provided value.</li>
<li><code>:downup</code> - Take the previous value, otherwise take the next value.</li>
<li><code>:updown</code> - Take the next value, otherwise take the previous value.</li>
<li><code>:nearest</code> - Use the nearest of next or previous values. (Strategy <code>:mid</code> is an alias for <code>:nearest</code>).</li>
<li><code>:midpoint</code> - Use the midpoint of averaged values between previous and next (non-missing) values.</li>
<li><code>:abb</code> - Impute missing value with approximate Bayesian bootstrap. See <a href="https://search.r-project.org/CRAN/refmans/LaplacesDemon/html/ABB.html">r’s ABB</a>.</li>
<li><code>:lerp</code> - Linearly interpolate values between previous and next nonmissing rows.</li>
<li><code>:value</code> - Provide a value explicitly. Value may be a function in which case it will be called on the column with missing values elided and the return will be used to as the filler.</li>
</ul>
<div class="sourceClojure">
<div class="sourceCode" id="cb583"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb583-1"><a href="#cb583-1" aria-hidden="true" tabindex="-1"></a>(tcc/replace-missing missing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb584"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb584-1"><a href="#cb584-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;float64&amp;gt;[7]</span></span>
<span id="cb584-2"><a href="#cb584-2" aria-hidden="true" tabindex="-1"></a><span class="at">:col</span></span>
<span id="cb584-3"><a href="#cb584-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">20</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb585"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb585-1"><a href="#cb585-1" aria-hidden="true" tabindex="-1"></a>(tcc/replace-missing missing <span class="at">:value</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb586"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb586-1"><a href="#cb586-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;float64&amp;gt;[7]</span></span>
<span id="cb586-2"><a href="#cb586-2" aria-hidden="true" tabindex="-1"></a><span class="at">:col</span></span>
<span id="cb586-3"><a href="#cb586-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">100.0</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="fl">100.0</span>, <span class="dv">20</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="pipeline" class="level2">
<h2 class="anchored" data-anchor-id="pipeline">Pipeline</h2>
<p><code>tablecloth.pipeline</code> exports special versions of API which create functions operating only on dataset. This creates the possibility to chain operations and compose them easily.</p>
<p>There are two ways to create pipelines:</p>
<ul>
<li>functional, as a composition of functions</li>
<li>declarative, separating task declarations and concrete parametrization.</li>
</ul>
<p>Pipeline operations are prepared to work with <a href="https://github.com/scicloj/metamorph">metamorph</a> library. That means that result of the pipeline is wrapped into a map and dataset is stored under <code>:metamorph/data</code> key.</p>
<blockquote class="blockquote">
<p><strong>Warning: Duplicated <code>metamorph</code> pipeline functions are removed from <code>tablecloth.pipeline</code> namespace.</strong></p>
</blockquote>
</section>
<section id="other-examples" class="level2">
<h2 class="anchored" data-anchor-id="other-examples">Other examples</h2>
<section id="stocks" class="level3">
<h3 class="anchored" data-anchor-id="stocks">Stocks</h3>
<div class="sourceClojure">
<div class="sourceCode" id="cb587"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb587-1"><a href="#cb587-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defonce</span><span class="fu"> stocks </span>(tc/dataset <span class="st">"https://raw.githubusercontent.com/techascent/tech.ml.dataset/master/test/data/stocks.csv"</span> {<span class="at">:key-fn</span> <span class="kw">keyword</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb588"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb588-1"><a href="#cb588-1" aria-hidden="true" tabindex="-1"></a>stocks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>https://raw.githubusercontent.com/techascent/tech.ml.dataset/master/test/data/stocks.csv [560 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:symbol</th>
<th>:date</th>
<th style="text-align: right;">:price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MSFT</td>
<td>2000-01-01</td>
<td style="text-align: right;">39.81</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td>2000-02-01</td>
<td style="text-align: right;">36.35</td>
</tr>
<tr class="odd">
<td>MSFT</td>
<td>2000-03-01</td>
<td style="text-align: right;">43.22</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td>2000-04-01</td>
<td style="text-align: right;">28.37</td>
</tr>
<tr class="odd">
<td>MSFT</td>
<td>2000-05-01</td>
<td style="text-align: right;">25.45</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td>2000-06-01</td>
<td style="text-align: right;">32.54</td>
</tr>
<tr class="odd">
<td>MSFT</td>
<td>2000-07-01</td>
<td style="text-align: right;">28.40</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td>2000-08-01</td>
<td style="text-align: right;">28.40</td>
</tr>
<tr class="odd">
<td>MSFT</td>
<td>2000-09-01</td>
<td style="text-align: right;">24.53</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td>2000-10-01</td>
<td style="text-align: right;">28.02</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td>2009-05-01</td>
<td style="text-align: right;">135.81</td>
</tr>
<tr class="odd">
<td>AAPL</td>
<td>2009-06-01</td>
<td style="text-align: right;">142.43</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td>2009-07-01</td>
<td style="text-align: right;">163.39</td>
</tr>
<tr class="odd">
<td>AAPL</td>
<td>2009-08-01</td>
<td style="text-align: right;">168.21</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td>2009-09-01</td>
<td style="text-align: right;">185.35</td>
</tr>
<tr class="odd">
<td>AAPL</td>
<td>2009-10-01</td>
<td style="text-align: right;">188.50</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td>2009-11-01</td>
<td style="text-align: right;">199.91</td>
</tr>
<tr class="odd">
<td>AAPL</td>
<td>2009-12-01</td>
<td style="text-align: right;">210.73</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td>2010-01-01</td>
<td style="text-align: right;">192.06</td>
</tr>
<tr class="odd">
<td>AAPL</td>
<td>2010-02-01</td>
<td style="text-align: right;">204.62</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td>2010-03-01</td>
<td style="text-align: right;">223.02</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb589"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb589-1"><a href="#cb589-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> stocks</span>
<span id="cb589-2"><a href="#cb589-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by (<span class="kw">fn</span> [row]</span>
<span id="cb589-3"><a href="#cb589-3" aria-hidden="true" tabindex="-1"></a>                   {<span class="at">:symbol</span> (<span class="at">:symbol</span> row)</span>
<span id="cb589-4"><a href="#cb589-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">:year</span> (tech.v3.datatype.datetime/long-temporal-field <span class="at">:years</span> (<span class="at">:date</span> row))}))</span>
<span id="cb589-5"><a href="#cb589-5" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate #(tech.v3.datatype.functional/mean (<span class="va">%</span> <span class="at">:price</span>)))</span>
<span id="cb589-6"><a href="#cb589-6" aria-hidden="true" tabindex="-1"></a>    (tc/order-by [<span class="at">:symbol</span> <span class="at">:year</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [51 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:symbol</th>
<th style="text-align: right;">:year</th>
<th style="text-align: right;">summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AAPL</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">21.74833333</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td style="text-align: right;">2001</td>
<td style="text-align: right;">10.17583333</td>
</tr>
<tr class="odd">
<td>AAPL</td>
<td style="text-align: right;">2002</td>
<td style="text-align: right;">9.40833333</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;">9.34750000</td>
</tr>
<tr class="odd">
<td>AAPL</td>
<td style="text-align: right;">2004</td>
<td style="text-align: right;">18.72333333</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">48.17166667</td>
</tr>
<tr class="odd">
<td>AAPL</td>
<td style="text-align: right;">2006</td>
<td style="text-align: right;">72.04333333</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td style="text-align: right;">2007</td>
<td style="text-align: right;">133.35333333</td>
</tr>
<tr class="odd">
<td>AAPL</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">138.48083333</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td style="text-align: right;">2009</td>
<td style="text-align: right;">150.39333333</td>
</tr>
<tr class="odd">
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">29.67333333</td>
</tr>
<tr class="odd">
<td>MSFT</td>
<td style="text-align: right;">2001</td>
<td style="text-align: right;">25.34750000</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td style="text-align: right;">2002</td>
<td style="text-align: right;">21.82666667</td>
</tr>
<tr class="odd">
<td>MSFT</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;">20.93416667</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td style="text-align: right;">2004</td>
<td style="text-align: right;">22.67416667</td>
</tr>
<tr class="odd">
<td>MSFT</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">23.84583333</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td style="text-align: right;">2006</td>
<td style="text-align: right;">24.75833333</td>
</tr>
<tr class="odd">
<td>MSFT</td>
<td style="text-align: right;">2007</td>
<td style="text-align: right;">29.28416667</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">25.20833333</td>
</tr>
<tr class="odd">
<td>MSFT</td>
<td style="text-align: right;">2009</td>
<td style="text-align: right;">22.87250000</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">28.50666667</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb590"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb590-1"><a href="#cb590-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> stocks</span>
<span id="cb590-2"><a href="#cb590-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by (<span class="kw">juxt</span> <span class="at">:symbol</span> #(tech.v3.datatype.datetime/long-temporal-field <span class="at">:years</span> (<span class="va">%</span> <span class="at">:date</span>))))</span>
<span id="cb590-3"><a href="#cb590-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate #(tech.v3.datatype.functional/mean (<span class="va">%</span> <span class="at">:price</span>)))</span>
<span id="cb590-4"><a href="#cb590-4" aria-hidden="true" tabindex="-1"></a>    (tc/rename-columns {:$group-name<span class="dv">-0</span> <span class="at">:symbol</span></span>
<span id="cb590-5"><a href="#cb590-5" aria-hidden="true" tabindex="-1"></a>                        :$group-name<span class="dv">-1</span> <span class="at">:year</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [51 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:symbol</th>
<th style="text-align: right;">:year</th>
<th style="text-align: right;">summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MSFT</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">29.67333333</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td style="text-align: right;">2001</td>
<td style="text-align: right;">25.34750000</td>
</tr>
<tr class="odd">
<td>MSFT</td>
<td style="text-align: right;">2002</td>
<td style="text-align: right;">21.82666667</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;">20.93416667</td>
</tr>
<tr class="odd">
<td>MSFT</td>
<td style="text-align: right;">2004</td>
<td style="text-align: right;">22.67416667</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">23.84583333</td>
</tr>
<tr class="odd">
<td>MSFT</td>
<td style="text-align: right;">2006</td>
<td style="text-align: right;">24.75833333</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td style="text-align: right;">2007</td>
<td style="text-align: right;">29.28416667</td>
</tr>
<tr class="odd">
<td>MSFT</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">25.20833333</td>
</tr>
<tr class="even">
<td>MSFT</td>
<td style="text-align: right;">2009</td>
<td style="text-align: right;">22.87250000</td>
</tr>
<tr class="odd">
<td>…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">21.74833333</td>
</tr>
<tr class="odd">
<td>AAPL</td>
<td style="text-align: right;">2001</td>
<td style="text-align: right;">10.17583333</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td style="text-align: right;">2002</td>
<td style="text-align: right;">9.40833333</td>
</tr>
<tr class="odd">
<td>AAPL</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;">9.34750000</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td style="text-align: right;">2004</td>
<td style="text-align: right;">18.72333333</td>
</tr>
<tr class="odd">
<td>AAPL</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">48.17166667</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td style="text-align: right;">2006</td>
<td style="text-align: right;">72.04333333</td>
</tr>
<tr class="odd">
<td>AAPL</td>
<td style="text-align: right;">2007</td>
<td style="text-align: right;">133.35333333</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">138.48083333</td>
</tr>
<tr class="odd">
<td>AAPL</td>
<td style="text-align: right;">2009</td>
<td style="text-align: right;">150.39333333</td>
</tr>
<tr class="even">
<td>AAPL</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">206.56666667</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="data.table" class="level3">
<h3 class="anchored" data-anchor-id="data.table">data.table</h3>
<p>Below you can find comparizon between functionality of <code>data.table</code> and Clojure dataset API. I leave it without comments, please refer original document explaining details:</p>
<p><a href="https://rdatatable.gitlab.io/data.table/articles/datatable-intro.html">Introduction to <code>data.table</code></a></p>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb591"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb591-1"><a href="#cb591-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb591-2"><a href="#cb591-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb591-3"><a href="#cb591-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb591-4"><a href="#cb591-4" aria-hidden="true" tabindex="-1"></a>flights <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">"https://raw.githubusercontent.com/Rdatatable/data.table/master/vignettes/flights14.csv"</span>)</span>
<span id="cb591-5"><a href="#cb591-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb591-6"><a href="#cb591-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(flights))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">day</th>
<th style="text-align: right;">dep_delay</th>
<th style="text-align: right;">arr_delay</th>
<th style="text-align: left;">carrier</th>
<th style="text-align: left;">origin</th>
<th style="text-align: left;">dest</th>
<th style="text-align: right;">air_time</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">359</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-3</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">363</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">351</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-8</td>
<td style="text-align: right;">-26</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">LGA</td>
<td style="text-align: left;">PBI</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">1035</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">339</td>
<td style="text-align: right;">2454</td>
<td style="text-align: right;">18</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb592"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb592-1"><a href="#cb592-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">require</span> '[tech.v3.datatype.functional <span class="at">:as</span> dfn]</span>
<span id="cb592-2"><a href="#cb592-2" aria-hidden="true" tabindex="-1"></a>         '[tech.v3.datatype.argops <span class="at">:as</span> aops]</span>
<span id="cb592-3"><a href="#cb592-3" aria-hidden="true" tabindex="-1"></a>         '[tech.v3.datatype <span class="at">:as</span> dtype])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb593"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb593-1"><a href="#cb593-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defonce</span><span class="fu"> flights </span>(tc/dataset <span class="st">"https://raw.githubusercontent.com/Rdatatable/data.table/master/vignettes/flights14.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb594"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb594-1"><a href="#cb594-1" aria-hidden="true" tabindex="-1"></a>(tc/head flights <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>https://raw.githubusercontent.com/Rdatatable/data.table/master/vignettes/flights14.csv [6 11]:</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">day</th>
<th style="text-align: right;">dep_delay</th>
<th style="text-align: right;">arr_delay</th>
<th>carrier</th>
<th>origin</th>
<th>dest</th>
<th style="text-align: right;">air_time</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">13</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">359</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-3</td>
<td style="text-align: right;">13</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">363</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">9</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">351</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-8</td>
<td style="text-align: right;">-26</td>
<td>AA</td>
<td>LGA</td>
<td>PBI</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">1035</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td>AA</td>
<td>EWR</td>
<td>LAX</td>
<td style="text-align: right;">339</td>
<td style="text-align: right;">2454</td>
<td style="text-align: right;">18</td>
</tr>
</tbody>
</table>
</div>
<section id="basics" class="level4">
<h4 class="anchored" data-anchor-id="basics">Basics</h4>
<section id="shape-of-loaded-data" class="level5">
<h5 class="anchored" data-anchor-id="shape-of-loaded-data">Shape of loaded data</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb595"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb595-1"><a href="#cb595-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(flights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 253316     11</code></pre>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb597"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb597-1"><a href="#cb597-1" aria-hidden="true" tabindex="-1"></a>(tc/shape flights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb598"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb598-1"><a href="#cb598-1" aria-hidden="true" tabindex="-1"></a>[<span class="dv">253316</span> <span class="dv">11</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="what-is-data.table" class="level5">
<h5 class="anchored" data-anchor-id="what-is-data.table">What is <code>data.table</code>?</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb599"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb599-1"><a href="#cb599-1" aria-hidden="true" tabindex="-1"></a>DT <span class="ot">=</span> <span class="fu">data.table</span>(</span>
<span id="cb599-2"><a href="#cb599-2" aria-hidden="true" tabindex="-1"></a><span class="at">ID =</span> <span class="fu">c</span>(<span class="st">"b"</span>,<span class="st">"b"</span>,<span class="st">"b"</span>,<span class="st">"a"</span>,<span class="st">"a"</span>,<span class="st">"c"</span>),</span>
<span id="cb599-3"><a href="#cb599-3" aria-hidden="true" tabindex="-1"></a><span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb599-4"><a href="#cb599-4" aria-hidden="true" tabindex="-1"></a><span class="at">b =</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>,</span>
<span id="cb599-5"><a href="#cb599-5" aria-hidden="true" tabindex="-1"></a><span class="at">c =</span> <span class="dv">13</span><span class="sc">:</span><span class="dv">18</span></span>
<span id="cb599-6"><a href="#cb599-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb599-7"><a href="#cb599-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb599-8"><a href="#cb599-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(DT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: right;">a</th>
<th style="text-align: right;">b</th>
<th style="text-align: right;">c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">c</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">18</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb600"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb600-1"><a href="#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(DT<span class="sc">$</span>ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb602"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb602-1"><a href="#cb602-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DT </span>(tc/dataset {<span class="at">:ID</span> [<span class="st">"b"</span> <span class="st">"b"</span> <span class="st">"b"</span> <span class="st">"a"</span> <span class="st">"a"</span> <span class="st">"c"</span>]</span>
<span id="cb602-2"><a href="#cb602-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:a</span> (<span class="kw">range</span> <span class="dv">1</span> <span class="dv">7</span>)</span>
<span id="cb602-3"><a href="#cb602-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:b</span> (<span class="kw">range</span> <span class="dv">7</span> <span class="dv">13</span>)</span>
<span id="cb602-4"><a href="#cb602-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:c</span> (<span class="kw">range</span> <span class="dv">13</span> <span class="dv">19</span>)}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb603"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb603-1"><a href="#cb603-1" aria-hidden="true" tabindex="-1"></a>DT</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:ID</th>
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td>b</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td>b</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td>a</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td>a</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td>c</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">18</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb604"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb604-1"><a href="#cb604-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> <span class="at">:ID</span> DT <span class="kw">meta</span> <span class="at">:datatype</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb605"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb605-1"><a href="#cb605-1" aria-hidden="true" tabindex="-1"></a><span class="at">:string</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="get-all-the-flights-with-jfk-as-the-origin-airport-in-the-month-of-june." class="level5">
<h5 class="anchored" data-anchor-id="get-all-the-flights-with-jfk-as-the-origin-airport-in-the-month-of-june.">Get all the flights with “JFK” as the origin airport in the month of June.</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb606"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb606-1"><a href="#cb606-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[origin <span class="sc">==</span> <span class="st">"JFK"</span> <span class="sc">&amp;</span> month <span class="sc">==</span> <span class="dv">6</span>L]</span>
<span id="cb606-2"><a href="#cb606-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(ans))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">day</th>
<th style="text-align: right;">dep_delay</th>
<th style="text-align: right;">arr_delay</th>
<th style="text-align: left;">carrier</th>
<th style="text-align: left;">origin</th>
<th style="text-align: left;">dest</th>
<th style="text-align: right;">air_time</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-9</td>
<td style="text-align: right;">-5</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">324</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-10</td>
<td style="text-align: right;">-13</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">329</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">-1</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">326</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-6</td>
<td style="text-align: right;">-16</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">320</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-4</td>
<td style="text-align: right;">-45</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">326</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-6</td>
<td style="text-align: right;">-23</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">329</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">14</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb607"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb607-1"><a href="#cb607-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb607-2"><a href="#cb607-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows (<span class="kw">fn</span> [row] (<span class="kw">and</span> (<span class="kw">=</span> (<span class="kw">get</span> row <span class="st">"origin"</span>) <span class="st">"JFK"</span>)</span>
<span id="cb607-3"><a href="#cb607-3" aria-hidden="true" tabindex="-1"></a>                                   (<span class="kw">=</span> (<span class="kw">get</span> row <span class="st">"month"</span>) <span class="dv">6</span>))))</span>
<span id="cb607-4"><a href="#cb607-4" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>https://raw.githubusercontent.com/Rdatatable/data.table/master/vignettes/flights14.csv [6 11]:</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">day</th>
<th style="text-align: right;">dep_delay</th>
<th style="text-align: right;">arr_delay</th>
<th>carrier</th>
<th>origin</th>
<th>dest</th>
<th style="text-align: right;">air_time</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-9</td>
<td style="text-align: right;">-5</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">324</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-10</td>
<td style="text-align: right;">-13</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">329</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">-1</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">326</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-6</td>
<td style="text-align: right;">-16</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">320</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-4</td>
<td style="text-align: right;">-45</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">326</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-6</td>
<td style="text-align: right;">-23</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">329</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">14</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="get-the-first-two-rows-from-flights." class="level5">
<h5 class="anchored" data-anchor-id="get-the-first-two-rows-from-flights.">Get the first two rows from <code>flights</code>.</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb608"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb608-1"><a href="#cb608-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb608-2"><a href="#cb608-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">day</th>
<th style="text-align: right;">dep_delay</th>
<th style="text-align: right;">arr_delay</th>
<th style="text-align: left;">carrier</th>
<th style="text-align: left;">origin</th>
<th style="text-align: left;">dest</th>
<th style="text-align: right;">air_time</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">359</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-3</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">363</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">11</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb609"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb609-1"><a href="#cb609-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows flights (<span class="kw">range</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>https://raw.githubusercontent.com/Rdatatable/data.table/master/vignettes/flights14.csv [2 11]:</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">day</th>
<th style="text-align: right;">dep_delay</th>
<th style="text-align: right;">arr_delay</th>
<th>carrier</th>
<th>origin</th>
<th>dest</th>
<th style="text-align: right;">air_time</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">13</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">359</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-3</td>
<td style="text-align: right;">13</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">363</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">11</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="sort-flights-first-by-column-origin-in-ascending-order-and-then-by-dest-in-descending-order" class="level5">
<h5 class="anchored" data-anchor-id="sort-flights-first-by-column-origin-in-ascending-order-and-then-by-dest-in-descending-order">Sort <code>flights</code> first by column <code>origin</code> in ascending order, and then by <code>dest</code> in descending order</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb610"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb610-1"><a href="#cb610-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[<span class="fu">order</span>(origin, <span class="sc">-</span>dest)]</span>
<span id="cb610-2"><a href="#cb610-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(ans))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">day</th>
<th style="text-align: right;">dep_delay</th>
<th style="text-align: right;">arr_delay</th>
<th style="text-align: left;">carrier</th>
<th style="text-align: left;">origin</th>
<th style="text-align: left;">dest</th>
<th style="text-align: right;">air_time</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">49</td>
<td style="text-align: left;">EV</td>
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">XNA</td>
<td style="text-align: right;">195</td>
<td style="text-align: right;">1131</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">EV</td>
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">XNA</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">1131</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">-6</td>
<td style="text-align: right;">-13</td>
<td style="text-align: left;">EV</td>
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">XNA</td>
<td style="text-align: right;">179</td>
<td style="text-align: right;">1131</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">-7</td>
<td style="text-align: right;">-12</td>
<td style="text-align: left;">EV</td>
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">XNA</td>
<td style="text-align: right;">184</td>
<td style="text-align: right;">1131</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">EV</td>
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">XNA</td>
<td style="text-align: right;">181</td>
<td style="text-align: right;">1131</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">66</td>
<td style="text-align: left;">EV</td>
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">XNA</td>
<td style="text-align: right;">188</td>
<td style="text-align: right;">1131</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb611"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb611-1"><a href="#cb611-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb611-2"><a href="#cb611-2" aria-hidden="true" tabindex="-1"></a>    (tc/order-by [<span class="st">"origin"</span> <span class="st">"dest"</span>] [<span class="at">:asc</span> <span class="at">:desc</span>])</span>
<span id="cb611-3"><a href="#cb611-3" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>https://raw.githubusercontent.com/Rdatatable/data.table/master/vignettes/flights14.csv [6 11]:</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">day</th>
<th style="text-align: right;">dep_delay</th>
<th style="text-align: right;">arr_delay</th>
<th>carrier</th>
<th>origin</th>
<th>dest</th>
<th style="text-align: right;">air_time</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-6</td>
<td style="text-align: right;">-38</td>
<td>EV</td>
<td>EWR</td>
<td>XNA</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">1131</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">-9</td>
<td style="text-align: right;">-17</td>
<td>EV</td>
<td>EWR</td>
<td>XNA</td>
<td style="text-align: right;">177</td>
<td style="text-align: right;">1131</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">-6</td>
<td style="text-align: right;">10</td>
<td>EV</td>
<td>EWR</td>
<td>XNA</td>
<td style="text-align: right;">201</td>
<td style="text-align: right;">1131</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">231</td>
<td style="text-align: right;">268</td>
<td>EV</td>
<td>EWR</td>
<td>XNA</td>
<td style="text-align: right;">184</td>
<td style="text-align: right;">1131</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-8</td>
<td style="text-align: right;">-32</td>
<td>EV</td>
<td>EWR</td>
<td>XNA</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">1131</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">10</td>
<td>EV</td>
<td>EWR</td>
<td>XNA</td>
<td style="text-align: right;">176</td>
<td style="text-align: right;">1131</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="select-arr_delay-column-but-return-it-as-a-vector" class="level5">
<h5 class="anchored" data-anchor-id="select-arr_delay-column-but-return-it-as-a-vector">Select <code>arr_delay</code> column, but return it as a vector</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb612"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb612-1"><a href="#cb612-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[, arr_delay]</span>
<span id="cb612-2"><a href="#cb612-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  13  13   9 -26   1   0</code></pre>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb614"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb614-1"><a href="#cb614-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">take</span> <span class="dv">6</span> (flights <span class="st">"arr_delay"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb615"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb615-1"><a href="#cb615-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">13</span> <span class="dv">13</span> <span class="dv">9</span> -<span class="dv">26</span> <span class="dv">1</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="select-arr_delay-column-but-return-as-a-data.table-instead" class="level5">
<h5 class="anchored" data-anchor-id="select-arr_delay-column-but-return-as-a-data.table-instead">Select <code>arr_delay</code> column, but return as a data.table instead</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb616"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb616-1"><a href="#cb616-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[, <span class="fu">list</span>(arr_delay)]</span>
<span id="cb616-2"><a href="#cb616-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(ans))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">arr_delay</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">-26</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb617"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb617-1"><a href="#cb617-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb617-2"><a href="#cb617-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns <span class="st">"arr_delay"</span>)</span>
<span id="cb617-3"><a href="#cb617-3" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>https://raw.githubusercontent.com/Rdatatable/data.table/master/vignettes/flights14.csv [6 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">arr_delay</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">-26</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="select-both-arr_delay-and-dep_delay-columns" class="level5">
<h5 class="anchored" data-anchor-id="select-both-arr_delay-and-dep_delay-columns">Select both <code>arr_delay</code> and <code>dep_delay</code> columns</h5>
<p>R</p>
<p>``</p>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb618"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb618-1"><a href="#cb618-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb618-2"><a href="#cb618-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns [<span class="st">"arr_delay"</span> <span class="st">"dep_delay"</span>])</span>
<span id="cb618-3"><a href="#cb618-3" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>https://raw.githubusercontent.com/Rdatatable/data.table/master/vignettes/flights14.csv [6 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">arr_delay</th>
<th style="text-align: right;">dep_delay</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">-26</td>
<td style="text-align: right;">-8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="select-both-arr_delay-and-dep_delay-columns-and-rename-them-to-delay_arr-and-delay_dep" class="level5">
<h5 class="anchored" data-anchor-id="select-both-arr_delay-and-dep_delay-columns-and-rename-them-to-delay_arr-and-delay_dep">Select both <code>arr_delay</code> and <code>dep_delay</code> columns and rename them to <code>delay_arr</code> and <code>delay_dep</code></h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb619"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb619-1"><a href="#cb619-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[, .(<span class="at">delay_arr =</span> arr_delay, <span class="at">delay_dep =</span> dep_delay)]</span>
<span id="cb619-2"><a href="#cb619-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(ans))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">delay_arr</th>
<th style="text-align: right;">delay_dep</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">-26</td>
<td style="text-align: right;">-8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb620"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb620-1"><a href="#cb620-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb620-2"><a href="#cb620-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns {<span class="st">"arr_delay"</span> <span class="st">"delay_arr"</span></span>
<span id="cb620-3"><a href="#cb620-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"dep_delay"</span> <span class="st">"delay_arr"</span>})</span>
<span id="cb620-4"><a href="#cb620-4" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>https://raw.githubusercontent.com/Rdatatable/data.table/master/vignettes/flights14.csv [6 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">delay_arr</th>
<th style="text-align: right;">delay_arr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">-26</td>
<td style="text-align: right;">-8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="how-many-trips-have-had-total-delay-0" class="level5">
<h5 class="anchored" data-anchor-id="how-many-trips-have-had-total-delay-0">How many trips have had total delay &lt; 0?</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb621"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb621-1"><a href="#cb621-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[, <span class="fu">sum</span>( (arr_delay <span class="sc">+</span> dep_delay) <span class="sc">&lt;</span> <span class="dv">0</span> )]</span>
<span id="cb621-2"><a href="#cb621-2" aria-hidden="true" tabindex="-1"></a>ans</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 141814</code></pre>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb623"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb623-1"><a href="#cb623-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;&gt;</span> (dfn/+ (flights <span class="st">"arr_delay"</span>) (flights <span class="st">"dep_delay"</span>))</span>
<span id="cb623-2"><a href="#cb623-2" aria-hidden="true" tabindex="-1"></a>     (aops/argfilter #(<span class="kw">&lt;</span> <span class="va">%</span> <span class="fl">0.0</span>))</span>
<span id="cb623-3"><a href="#cb623-3" aria-hidden="true" tabindex="-1"></a>     (dtype/ecount))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb624"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb624-1"><a href="#cb624-1" aria-hidden="true" tabindex="-1"></a><span class="dv">141814</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or pure Clojure functions (much, much slower)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb625"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb625-1"><a href="#cb625-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;&gt;</span> (<span class="kw">map</span> <span class="kw">+</span> (flights <span class="st">"arr_delay"</span>) (flights <span class="st">"dep_delay"</span>))</span>
<span id="cb625-2"><a href="#cb625-2" aria-hidden="true" tabindex="-1"></a>     (<span class="kw">filter</span> <span class="kw">neg?</span>)</span>
<span id="cb625-3"><a href="#cb625-3" aria-hidden="true" tabindex="-1"></a>     (<span class="kw">count</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb626"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb626-1"><a href="#cb626-1" aria-hidden="true" tabindex="-1"></a><span class="dv">141814</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculate-the-average-arrival-and-departure-delay-for-all-flights-with-jfk-as-the-origin-airport-in-the-month-of-june" class="level5">
<h5 class="anchored" data-anchor-id="calculate-the-average-arrival-and-departure-delay-for-all-flights-with-jfk-as-the-origin-airport-in-the-month-of-june">Calculate the average arrival and departure delay for all flights with “JFK” as the origin airport in the month of June</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb627"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb627-1"><a href="#cb627-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[origin <span class="sc">==</span> <span class="st">"JFK"</span> <span class="sc">&amp;</span> month <span class="sc">==</span> <span class="dv">6</span>L,</span>
<span id="cb627-2"><a href="#cb627-2" aria-hidden="true" tabindex="-1"></a>.(<span class="at">m_arr =</span> <span class="fu">mean</span>(arr_delay), <span class="at">m_dep =</span> <span class="fu">mean</span>(dep_delay))]</span>
<span id="cb627-3"><a href="#cb627-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">m_arr</th>
<th style="text-align: right;">m_dep</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">5.839349</td>
<td style="text-align: right;">9.807884</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb628"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb628-1"><a href="#cb628-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb628-2"><a href="#cb628-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows (<span class="kw">fn</span> [row] (<span class="kw">and</span> (<span class="kw">=</span> (<span class="kw">get</span> row <span class="st">"origin"</span>) <span class="st">"JFK"</span>)</span>
<span id="cb628-3"><a href="#cb628-3" aria-hidden="true" tabindex="-1"></a>                                   (<span class="kw">=</span> (<span class="kw">get</span> row <span class="st">"month"</span>) <span class="dv">6</span>))))</span>
<span id="cb628-4"><a href="#cb628-4" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate {<span class="at">:m</span>_arr #(dfn/mean (<span class="va">%</span> <span class="st">"arr_delay"</span>))</span>
<span id="cb628-5"><a href="#cb628-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">:m</span>_dep #(dfn/mean (<span class="va">%</span> <span class="st">"dep_delay"</span>))}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:m_arr</th>
<th style="text-align: right;">:m_dep</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">5.83934932</td>
<td style="text-align: right;">9.80788411</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="how-many-trips-have-been-made-in-2014-from-jfk-airport-in-the-month-of-june" class="level5">
<h5 class="anchored" data-anchor-id="how-many-trips-have-been-made-in-2014-from-jfk-airport-in-the-month-of-june">How many trips have been made in 2014 from “JFK” airport in the month of June?</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb629"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb629-1"><a href="#cb629-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[origin <span class="sc">==</span> <span class="st">"JFK"</span> <span class="sc">&amp;</span> month <span class="sc">==</span> <span class="dv">6</span>L, <span class="fu">length</span>(dest)]</span>
<span id="cb629-2"><a href="#cb629-2" aria-hidden="true" tabindex="-1"></a>ans</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8422</code></pre>
</div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb631"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb631-1"><a href="#cb631-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[origin <span class="sc">==</span> <span class="st">"JFK"</span> <span class="sc">&amp;</span> month <span class="sc">==</span> <span class="dv">6</span>L, .N]</span>
<span id="cb631-2"><a href="#cb631-2" aria-hidden="true" tabindex="-1"></a>ans</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8422</code></pre>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb633"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb633-1"><a href="#cb633-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb633-2"><a href="#cb633-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows (<span class="kw">fn</span> [row] (<span class="kw">and</span> (<span class="kw">=</span> (<span class="kw">get</span> row <span class="st">"origin"</span>) <span class="st">"JFK"</span>)</span>
<span id="cb633-3"><a href="#cb633-3" aria-hidden="true" tabindex="-1"></a>                                   (<span class="kw">=</span> (<span class="kw">get</span> row <span class="st">"month"</span>) <span class="dv">6</span>))))</span>
<span id="cb633-4"><a href="#cb633-4" aria-hidden="true" tabindex="-1"></a>    (tc/row-count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb634"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb634-1"><a href="#cb634-1" aria-hidden="true" tabindex="-1"></a><span class="dv">8422</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="deselect-columns-using---or" class="level5">
<h5 class="anchored" data-anchor-id="deselect-columns-using---or">deselect columns using - or !</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb635"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb635-1"><a href="#cb635-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[, <span class="sc">!</span><span class="fu">c</span>(<span class="st">"arr_delay"</span>, <span class="st">"dep_delay"</span>)]</span>
<span id="cb635-2"><a href="#cb635-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(ans))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">day</th>
<th style="text-align: left;">carrier</th>
<th style="text-align: left;">origin</th>
<th style="text-align: left;">dest</th>
<th style="text-align: right;">air_time</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">359</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">363</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">351</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">LGA</td>
<td style="text-align: left;">PBI</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">1035</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">339</td>
<td style="text-align: right;">2454</td>
<td style="text-align: right;">18</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb636"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb636-1"><a href="#cb636-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[, <span class="sc">-</span><span class="fu">c</span>(<span class="st">"arr_delay"</span>, <span class="st">"dep_delay"</span>)]</span>
<span id="cb636-2"><a href="#cb636-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(ans))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">day</th>
<th style="text-align: left;">carrier</th>
<th style="text-align: left;">origin</th>
<th style="text-align: left;">dest</th>
<th style="text-align: right;">air_time</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">359</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">363</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">351</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">LGA</td>
<td style="text-align: left;">PBI</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">1035</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">339</td>
<td style="text-align: right;">2454</td>
<td style="text-align: right;">18</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb637"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb637-1"><a href="#cb637-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb637-2"><a href="#cb637-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns (<span class="kw">complement</span> #{<span class="st">"arr_delay"</span> <span class="st">"dep_delay"</span>}))</span>
<span id="cb637-3"><a href="#cb637-3" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>https://raw.githubusercontent.com/Rdatatable/data.table/master/vignettes/flights14.csv [6 9]:</p>
<table class="table">
<colgroup>
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">day</th>
<th>carrier</th>
<th>origin</th>
<th>dest</th>
<th style="text-align: right;">air_time</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">359</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">363</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">351</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>AA</td>
<td>LGA</td>
<td>PBI</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">1035</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td>AA</td>
<td>EWR</td>
<td>LAX</td>
<td style="text-align: right;">339</td>
<td style="text-align: right;">2454</td>
<td style="text-align: right;">18</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="aggregations" class="level4">
<h4 class="anchored" data-anchor-id="aggregations">Aggregations</h4>
<section id="how-can-we-get-the-number-of-trips-corresponding-to-each-origin-airport" class="level5">
<h5 class="anchored" data-anchor-id="how-can-we-get-the-number-of-trips-corresponding-to-each-origin-airport">How can we get the number of trips corresponding to each origin airport?</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb638"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb638-1"><a href="#cb638-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[, .(.N), by <span class="ot">=</span> .(origin)]</span>
<span id="cb638-2"><a href="#cb638-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">origin</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">JFK</td>
<td style="text-align: right;">81483</td>
</tr>
<tr class="even">
<td style="text-align: left;">LGA</td>
<td style="text-align: right;">84433</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EWR</td>
<td style="text-align: right;">87400</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb639"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb639-1"><a href="#cb639-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb639-2"><a href="#cb639-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="st">"origin"</span>])</span>
<span id="cb639-3"><a href="#cb639-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate {<span class="at">:N</span> tc/row-count}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>origin</th>
<th style="text-align: right;">:N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>JFK</td>
<td style="text-align: right;">81483</td>
</tr>
<tr class="even">
<td>LGA</td>
<td style="text-align: right;">84433</td>
</tr>
<tr class="odd">
<td>EWR</td>
<td style="text-align: right;">87400</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="how-can-we-calculate-the-number-of-trips-for-each-origin-airport-for-carrier-code-aa" class="level5">
<h5 class="anchored" data-anchor-id="how-can-we-calculate-the-number-of-trips-for-each-origin-airport-for-carrier-code-aa">How can we calculate the number of trips for each origin airport for carrier code “AA”?</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb640"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb640-1"><a href="#cb640-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[carrier <span class="sc">==</span> <span class="st">"AA"</span>, .N, by <span class="ot">=</span> origin]</span>
<span id="cb640-2"><a href="#cb640-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">origin</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">JFK</td>
<td style="text-align: right;">11923</td>
</tr>
<tr class="even">
<td style="text-align: left;">LGA</td>
<td style="text-align: right;">11730</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EWR</td>
<td style="text-align: right;">2649</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb641"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb641-1"><a href="#cb641-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb641-2"><a href="#cb641-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows #(<span class="kw">=</span> (<span class="kw">get</span> <span class="va">%</span> <span class="st">"carrier"</span>) <span class="st">"AA"</span>))</span>
<span id="cb641-3"><a href="#cb641-3" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="st">"origin"</span>])</span>
<span id="cb641-4"><a href="#cb641-4" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate {<span class="at">:N</span> tc/row-count}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>origin</th>
<th style="text-align: right;">:N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>JFK</td>
<td style="text-align: right;">11923</td>
</tr>
<tr class="even">
<td>LGA</td>
<td style="text-align: right;">11730</td>
</tr>
<tr class="odd">
<td>EWR</td>
<td style="text-align: right;">2649</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="how-can-we-get-the-total-number-of-trips-for-each-origin-dest-pair-for-carrier-code-aa" class="level5">
<h5 class="anchored" data-anchor-id="how-can-we-get-the-total-number-of-trips-for-each-origin-dest-pair-for-carrier-code-aa">How can we get the total number of trips for each <code>origin</code>, <code>dest</code> pair for carrier code “AA”?</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb642"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb642-1"><a href="#cb642-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[carrier <span class="sc">==</span> <span class="st">"AA"</span>, .N, by <span class="ot">=</span> .(origin, dest)]</span>
<span id="cb642-2"><a href="#cb642-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(ans))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">origin</th>
<th style="text-align: left;">dest</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">3387</td>
</tr>
<tr class="even">
<td style="text-align: left;">LGA</td>
<td style="text-align: left;">PBI</td>
<td style="text-align: right;">245</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">62</td>
</tr>
<tr class="even">
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">MIA</td>
<td style="text-align: right;">1876</td>
</tr>
<tr class="odd">
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">SEA</td>
<td style="text-align: right;">298</td>
</tr>
<tr class="even">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">MIA</td>
<td style="text-align: right;">848</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb643"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb643-1"><a href="#cb643-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb643-2"><a href="#cb643-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows #(<span class="kw">=</span> (<span class="kw">get</span> <span class="va">%</span> <span class="st">"carrier"</span>) <span class="st">"AA"</span>))</span>
<span id="cb643-3"><a href="#cb643-3" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="st">"origin"</span> <span class="st">"dest"</span>])</span>
<span id="cb643-4"><a href="#cb643-4" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate {<span class="at">:N</span> tc/row-count})</span>
<span id="cb643-5"><a href="#cb643-5" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>origin</th>
<th>dest</th>
<th style="text-align: right;">:N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">3387</td>
</tr>
<tr class="even">
<td>LGA</td>
<td>PBI</td>
<td style="text-align: right;">245</td>
</tr>
<tr class="odd">
<td>EWR</td>
<td>LAX</td>
<td style="text-align: right;">62</td>
</tr>
<tr class="even">
<td>JFK</td>
<td>MIA</td>
<td style="text-align: right;">1876</td>
</tr>
<tr class="odd">
<td>JFK</td>
<td>SEA</td>
<td style="text-align: right;">298</td>
</tr>
<tr class="even">
<td>EWR</td>
<td>MIA</td>
<td style="text-align: right;">848</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="how-can-we-get-the-average-arrival-and-departure-delay-for-each-origdest-pair-for-each-month-for-carrier-code-aa" class="level5">
<h5 class="anchored" data-anchor-id="how-can-we-get-the-average-arrival-and-departure-delay-for-each-origdest-pair-for-each-month-for-carrier-code-aa">How can we get the average arrival and departure delay for each <code>orig</code>,<code>dest</code> pair for each month for carrier code “AA”?</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb644"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb644-1"><a href="#cb644-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[carrier <span class="sc">==</span> <span class="st">"AA"</span>,</span>
<span id="cb644-2"><a href="#cb644-2" aria-hidden="true" tabindex="-1"></a>.(<span class="fu">mean</span>(arr_delay), <span class="fu">mean</span>(dep_delay)),</span>
<span id="cb644-3"><a href="#cb644-3" aria-hidden="true" tabindex="-1"></a>by <span class="ot">=</span> .(origin, dest, month)]</span>
<span id="cb644-4"><a href="#cb644-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(ans,<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">origin</th>
<th style="text-align: left;">dest</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">V1</th>
<th style="text-align: right;">V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.590361</td>
<td style="text-align: right;">14.2289157</td>
</tr>
<tr class="even">
<td style="text-align: left;">LGA</td>
<td style="text-align: left;">PBI</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-7.758621</td>
<td style="text-align: right;">0.3103448</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.366667</td>
<td style="text-align: right;">7.5000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">MIA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15.720670</td>
<td style="text-align: right;">18.7430168</td>
</tr>
<tr class="odd">
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">SEA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14.357143</td>
<td style="text-align: right;">30.7500000</td>
</tr>
<tr class="even">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">MIA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11.011236</td>
<td style="text-align: right;">12.1235955</td>
</tr>
<tr class="odd">
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">SFO</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19.252252</td>
<td style="text-align: right;">28.6396396</td>
</tr>
<tr class="even">
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">BOS</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">12.919643</td>
<td style="text-align: right;">15.2142857</td>
</tr>
<tr class="odd">
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">ORD</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">31.586207</td>
<td style="text-align: right;">40.1724138</td>
</tr>
<tr class="even">
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">IAH</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">28.857143</td>
<td style="text-align: right;">14.2857143</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb645"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb645-1"><a href="#cb645-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb645-2"><a href="#cb645-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows #(<span class="kw">=</span> (<span class="kw">get</span> <span class="va">%</span> <span class="st">"carrier"</span>) <span class="st">"AA"</span>))</span>
<span id="cb645-3"><a href="#cb645-3" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="st">"origin"</span> <span class="st">"dest"</span> <span class="st">"month"</span>])</span>
<span id="cb645-4"><a href="#cb645-4" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate [#(dfn/mean (<span class="va">%</span> <span class="st">"arr_delay"</span>))</span>
<span id="cb645-5"><a href="#cb645-5" aria-hidden="true" tabindex="-1"></a>                   #(dfn/mean (<span class="va">%</span> <span class="st">"dep_delay"</span>))])</span>
<span id="cb645-6"><a href="#cb645-6" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [10 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th>origin</th>
<th>dest</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">:summary-0</th>
<th style="text-align: right;">:summary-1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.59036145</td>
<td style="text-align: right;">14.22891566</td>
</tr>
<tr class="even">
<td>LGA</td>
<td>PBI</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-7.75862069</td>
<td style="text-align: right;">0.31034483</td>
</tr>
<tr class="odd">
<td>EWR</td>
<td>LAX</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.36666667</td>
<td style="text-align: right;">7.50000000</td>
</tr>
<tr class="even">
<td>JFK</td>
<td>MIA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15.72067039</td>
<td style="text-align: right;">18.74301676</td>
</tr>
<tr class="odd">
<td>JFK</td>
<td>SEA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14.35714286</td>
<td style="text-align: right;">30.75000000</td>
</tr>
<tr class="even">
<td>EWR</td>
<td>MIA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11.01123596</td>
<td style="text-align: right;">12.12359551</td>
</tr>
<tr class="odd">
<td>JFK</td>
<td>SFO</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19.25225225</td>
<td style="text-align: right;">28.63963964</td>
</tr>
<tr class="even">
<td>JFK</td>
<td>BOS</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">12.91964286</td>
<td style="text-align: right;">15.21428571</td>
</tr>
<tr class="odd">
<td>JFK</td>
<td>ORD</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">31.58620690</td>
<td style="text-align: right;">40.17241379</td>
</tr>
<tr class="even">
<td>JFK</td>
<td>IAH</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">28.85714286</td>
<td style="text-align: right;">14.28571429</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="so-how-can-we-directly-order-by-all-the-grouping-variables" class="level5">
<h5 class="anchored" data-anchor-id="so-how-can-we-directly-order-by-all-the-grouping-variables">So how can we directly order by all the grouping variables?</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb646"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb646-1"><a href="#cb646-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[carrier <span class="sc">==</span> <span class="st">"AA"</span>,</span>
<span id="cb646-2"><a href="#cb646-2" aria-hidden="true" tabindex="-1"></a>.(<span class="fu">mean</span>(arr_delay), <span class="fu">mean</span>(dep_delay)),</span>
<span id="cb646-3"><a href="#cb646-3" aria-hidden="true" tabindex="-1"></a>keyby <span class="ot">=</span> .(origin, dest, month)]</span>
<span id="cb646-4"><a href="#cb646-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(ans,<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">origin</th>
<th style="text-align: left;">dest</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">V1</th>
<th style="text-align: right;">V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">DFW</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.427673</td>
<td style="text-align: right;">10.012579</td>
</tr>
<tr class="even">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">DFW</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">10.536765</td>
<td style="text-align: right;">11.345588</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">DFW</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">12.865031</td>
<td style="text-align: right;">8.079755</td>
</tr>
<tr class="even">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">DFW</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">17.792683</td>
<td style="text-align: right;">12.920732</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">DFW</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">18.487805</td>
<td style="text-align: right;">18.682927</td>
</tr>
<tr class="even">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">DFW</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">37.005952</td>
<td style="text-align: right;">38.744048</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">DFW</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">20.250000</td>
<td style="text-align: right;">21.154762</td>
</tr>
<tr class="even">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">DFW</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">16.936046</td>
<td style="text-align: right;">22.069767</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">DFW</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">5.865031</td>
<td style="text-align: right;">13.055215</td>
</tr>
<tr class="even">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">DFW</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">18.813665</td>
<td style="text-align: right;">18.894410</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb647"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb647-1"><a href="#cb647-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb647-2"><a href="#cb647-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows #(<span class="kw">=</span> (<span class="kw">get</span> <span class="va">%</span> <span class="st">"carrier"</span>) <span class="st">"AA"</span>))</span>
<span id="cb647-3"><a href="#cb647-3" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="st">"origin"</span> <span class="st">"dest"</span> <span class="st">"month"</span>])</span>
<span id="cb647-4"><a href="#cb647-4" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate [#(dfn/mean (<span class="va">%</span> <span class="st">"arr_delay"</span>))</span>
<span id="cb647-5"><a href="#cb647-5" aria-hidden="true" tabindex="-1"></a>                   #(dfn/mean (<span class="va">%</span> <span class="st">"dep_delay"</span>))])</span>
<span id="cb647-6"><a href="#cb647-6" aria-hidden="true" tabindex="-1"></a>    (tc/order-by [<span class="st">"origin"</span> <span class="st">"dest"</span> <span class="st">"month"</span>])</span>
<span id="cb647-7"><a href="#cb647-7" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [10 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th>origin</th>
<th>dest</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">:summary-0</th>
<th style="text-align: right;">:summary-1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>EWR</td>
<td>DFW</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.42767296</td>
<td style="text-align: right;">10.01257862</td>
</tr>
<tr class="even">
<td>EWR</td>
<td>DFW</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">10.53676471</td>
<td style="text-align: right;">11.34558824</td>
</tr>
<tr class="odd">
<td>EWR</td>
<td>DFW</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">12.86503067</td>
<td style="text-align: right;">8.07975460</td>
</tr>
<tr class="even">
<td>EWR</td>
<td>DFW</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">17.79268293</td>
<td style="text-align: right;">12.92073171</td>
</tr>
<tr class="odd">
<td>EWR</td>
<td>DFW</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">18.48780488</td>
<td style="text-align: right;">18.68292683</td>
</tr>
<tr class="even">
<td>EWR</td>
<td>DFW</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">37.00595238</td>
<td style="text-align: right;">38.74404762</td>
</tr>
<tr class="odd">
<td>EWR</td>
<td>DFW</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">20.25000000</td>
<td style="text-align: right;">21.15476190</td>
</tr>
<tr class="even">
<td>EWR</td>
<td>DFW</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">16.93604651</td>
<td style="text-align: right;">22.06976744</td>
</tr>
<tr class="odd">
<td>EWR</td>
<td>DFW</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">5.86503067</td>
<td style="text-align: right;">13.05521472</td>
</tr>
<tr class="even">
<td>EWR</td>
<td>DFW</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">18.81366460</td>
<td style="text-align: right;">18.89440994</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="can-by-accept-expressions-as-well-or-does-it-just-take-columns" class="level5">
<h5 class="anchored" data-anchor-id="can-by-accept-expressions-as-well-or-does-it-just-take-columns">Can <code>by</code> accept expressions as well or does it just take columns?</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb648"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb648-1"><a href="#cb648-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[, .N, .(dep_delay<span class="sc">&gt;</span><span class="dv">0</span>, arr_delay<span class="sc">&gt;</span><span class="dv">0</span>)]</span>
<span id="cb648-2"><a href="#cb648-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">dep_delay</th>
<th style="text-align: left;">arr_delay</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">72836</td>
</tr>
<tr class="even">
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">34583</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">119304</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">26593</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb649"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb649-1"><a href="#cb649-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb649-2"><a href="#cb649-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by (<span class="kw">fn</span> [row]</span>
<span id="cb649-3"><a href="#cb649-3" aria-hidden="true" tabindex="-1"></a>                   {<span class="at">:dep</span>_delay (<span class="kw">pos?</span> (<span class="kw">get</span> row <span class="st">"dep_delay"</span>))</span>
<span id="cb649-4"><a href="#cb649-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">:arr</span>_delay (<span class="kw">pos?</span> (<span class="kw">get</span> row <span class="st">"arr_delay"</span>))}))</span>
<span id="cb649-5"><a href="#cb649-5" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate {<span class="at">:N</span> tc/row-count}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:dep_delay</th>
<th>:arr_delay</th>
<th style="text-align: right;">:N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>true</td>
<td>true</td>
<td style="text-align: right;">72836</td>
</tr>
<tr class="even">
<td>false</td>
<td>true</td>
<td style="text-align: right;">34583</td>
</tr>
<tr class="odd">
<td>false</td>
<td>false</td>
<td style="text-align: right;">119304</td>
</tr>
<tr class="even">
<td>true</td>
<td>false</td>
<td style="text-align: right;">26593</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="do-we-have-to-compute-mean-for-each-column-individually" class="level5">
<h5 class="anchored" data-anchor-id="do-we-have-to-compute-mean-for-each-column-individually">Do we have to compute <code>mean()</code> for each column individually?</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb650"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb650-1"><a href="#cb650-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(DT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: right;">a</th>
<th style="text-align: right;">b</th>
<th style="text-align: right;">c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">c</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">18</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb651"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb651-1"><a href="#cb651-1" aria-hidden="true" tabindex="-1"></a>DT[, <span class="fu">print</span>(.SD), by <span class="ot">=</span> ID]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   a b  c
1: 1 7 13
2: 2 8 14
3: 3 9 15
   a  b  c
1: 4 10 16
2: 5 11 17
   a  b  c
1: 6 12 18</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Empty data.table (0 rows and 1 cols): ID</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb654"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb654-1"><a href="#cb654-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(DT[, <span class="fu">lapply</span>(.SD, mean), <span class="at">by =</span> ID])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: right;">a</th>
<th style="text-align: right;">b</th>
<th style="text-align: right;">c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">14.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">10.5</td>
<td style="text-align: right;">16.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">18.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb655"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb655-1"><a href="#cb655-1" aria-hidden="true" tabindex="-1"></a>DT</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:ID</th>
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td>b</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td>b</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td>a</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td>a</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td>c</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">18</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb656"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb656-1"><a href="#cb656-1" aria-hidden="true" tabindex="-1"></a>(tc/group-by DT <span class="at">:ID</span> {<span class="at">:result-type</span> <span class="at">:as-map</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>{</p><div style="margin-left:10%;width:110%;">
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>"b"</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: b [3 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">:ID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:a</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:b</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td>b</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td>b</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">15</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>"a"</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: a [2 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">:ID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:a</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:b</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="even">
<td>a</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">17</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>"c"</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: c [1 4]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">:ID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:a</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:b</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>c</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">18</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
</div><p>}</p></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb660"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb660-1"><a href="#cb660-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DT</span>
<span id="cb660-2"><a href="#cb660-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:ID</span>])</span>
<span id="cb660-3"><a href="#cb660-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate-columns (<span class="kw">complement</span> #{<span class="at">:ID</span>}) dfn/mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:ID</th>
<th style="text-align: right;">:a</th>
<th style="text-align: right;">:b</th>
<th style="text-align: right;">:c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>b</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">14.0</td>
</tr>
<tr class="even">
<td>a</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">10.5</td>
<td style="text-align: right;">16.5</td>
</tr>
<tr class="odd">
<td>c</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">18.0</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="how-can-we-specify-just-the-columns-we-would-like-to-compute-the-mean-on" class="level5">
<h5 class="anchored" data-anchor-id="how-can-we-specify-just-the-columns-we-would-like-to-compute-the-mean-on">How can we specify just the columns we would like to compute the <code>mean()</code> on?</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb661"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb661-1"><a href="#cb661-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(flights[carrier <span class="sc">==</span> <span class="st">"AA"</span>,                         <span class="do">## Only on trips with carrier "AA"</span></span>
<span id="cb661-2"><a href="#cb661-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(.SD, mean),                       <span class="do">## compute the mean</span></span>
<span id="cb661-3"><a href="#cb661-3" aria-hidden="true" tabindex="-1"></a><span class="at">by =</span> .(origin, dest, month),             <span class="do">## for every 'origin,dest,month'</span></span>
<span id="cb661-4"><a href="#cb661-4" aria-hidden="true" tabindex="-1"></a><span class="at">.SDcols =</span> <span class="fu">c</span>(<span class="st">"arr_delay"</span>, <span class="st">"dep_delay"</span>)])) <span class="do">## for just those specified in .SDcols</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">origin</th>
<th style="text-align: left;">dest</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">arr_delay</th>
<th style="text-align: right;">dep_delay</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.590361</td>
<td style="text-align: right;">14.2289157</td>
</tr>
<tr class="even">
<td style="text-align: left;">LGA</td>
<td style="text-align: left;">PBI</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-7.758621</td>
<td style="text-align: right;">0.3103448</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.366667</td>
<td style="text-align: right;">7.5000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">MIA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15.720670</td>
<td style="text-align: right;">18.7430168</td>
</tr>
<tr class="odd">
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">SEA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14.357143</td>
<td style="text-align: right;">30.7500000</td>
</tr>
<tr class="even">
<td style="text-align: left;">EWR</td>
<td style="text-align: left;">MIA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11.011236</td>
<td style="text-align: right;">12.1235955</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb662"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb662-1"><a href="#cb662-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb662-2"><a href="#cb662-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows #(<span class="kw">=</span> (<span class="kw">get</span> <span class="va">%</span> <span class="st">"carrier"</span>) <span class="st">"AA"</span>))</span>
<span id="cb662-3"><a href="#cb662-3" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="st">"origin"</span> <span class="st">"dest"</span> <span class="st">"month"</span>])</span>
<span id="cb662-4"><a href="#cb662-4" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate-columns [<span class="st">"arr_delay"</span> <span class="st">"dep_delay"</span>] dfn/mean)</span>
<span id="cb662-5"><a href="#cb662-5" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th>origin</th>
<th>dest</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">arr_delay</th>
<th style="text-align: right;">dep_delay</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.59036145</td>
<td style="text-align: right;">14.22891566</td>
</tr>
<tr class="even">
<td>LGA</td>
<td>PBI</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-7.75862069</td>
<td style="text-align: right;">0.31034483</td>
</tr>
<tr class="odd">
<td>EWR</td>
<td>LAX</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.36666667</td>
<td style="text-align: right;">7.50000000</td>
</tr>
<tr class="even">
<td>JFK</td>
<td>MIA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15.72067039</td>
<td style="text-align: right;">18.74301676</td>
</tr>
<tr class="odd">
<td>JFK</td>
<td>SEA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14.35714286</td>
<td style="text-align: right;">30.75000000</td>
</tr>
<tr class="even">
<td>EWR</td>
<td>MIA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11.01123596</td>
<td style="text-align: right;">12.12359551</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="how-can-we-return-the-first-two-rows-for-each-month" class="level5">
<h5 class="anchored" data-anchor-id="how-can-we-return-the-first-two-rows-for-each-month">How can we return the first two rows for each month?</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb663"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb663-1"><a href="#cb663-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> flights[, <span class="fu">head</span>(.SD, <span class="dv">2</span>), by <span class="ot">=</span> month]</span>
<span id="cb663-2"><a href="#cb663-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(ans))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">month</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">day</th>
<th style="text-align: right;">dep_delay</th>
<th style="text-align: right;">arr_delay</th>
<th style="text-align: left;">carrier</th>
<th style="text-align: left;">origin</th>
<th style="text-align: left;">dest</th>
<th style="text-align: right;">air_time</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">359</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-3</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">363</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">358</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-5</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">358</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-11</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">375</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-3</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">AA</td>
<td style="text-align: left;">JFK</td>
<td style="text-align: left;">LAX</td>
<td style="text-align: right;">368</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">11</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb664"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb664-1"><a href="#cb664-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> flights</span>
<span id="cb664-2"><a href="#cb664-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="st">"month"</span>])</span>
<span id="cb664-3"><a href="#cb664-3" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">2</span>) <span class="co">;; head applied on each group</span></span>
<span id="cb664-4"><a href="#cb664-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup)</span>
<span id="cb664-5"><a href="#cb664-5" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 11]:</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">month</th>
<th style="text-align: right;">day</th>
<th style="text-align: right;">dep_delay</th>
<th style="text-align: right;">arr_delay</th>
<th>carrier</th>
<th>origin</th>
<th>dest</th>
<th style="text-align: right;">air_time</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">13</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">359</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-3</td>
<td style="text-align: right;">13</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">363</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">358</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-5</td>
<td style="text-align: right;">3</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">358</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-11</td>
<td style="text-align: right;">36</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">375</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-3</td>
<td style="text-align: right;">14</td>
<td>AA</td>
<td>JFK</td>
<td>LAX</td>
<td style="text-align: right;">368</td>
<td style="text-align: right;">2475</td>
<td style="text-align: right;">11</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="how-can-we-concatenate-columns-a-and-b-for-each-group-in-id" class="level5">
<h5 class="anchored" data-anchor-id="how-can-we-concatenate-columns-a-and-b-for-each-group-in-id">How can we concatenate columns a and b for each group in ID?</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb665"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb665-1"><a href="#cb665-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(DT[, .(<span class="at">val =</span> <span class="fu">c</span>(a,b)), <span class="at">by =</span> ID])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: right;">val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">c</td>
<td style="text-align: right;">12</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb666"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb666-1"><a href="#cb666-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DT</span>
<span id="cb666-2"><a href="#cb666-2" aria-hidden="true" tabindex="-1"></a>    (tc/pivot-&gt;longer [<span class="at">:a</span> <span class="at">:b</span>] {<span class="at">:value-column-name</span> <span class="at">:val</span>})</span>
<span id="cb666-3"><a href="#cb666-3" aria-hidden="true" tabindex="-1"></a>    (tc/drop-columns [:$column <span class="at">:c</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [12 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:ID</th>
<th style="text-align: right;">:val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>b</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>b</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td>b</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td>a</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td>a</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>c</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td>b</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td>b</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td>b</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td>a</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td>a</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td>c</td>
<td style="text-align: right;">12</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="what-if-we-would-like-to-have-all-the-values-of-column-a-and-b-concatenated-but-returned-as-a-list-column" class="level5">
<h5 class="anchored" data-anchor-id="what-if-we-would-like-to-have-all-the-values-of-column-a-and-b-concatenated-but-returned-as-a-list-column">What if we would like to have all the values of column <code>a</code> and <code>b</code> concatenated, but returned as a list column?</h5>
<p>R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb667"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb667-1"><a href="#cb667-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(DT[, .(<span class="at">val =</span> <span class="fu">list</span>(<span class="fu">c</span>(a,b))), <span class="at">by =</span> ID])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: left;">1, 2, 3, 7, 8, 9</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: left;">4, 5, 10, 11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c</td>
<td style="text-align: left;">6, 12</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Clojure</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb668"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb668-1"><a href="#cb668-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DT</span>
<span id="cb668-2"><a href="#cb668-2" aria-hidden="true" tabindex="-1"></a>    (tc/pivot-&gt;longer [<span class="at">:a</span> <span class="at">:b</span>] {<span class="at">:value-column-name</span> <span class="at">:val</span>})</span>
<span id="cb668-3"><a href="#cb668-3" aria-hidden="true" tabindex="-1"></a>    (tc/drop-columns [:$column <span class="at">:c</span>])</span>
<span id="cb668-4"><a href="#cb668-4" aria-hidden="true" tabindex="-1"></a>    (tc/fold-by <span class="at">:ID</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:ID</th>
<th>:val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>b</td>
<td>[1 2 3 7 8 9]</td>
</tr>
<tr class="even">
<td>a</td>
<td>[4 5 10 11]</td>
</tr>
<tr class="odd">
<td>c</td>
<td>[6 12]</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ### API tour

           Below snippets are taken from [A data.table and dplyr tour](https://atrebas.github.io/post/2019-03-03-datatable-dplyr/) written by Atrebas (permission granted).

           I keep structure and subtitles but I skip `data.table` and `dplyr` examples.

           Example data
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb670"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb670-1"><a href="#cb670-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/dataset {<span class="at">:V1</span> (<span class="kw">take</span> <span class="dv">9</span> (<span class="kw">cycle</span> [<span class="dv">1</span> <span class="dv">2</span>]))</span>
<span id="cb670-2"><a href="#cb670-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:V2</span> (<span class="kw">range</span> <span class="dv">1</span> <span class="dv">10</span>)</span>
<span id="cb670-3"><a href="#cb670-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:V3</span> (<span class="kw">take</span> <span class="dv">9</span> (<span class="kw">cycle</span> [<span class="fl">0.5</span> <span class="fl">1.0</span> <span class="fl">1.5</span>]))</span>
<span id="cb670-4"><a href="#cb670-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:V4</span> (<span class="kw">take</span> <span class="dv">9</span> (<span class="kw">cycle</span> [<span class="st">"A"</span> <span class="st">"B"</span> <span class="st">"C"</span>]))}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb671"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb671-1"><a href="#cb671-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset? DS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb672"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb672-1"><a href="#cb672-1" aria-hidden="true" tabindex="-1"></a><span class="va">true</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb673"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb673-1"><a href="#cb673-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">class</span> DS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb674"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb674-1"><a href="#cb674-1" aria-hidden="true" tabindex="-1"></a>tech.v3.dataset.impl.dataset.Dataset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb675"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb675-1"><a href="#cb675-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           #### Basic Operations

           ##### Filter rows

           Filter rows using indices
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb677"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb677-1"><a href="#cb677-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows DS [<span class="dv">2</span> <span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Discard rows using negative indices

           In Clojure API we have separate function for that: `drop-rows`.
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb679"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb679-1"><a href="#cb679-1" aria-hidden="true" tabindex="-1"></a>(tc/drop-rows DS (<span class="kw">range</span> <span class="dv">2</span> <span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Filter rows using a logical expression
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb681"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb681-1"><a href="#cb681-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows DS (<span class="kw">comp</span> #(<span class="kw">&gt;</span> <span class="va">%</span> <span class="dv">5</span>) <span class="at">:V2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb682"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb682-1"><a href="#cb682-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows DS (<span class="kw">comp</span> #{<span class="st">"A"</span> <span class="st">"C"</span>} <span class="at">:V4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Filter rows using multiple conditions
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb684"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb684-1"><a href="#cb684-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows DS #(<span class="kw">and</span> (<span class="kw">=</span> (<span class="at">:V1</span> <span class="va">%</span>) <span class="dv">1</span>)</span>
<span id="cb684-2"><a href="#cb684-2" aria-hidden="true" tabindex="-1"></a>                          (<span class="kw">=</span> (<span class="at">:V4</span> <span class="va">%</span>) <span class="st">"A"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Filter unique rows
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb686"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb686-1"><a href="#cb686-1" aria-hidden="true" tabindex="-1"></a>(tc/unique-by DS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb687"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb687-1"><a href="#cb687-1" aria-hidden="true" tabindex="-1"></a>(tc/unique-by DS [<span class="at">:V1</span> <span class="at">:V4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Discard rows with missing values
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb689"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb689-1"><a href="#cb689-1" aria-hidden="true" tabindex="-1"></a>(tc/drop-missing DS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Other filters
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb691"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb691-1"><a href="#cb691-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb691-2"><a href="#cb691-2" aria-hidden="true" tabindex="-1"></a>(tc/random DS <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<p>3 random rows</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb692"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb692-1"><a href="#cb692-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb692-2"><a href="#cb692-2" aria-hidden="true" tabindex="-1"></a>(tc/random DS (<span class="kw">/</span> (tc/row-count DS) <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<p>fraction of random rows</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb693"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb693-1"><a href="#cb693-1" aria-hidden="true" tabindex="-1"></a>(tc/by-rank DS <span class="at">:V1</span> <span class="kw">zero?</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<p>take top n entries</p>
<pre><code>           ---

           Convenience functions
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb695"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb695-1"><a href="#cb695-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows DS (<span class="kw">comp</span> (<span class="kw">partial</span> <span class="kw">re-matches</span> <span class="ss">#"^B"</span>) <span class="kw">str</span> <span class="at">:V4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb696"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb696-1"><a href="#cb696-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows DS (<span class="kw">comp</span> #(<span class="kw">&lt;=</span> <span class="dv">3</span> <span class="va">%</span> <span class="dv">5</span>) <span class="at">:V2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb697"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb697-1"><a href="#cb697-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows DS (<span class="kw">comp</span> #(<span class="kw">&lt;</span> <span class="dv">3</span> <span class="va">%</span> <span class="dv">5</span>) <span class="at">:V2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb698"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb698-1"><a href="#cb698-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows DS (<span class="kw">comp</span> #(<span class="kw">&lt;=</span> <span class="dv">3</span> <span class="va">%</span> <span class="dv">5</span>) <span class="at">:V2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           Last example skipped.

           ##### Sort rows

           Sort rows by column
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb700"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb700-1"><a href="#cb700-1" aria-hidden="true" tabindex="-1"></a>(tc/order-by DS <span class="at">:V3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Sort rows in decreasing order
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb702"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb702-1"><a href="#cb702-1" aria-hidden="true" tabindex="-1"></a>(tc/order-by DS <span class="at">:V3</span> <span class="at">:desc</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Sort rows based on several columns
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb704"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb704-1"><a href="#cb704-1" aria-hidden="true" tabindex="-1"></a>(tc/order-by DS [<span class="at">:V1</span> <span class="at">:V2</span>] [<span class="at">:asc</span> <span class="at">:desc</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ##### Select columns

           Select one column using an index (not recommended)
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb706"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb706-1"><a href="#cb706-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">nth</span> (tc/columns DS <span class="at">:as-seq</span>) <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb707"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb707-1"><a href="#cb707-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;float64&amp;gt;[9]</span></span>
<span id="cb707-2"><a href="#cb707-2" aria-hidden="true" tabindex="-1"></a><span class="at">:V3</span></span>
<span id="cb707-3"><a href="#cb707-3" aria-hidden="true" tabindex="-1"></a>[<span class="fl">0.5000</span>, <span class="fl">1.000</span>, <span class="fl">1.500</span>, <span class="fl">0.5000</span>, <span class="fl">1.000</span>, <span class="fl">1.500</span>, <span class="fl">0.5000</span>, <span class="fl">1.000</span>, <span class="fl">1.500</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>as column (iterable)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb708"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb708-1"><a href="#cb708-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset [(<span class="kw">nth</span> (tc/columns DS <span class="at">:as-seq</span>) <span class="dv">2</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.5</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Select one column using column name
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb710"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb710-1"><a href="#cb710-1" aria-hidden="true" tabindex="-1"></a>(tc/select-columns DS <span class="at">:V2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<p>as dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb711"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb711-1"><a href="#cb711-1" aria-hidden="true" tabindex="-1"></a>(tc/select-columns DS [<span class="at">:V2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<p>as dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb712"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb712-1"><a href="#cb712-1" aria-hidden="true" tabindex="-1"></a>(DS <span class="at">:V2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb713"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb713-1"><a href="#cb713-1" aria-hidden="true" tabindex="-1"></a>#tech.v3.dataset.column&amp;lt<span class="co">;int64&amp;gt;[9]</span></span>
<span id="cb713-2"><a href="#cb713-2" aria-hidden="true" tabindex="-1"></a><span class="at">:V2</span></span>
<span id="cb713-3"><a href="#cb713-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>as column (iterable)</p>
<pre><code>           ---

           Select several columns
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb715"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb715-1"><a href="#cb715-1" aria-hidden="true" tabindex="-1"></a>(tc/select-columns DS [<span class="at">:V2</span> <span class="at">:V3</span> <span class="at">:V4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Exclude columns
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb717"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb717-1"><a href="#cb717-1" aria-hidden="true" tabindex="-1"></a>(tc/select-columns DS (<span class="kw">complement</span> #{<span class="at">:V2</span> <span class="at">:V3</span> <span class="at">:V4</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb718"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb718-1"><a href="#cb718-1" aria-hidden="true" tabindex="-1"></a>(tc/drop-columns DS [<span class="at">:V2</span> <span class="at">:V3</span> <span class="at">:V4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Other seletions
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb720"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb720-1"><a href="#cb720-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;&gt;</span> (<span class="kw">range</span> <span class="dv">1</span> <span class="dv">3</span>)</span>
<span id="cb720-2"><a href="#cb720-2" aria-hidden="true" tabindex="-1"></a>     (<span class="kw">map</span> (<span class="kw">comp</span> <span class="kw">keyword</span> (<span class="kw">partial</span> <span class="kw">format</span> <span class="st">"V%d"</span>)))</span>
<span id="cb720-3"><a href="#cb720-3" aria-hidden="true" tabindex="-1"></a>     (tc/select-columns DS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb721"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb721-1"><a href="#cb721-1" aria-hidden="true" tabindex="-1"></a>(tc/reorder-columns DS <span class="at">:V4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb722"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb722-1"><a href="#cb722-1" aria-hidden="true" tabindex="-1"></a>(tc/select-columns DS #(clojure.string/starts-with? (<span class="kw">name</span> <span class="va">%</span>) <span class="st">"V"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb723"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb723-1"><a href="#cb723-1" aria-hidden="true" tabindex="-1"></a>(tc/select-columns DS #(clojure.string/ends-with? (<span class="kw">name</span> <span class="va">%</span>) <span class="st">"3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.5</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb724"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb724-1"><a href="#cb724-1" aria-hidden="true" tabindex="-1"></a>(tc/select-columns DS <span class="ss">#"..2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<p>regex converts to string using <code>str</code> function</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb725"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb725-1"><a href="#cb725-1" aria-hidden="true" tabindex="-1"></a>(tc/select-columns DS #{<span class="at">:V1</span> <span class="st">"X"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb726"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb726-1"><a href="#cb726-1" aria-hidden="true" tabindex="-1"></a>(tc/select-columns DS #(<span class="kw">not</span> (clojure.string/starts-with? (<span class="kw">name</span> <span class="va">%</span>) <span class="st">"V2"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ##### Summarise data

           Summarise one column
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb728"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb728-1"><a href="#cb728-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">reduce</span> <span class="kw">+</span> (DS <span class="at">:V1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb729"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb729-1"><a href="#cb729-1" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>using pure Clojure, as value</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb730"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb730-1"><a href="#cb730-1" aria-hidden="true" tabindex="-1"></a>(tc/aggregate-columns DS <span class="at">:V1</span> dfn/sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13.0</td>
</tr>
</tbody>
</table>
</div>
<p>as dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb731"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb731-1"><a href="#cb731-1" aria-hidden="true" tabindex="-1"></a>(tc/aggregate DS {<span class="at">:sumV1</span> #(dfn/sum (<span class="va">%</span> <span class="at">:V1</span>))})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:sumV1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13.0</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Summarize several columns
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb733"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb733-1"><a href="#cb733-1" aria-hidden="true" tabindex="-1"></a>(tc/aggregate DS [#(dfn/sum (<span class="va">%</span> <span class="at">:V1</span>))</span>
<span id="cb733-2"><a href="#cb733-2" aria-hidden="true" tabindex="-1"></a>                   #(dfn/standard-deviation (<span class="va">%</span> <span class="at">:V3</span>))])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:summary-0</th>
<th style="text-align: right;">:summary-1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13.0</td>
<td style="text-align: right;">0.4330127</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb734"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb734-1"><a href="#cb734-1" aria-hidden="true" tabindex="-1"></a>(tc/aggregate-columns DS [<span class="at">:V1</span> <span class="at">:V3</span>] [dfn/sum</span>
<span id="cb734-2"><a href="#cb734-2" aria-hidden="true" tabindex="-1"></a>                                     dfn/standard-deviation])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13.0</td>
<td style="text-align: right;">0.4330127</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Summarise several columns and assign column names
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb736"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb736-1"><a href="#cb736-1" aria-hidden="true" tabindex="-1"></a>(tc/aggregate DS {<span class="at">:sumv1</span> #(dfn/sum (<span class="va">%</span> <span class="at">:V1</span>))</span>
<span id="cb736-2"><a href="#cb736-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">:sdv3</span> #(dfn/standard-deviation (<span class="va">%</span> <span class="at">:V3</span>))})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:sumv1</th>
<th style="text-align: right;">:sdv3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13.0</td>
<td style="text-align: right;">0.4330127</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Summarise a subset of rows
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb738"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb738-1"><a href="#cb738-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb738-2"><a href="#cb738-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows (<span class="kw">range</span> <span class="dv">4</span>))</span>
<span id="cb738-3"><a href="#cb738-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate-columns <span class="at">:V1</span> dfn/sum))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">6.0</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ##### Additional helpers</code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb740"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb740-1"><a href="#cb740-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb740-2"><a href="#cb740-2" aria-hidden="true" tabindex="-1"></a>    (tc/first)</span>
<span id="cb740-3"><a href="#cb740-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns <span class="at">:V3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
</tr>
</tbody>
</table>
</div>
<p>select first row from <code>:V3</code> column</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb741"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb741-1"><a href="#cb741-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb741-2"><a href="#cb741-2" aria-hidden="true" tabindex="-1"></a>    (tc/last)</span>
<span id="cb741-3"><a href="#cb741-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns <span class="at">:V3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.5</td>
</tr>
</tbody>
</table>
</div>
<p>select last row from <code>:V3</code> column</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb742"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb742-1"><a href="#cb742-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb742-2"><a href="#cb742-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows <span class="dv">4</span>)</span>
<span id="cb742-3"><a href="#cb742-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns <span class="at">:V3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
</tr>
</tbody>
</table>
</div>
<p>select forth row from <code>:V3</code> column</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb743"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb743-1"><a href="#cb743-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb743-2"><a href="#cb743-2" aria-hidden="true" tabindex="-1"></a>    (tc/select <span class="at">:V3</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
</tr>
</tbody>
</table>
</div>
<p>select forth row from <code>:V3</code> column</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb744"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb744-1"><a href="#cb744-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb744-2"><a href="#cb744-2" aria-hidden="true" tabindex="-1"></a>    (tc/unique-by <span class="at">:V4</span>)</span>
<span id="cb744-3"><a href="#cb744-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate tc/row-count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<p>number of unique rows in <code>:V4</code> column, as dataset</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb745"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb745-1"><a href="#cb745-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb745-2"><a href="#cb745-2" aria-hidden="true" tabindex="-1"></a>    (tc/unique-by <span class="at">:V4</span>)</span>
<span id="cb745-3"><a href="#cb745-3" aria-hidden="true" tabindex="-1"></a>    (tc/row-count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb746"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb746-1"><a href="#cb746-1" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>number of unique rows in <code>:V4</code> column, as value</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb747"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb747-1"><a href="#cb747-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb747-2"><a href="#cb747-2" aria-hidden="true" tabindex="-1"></a>    (tc/unique-by)</span>
<span id="cb747-3"><a href="#cb747-3" aria-hidden="true" tabindex="-1"></a>    (tc/row-count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb748"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb748-1"><a href="#cb748-1" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>number of unique rows in dataset, as value</p>
<pre><code>           ##### Add/update/delete columns

           Modify a column
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb750"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb750-1"><a href="#cb750-1" aria-hidden="true" tabindex="-1"></a>(tc/map-columns DS <span class="at">:V1</span> [<span class="at">:V1</span>] #(dfn/pow <span class="va">%</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb751"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb751-1"><a href="#cb751-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/add-column DS <span class="at">:V1</span> (dfn/pow (DS <span class="at">:V1</span>) <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb752"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb752-1"><a href="#cb752-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Add one column
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb754"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb754-1"><a href="#cb754-1" aria-hidden="true" tabindex="-1"></a>(tc/map-columns DS <span class="at">:v5</span> [<span class="at">:V1</span>] dfn/log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th style="text-align: right;">:v5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">0.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">1.38629436</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">0.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">1.38629436</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">0.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">1.38629436</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">0.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">1.38629436</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">0.00000000</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb755"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb755-1"><a href="#cb755-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/add-column DS <span class="at">:v5</span> (dfn/log (DS <span class="at">:V1</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb756"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb756-1"><a href="#cb756-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th style="text-align: right;">:v5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">0.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">1.38629436</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">0.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">1.38629436</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">0.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">1.38629436</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">0.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">1.38629436</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">0.00000000</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Add several columns
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb758"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb758-1"><a href="#cb758-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/add-columns DS {<span class="at">:v6</span> (dfn/sqrt (DS <span class="at">:V1</span>))</span>
<span id="cb758-2"><a href="#cb758-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">:v7</span> <span class="st">"X"</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb759"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb759-1"><a href="#cb759-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 7]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th style="text-align: right;">:v5</th>
<th style="text-align: right;">:v6</th>
<th>:v7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;">1.0</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">1.38629436</td>
<td style="text-align: right;">2.0</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;">1.0</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">1.38629436</td>
<td style="text-align: right;">2.0</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;">1.0</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">1.38629436</td>
<td style="text-align: right;">2.0</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;">1.0</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">1.38629436</td>
<td style="text-align: right;">2.0</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;">1.0</td>
<td>X</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Create one column and remove the others
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb761"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb761-1"><a href="#cb761-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset {<span class="at">:v8</span> (dfn/+ (DS <span class="at">:V3</span>) <span class="dv">1</span>)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:v8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.5</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Remove one column
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb763"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb763-1"><a href="#cb763-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/drop-columns DS <span class="at">:v5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb764"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb764-1"><a href="#cb764-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 6]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
<th style="text-align: right;">:v6</th>
<th>:v7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">1.0</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">2.0</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">1.0</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">2.0</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">1.0</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">2.0</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
<td style="text-align: right;">1.0</td>
<td>X</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
<td style="text-align: right;">2.0</td>
<td>X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
<td style="text-align: right;">1.0</td>
<td>X</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Remove several columns
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb766"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb766-1"><a href="#cb766-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/drop-columns DS [<span class="at">:v6</span> <span class="at">:v7</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb767"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb767-1"><a href="#cb767-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th style="text-align: right;">:V3</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.5</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Remove columns using a vector of colnames

           We use set here.
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb769"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb769-1"><a href="#cb769-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/select-columns DS (<span class="kw">complement</span> #{<span class="at">:V3</span>})))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb770"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb770-1"><a href="#cb770-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">2</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">3</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">5</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">6</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Replace values for rows matching a condition
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb772"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb772-1"><a href="#cb772-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/map-columns DS <span class="at">:V2</span> [<span class="at">:V2</span>] #(<span class="kw">if</span> (<span class="kw">&lt;</span> <span class="va">%</span> <span class="fl">4.0</span>) <span class="fl">0.0</span> <span class="va">%</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb773"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb773-1"><a href="#cb773-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4.0</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">5.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">6.0</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">7.0</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9.0</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ##### by

           By group
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb775"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb775-1"><a href="#cb775-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb775-2"><a href="#cb775-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span>])</span>
<span id="cb775-3"><a href="#cb775-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate {<span class="at">:sumV2</span> #(dfn/sum (<span class="va">%</span> <span class="at">:V2</span>))}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:sumV2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">11.0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">13.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">15.0</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           By several groups
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb777"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb777-1"><a href="#cb777-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb777-2"><a href="#cb777-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span> <span class="at">:V1</span>])</span>
<span id="cb777-3"><a href="#cb777-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate {<span class="at">:sumV2</span> #(dfn/sum (<span class="va">%</span> <span class="at">:V2</span>))}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:sumV2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">7.0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9.0</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4.0</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">6.0</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Calling function in by
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb779"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb779-1"><a href="#cb779-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb779-2"><a href="#cb779-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by (<span class="kw">fn</span> [row]</span>
<span id="cb779-3"><a href="#cb779-3" aria-hidden="true" tabindex="-1"></a>                    (clojure.string/lower-case (<span class="at">:V4</span> row))))</span>
<span id="cb779-4"><a href="#cb779-4" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate {<span class="at">:sumV1</span> #(dfn/sum (<span class="va">%</span> <span class="at">:V1</span>))}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:$group-name</th>
<th style="text-align: right;">:sumV1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a</td>
<td style="text-align: right;">6.0</td>
</tr>
<tr class="even">
<td>b</td>
<td style="text-align: right;">9.0</td>
</tr>
<tr class="odd">
<td>c</td>
<td style="text-align: right;">6.0</td>
</tr>
</tbody>
</table>
</div>
<pre><code>           ---

           Assigning column name in by
           </code></pre>
<div class="sourceClojure">
<div class="sourceCode" id="cb781"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb781-1"><a href="#cb781-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb781-2"><a href="#cb781-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by (<span class="kw">fn</span> [row]</span>
<span id="cb781-3"><a href="#cb781-3" aria-hidden="true" tabindex="-1"></a>                    {<span class="at">:abc</span> (clojure.string/lower-case (<span class="at">:V4</span> row))}))</span>
<span id="cb781-4"><a href="#cb781-4" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate {<span class="at">:sumV1</span> #(dfn/sum (<span class="va">%</span> <span class="at">:V1</span>))}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:abc</th>
<th style="text-align: right;">:sumV1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a</td>
<td style="text-align: right;">6.0</td>
</tr>
<tr class="even">
<td>b</td>
<td style="text-align: right;">9.0</td>
</tr>
<tr class="odd">
<td>c</td>
<td style="text-align: right;">6.0</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb782"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb782-1"><a href="#cb782-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb782-2"><a href="#cb782-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by (<span class="kw">fn</span> [row]</span>
<span id="cb782-3"><a href="#cb782-3" aria-hidden="true" tabindex="-1"></a>                    (clojure.string/lower-case (<span class="at">:V4</span> row))))</span>
<span id="cb782-4"><a href="#cb782-4" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate {<span class="at">:sumV1</span> #(dfn/sum (<span class="va">%</span> <span class="at">:V1</span>))} {<span class="at">:add-group-as-column</span> <span class="at">:abc</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:$group-name</th>
<th style="text-align: right;">:sumV1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a</td>
<td style="text-align: right;">6.0</td>
</tr>
<tr class="even">
<td>b</td>
<td style="text-align: right;">9.0</td>
</tr>
<tr class="odd">
<td>c</td>
<td style="text-align: right;">6.0</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Using a condition in by</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb783"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb783-1"><a href="#cb783-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb783-2"><a href="#cb783-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by #(<span class="kw">=</span> (<span class="at">:V4</span> <span class="va">%</span>) <span class="st">"A"</span>))</span>
<span id="cb783-3"><a href="#cb783-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate #(dfn/sum (<span class="va">%</span> <span class="at">:V1</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:$group-name</th>
<th style="text-align: right;">summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>true</td>
<td style="text-align: right;">6.0</td>
</tr>
<tr class="even">
<td>false</td>
<td style="text-align: right;">15.0</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>By on a subset of rows</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb784"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb784-1"><a href="#cb784-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb784-2"><a href="#cb784-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows (<span class="kw">range</span> <span class="dv">5</span>))</span>
<span id="cb784-3"><a href="#cb784-3" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb784-4"><a href="#cb784-4" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate {<span class="at">:sumV1</span> #(dfn/sum (<span class="va">%</span> <span class="at">:V1</span>))}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:$group-name</th>
<th style="text-align: right;">:sumV1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1.0</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Count number of observations for each group</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb785"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb785-1"><a href="#cb785-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb785-2"><a href="#cb785-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb785-3"><a href="#cb785-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate tc/row-count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:$group-name</th>
<th style="text-align: right;">summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Add a column with number of observations for each group</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb786"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb786-1"><a href="#cb786-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb786-2"><a href="#cb786-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V1</span>])</span>
<span id="cb786-3"><a href="#cb786-3" aria-hidden="true" tabindex="-1"></a>    (tc/add-column <span class="at">:n</span> tc/row-count)</span>
<span id="cb786-4"><a href="#cb786-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
<th style="text-align: right;">:n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
<td>A</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
<td>C</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">5.0</td>
<td>B</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">7.0</td>
<td>A</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9.0</td>
<td>C</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4.0</td>
<td>A</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">6.0</td>
<td>C</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8.0</td>
<td>B</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Retrieve the first/last/nth observation for each group</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb787"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb787-1"><a href="#cb787-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb787-2"><a href="#cb787-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span>])</span>
<span id="cb787-3"><a href="#cb787-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate-columns <span class="at">:V2</span> <span class="kw">first</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">0.0</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb788"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb788-1"><a href="#cb788-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb788-2"><a href="#cb788-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span>])</span>
<span id="cb788-3"><a href="#cb788-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate-columns <span class="at">:V2</span> <span class="kw">last</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">7.0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">8.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">9.0</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb789"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb789-1"><a href="#cb789-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb789-2"><a href="#cb789-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span>])</span>
<span id="cb789-3"><a href="#cb789-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate-columns <span class="at">:V2</span> #(<span class="kw">nth</span> <span class="va">%</span> <span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">4.0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">6.0</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="going-further" class="level4">
<h4 class="anchored" data-anchor-id="going-further">Going further</h4>
<section id="advanced-columns-manipulation" class="level5">
<h5 class="anchored" data-anchor-id="advanced-columns-manipulation">Advanced columns manipulation</h5>
<p>Summarise all the columns</p>
<p>custom max function which works on every type</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb790"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb790-1"><a href="#cb790-1" aria-hidden="true" tabindex="-1"></a>(tc/aggregate-columns DS <span class="at">:all</span> (<span class="kw">fn</span> [col] (<span class="kw">first</span> (<span class="kw">sort</span> #(<span class="kw">compare</span> <span class="va">%2</span> <span class="va">%1</span>) col))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">9.0</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Summarise several columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb791"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb791-1"><a href="#cb791-1" aria-hidden="true" tabindex="-1"></a>(tc/aggregate-columns DS [<span class="at">:V1</span> <span class="at">:V2</span>] dfn/mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2.33333333</td>
<td style="text-align: right;">4.33333333</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Summarise several columns by group</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb792"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb792-1"><a href="#cb792-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb792-2"><a href="#cb792-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span>])</span>
<span id="cb792-3"><a href="#cb792-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate-columns [<span class="at">:V1</span> <span class="at">:V2</span>] dfn/mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">3.66666667</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.33333333</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">5.00000000</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Summarise with more than one function by group</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb793"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb793-1"><a href="#cb793-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb793-2"><a href="#cb793-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span>])</span>
<span id="cb793-3"><a href="#cb793-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate-columns [<span class="at">:V1</span> <span class="at">:V2</span>] (<span class="kw">fn</span> [col]</span>
<span id="cb793-4"><a href="#cb793-4" aria-hidden="true" tabindex="-1"></a>                                       {<span class="at">:sum</span> (dfn/sum col)</span>
<span id="cb793-5"><a href="#cb793-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">:mean</span> (dfn/mean col)})))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1-sum</th>
<th style="text-align: right;">:V1-mean</th>
<th style="text-align: right;">:V2-sum</th>
<th style="text-align: right;">:V2-mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">3.66666667</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">13.0</td>
<td style="text-align: right;">4.33333333</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">5.00000000</td>
</tr>
</tbody>
</table>
</div>
<p>Summarise using a condition</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb794"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb794-1"><a href="#cb794-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb794-2"><a href="#cb794-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns <span class="at">:type/numerical</span>)</span>
<span id="cb794-3"><a href="#cb794-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate-columns <span class="at">:all</span> dfn/mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2.33333333</td>
<td style="text-align: right;">4.33333333</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Modify all the columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb795"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb795-1"><a href="#cb795-1" aria-hidden="true" tabindex="-1"></a>(tc/update-columns DS <span class="at">:all</span> <span class="kw">reverse</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9.0</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">7.0</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">6.0</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">5.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4.0</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Modify several columns (dropping the others)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb796"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb796-1"><a href="#cb796-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb796-2"><a href="#cb796-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns [<span class="at">:V1</span> <span class="at">:V2</span>])</span>
<span id="cb796-3"><a href="#cb796-3" aria-hidden="true" tabindex="-1"></a>    (tc/update-columns <span class="at">:all</span> dfn/sqrt))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">0.00000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2.00000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2.23606798</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2.44948974</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2.64575131</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2.82842712</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">3.00000000</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb797"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb797-1"><a href="#cb797-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb797-2"><a href="#cb797-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns (<span class="kw">complement</span> #{<span class="at">:V4</span>}))</span>
<span id="cb797-3"><a href="#cb797-3" aria-hidden="true" tabindex="-1"></a>    (tc/update-columns <span class="at">:all</span> dfn/exp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2.71828183</td>
<td style="text-align: right;">1.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">54.59815003</td>
<td style="text-align: right;">1.00000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.71828183</td>
<td style="text-align: right;">1.00000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">54.59815003</td>
<td style="text-align: right;">54.59815003</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.71828183</td>
<td style="text-align: right;">148.41315910</td>
</tr>
<tr class="even">
<td style="text-align: right;">54.59815003</td>
<td style="text-align: right;">403.42879349</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.71828183</td>
<td style="text-align: right;">1096.63315843</td>
</tr>
<tr class="even">
<td style="text-align: right;">54.59815003</td>
<td style="text-align: right;">2980.95798704</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.71828183</td>
<td style="text-align: right;">8103.08392758</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Modify several columns (keeping the others)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb798"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb798-1"><a href="#cb798-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/update-columns DS [<span class="at">:V1</span> <span class="at">:V2</span>] dfn/sqrt))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb799"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb799-1"><a href="#cb799-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.00000000</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">0.00000000</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.00000000</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2.00000000</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2.23606798</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2.44948974</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2.64575131</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2.82842712</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">3.00000000</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb800"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb800-1"><a href="#cb800-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/update-columns DS (<span class="kw">complement</span> #{<span class="at">:V4</span>}) #(dfn/pow <span class="va">%</span> <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb801"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb801-1"><a href="#cb801-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">0.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4.0</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">5.0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">6.0</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">7.0</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">8.0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9.0</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Modify columns using a condition (dropping the others)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb802"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb802-1"><a href="#cb802-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb802-2"><a href="#cb802-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns <span class="at">:type/numerical</span>)</span>
<span id="cb802-3"><a href="#cb802-3" aria-hidden="true" tabindex="-1"></a>    (tc/update-columns <span class="at">:all</span> #(dfn/- <span class="va">%</span> <span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">-1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">-1.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">-1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">6.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">7.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">8.0</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Modify columns using a condition (keeping the others)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb803"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb803-1"><a href="#cb803-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/convert-types DS <span class="at">:type/numerical</span> <span class="at">:int32</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb804"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb804-1"><a href="#cb804-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Use a complex expression</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb805"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb805-1"><a href="#cb805-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb805-2"><a href="#cb805-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span>])</span>
<span id="cb805-3"><a href="#cb805-3" aria-hidden="true" tabindex="-1"></a>    (tc/head <span class="dv">2</span>)</span>
<span id="cb805-4"><a href="#cb805-4" aria-hidden="true" tabindex="-1"></a>    (tc/add-column <span class="at">:V2</span> <span class="st">"X"</span>)</span>
<span id="cb805-5"><a href="#cb805-5" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th>:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>X</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>X</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td>X</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>X</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>X</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>X</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Use multiple expressions</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb806"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb806-1"><a href="#cb806-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset (<span class="kw">let</span> [x (dfn/+ (DS <span class="at">:V1</span>) (dfn/sum (DS <span class="at">:V2</span>)))]</span>
<span id="cb806-2"><a href="#cb806-2" aria-hidden="true" tabindex="-1"></a>              {<span class="at">:A</span> (<span class="kw">range</span> <span class="dv">1</span> (<span class="kw">inc</span> (tc/row-count DS)))</span>
<span id="cb806-3"><a href="#cb806-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">:B</span> x}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:A</th>
<th style="text-align: right;">:B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">39.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">42.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">39.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">42.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">39.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">42.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">39.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">42.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">39.0</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="chain-expressions" class="level5">
<h5 class="anchored" data-anchor-id="chain-expressions">Chain expressions</h5>
<p>Expression chaining using &gt;</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb807"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb807-1"><a href="#cb807-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb807-2"><a href="#cb807-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span>])</span>
<span id="cb807-3"><a href="#cb807-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate {<span class="at">:V1sum</span> #(dfn/sum (<span class="va">%</span> <span class="at">:V1</span>))})</span>
<span id="cb807-4"><a href="#cb807-4" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows #(<span class="kw">&gt;=</span> (<span class="at">:V1sum</span> <span class="va">%</span>) <span class="dv">5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">6.0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">9.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">6.0</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb808"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb808-1"><a href="#cb808-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb808-2"><a href="#cb808-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span>])</span>
<span id="cb808-3"><a href="#cb808-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate {<span class="at">:V1sum</span> #(dfn/sum (<span class="va">%</span> <span class="at">:V1</span>))})</span>
<span id="cb808-4"><a href="#cb808-4" aria-hidden="true" tabindex="-1"></a>    (tc/order-by <span class="at">:V1sum</span> <span class="at">:desc</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">9.0</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">6.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">6.0</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="indexing-and-keys" class="level5">
<h5 class="anchored" data-anchor-id="indexing-and-keys">Indexing and Keys</h5>
<p>Set the key/index (order)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb809"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb809-1"><a href="#cb809-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/order-by DS <span class="at">:V4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb810"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb810-1"><a href="#cb810-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<p>Select the matching rows</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb811"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb811-1"><a href="#cb811-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows DS #(<span class="kw">=</span> (<span class="at">:V4</span> <span class="va">%</span>) <span class="st">"A"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb812"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb812-1"><a href="#cb812-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows DS (<span class="kw">comp</span> #{<span class="st">"A"</span> <span class="st">"C"</span>} <span class="at">:V4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Select the first matching row</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb813"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb813-1"><a href="#cb813-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb813-2"><a href="#cb813-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows #(<span class="kw">=</span> (<span class="at">:V4</span> <span class="va">%</span>) <span class="st">"B"</span>))</span>
<span id="cb813-3"><a href="#cb813-3" aria-hidden="true" tabindex="-1"></a>    (tc/first))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td>B</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb814"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb814-1"><a href="#cb814-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb814-2"><a href="#cb814-2" aria-hidden="true" tabindex="-1"></a>    (tc/unique-by <span class="at">:V4</span>)</span>
<span id="cb814-3"><a href="#cb814-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows (<span class="kw">comp</span> #{<span class="st">"B"</span> <span class="st">"C"</span>} <span class="at">:V4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Select the last matching row</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb815"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb815-1"><a href="#cb815-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb815-2"><a href="#cb815-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows #(<span class="kw">=</span> (<span class="at">:V4</span> <span class="va">%</span>) <span class="st">"A"</span>))</span>
<span id="cb815-3"><a href="#cb815-3" aria-hidden="true" tabindex="-1"></a>    (tc/last))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Nomatch argument</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb816"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb816-1"><a href="#cb816-1" aria-hidden="true" tabindex="-1"></a>(tc/select-rows DS (<span class="kw">comp</span> #{<span class="st">"A"</span> <span class="st">"D"</span>} <span class="at">:V4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Apply a function on the matching rows</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb817"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb817-1"><a href="#cb817-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb817-2"><a href="#cb817-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows (<span class="kw">comp</span> #{<span class="st">"A"</span> <span class="st">"C"</span>} <span class="at">:V4</span>))</span>
<span id="cb817-3"><a href="#cb817-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate-columns <span class="at">:V1</span> (<span class="kw">fn</span> [col]</span>
<span id="cb817-4"><a href="#cb817-4" aria-hidden="true" tabindex="-1"></a>                                 {<span class="at">:sum</span> (dfn/sum col)})))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1-sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">12.0</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Modify values for matching rows</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb818"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb818-1"><a href="#cb818-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(<span class="kw">-&gt;</span> DS</span>
<span id="cb818-2"><a href="#cb818-2" aria-hidden="true" tabindex="-1"></a>            (tc/map-columns <span class="at">:V1</span> [<span class="at">:V1</span> <span class="at">:V4</span>] #(<span class="kw">if</span> (<span class="kw">=</span> <span class="va">%2</span> <span class="st">"A"</span>) <span class="dv">0</span> <span class="va">%1</span>))</span>
<span id="cb818-3"><a href="#cb818-3" aria-hidden="true" tabindex="-1"></a>            (tc/order-by <span class="at">:V4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb819"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb819-1"><a href="#cb819-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Use keys in by</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb820"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb820-1"><a href="#cb820-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb820-2"><a href="#cb820-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows (<span class="kw">comp</span> (<span class="kw">complement</span> #{<span class="st">"B"</span>}) <span class="at">:V4</span>))</span>
<span id="cb820-3"><a href="#cb820-3" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span>])</span>
<span id="cb820-4"><a href="#cb820-4" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate-columns <span class="at">:V1</span> dfn/sum))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">6.0</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Set keys/indices for multiple columns (ordered)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb821"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb821-1"><a href="#cb821-1" aria-hidden="true" tabindex="-1"></a>(tc/order-by DS [<span class="at">:V4</span> <span class="at">:V1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Subset using multiple keys/indices</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb822"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb822-1"><a href="#cb822-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb822-2"><a href="#cb822-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows #(<span class="kw">and</span> (<span class="kw">=</span> (<span class="at">:V1</span> <span class="va">%</span>) <span class="dv">1</span>)</span>
<span id="cb822-3"><a href="#cb822-3" aria-hidden="true" tabindex="-1"></a>                           (<span class="kw">=</span> (<span class="at">:V4</span> <span class="va">%</span>) <span class="st">"C"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb823"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb823-1"><a href="#cb823-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb823-2"><a href="#cb823-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows #(<span class="kw">and</span> (<span class="kw">=</span> (<span class="at">:V1</span> <span class="va">%</span>) <span class="dv">1</span>)</span>
<span id="cb823-3"><a href="#cb823-3" aria-hidden="true" tabindex="-1"></a>                           (#{<span class="st">"B"</span> <span class="st">"C"</span>} (<span class="at">:V4</span> <span class="va">%</span>)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb824"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb824-1"><a href="#cb824-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb824-2"><a href="#cb824-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows #(<span class="kw">and</span> (<span class="kw">=</span> (<span class="at">:V1</span> <span class="va">%</span>) <span class="dv">1</span>)</span>
<span id="cb824-3"><a href="#cb824-3" aria-hidden="true" tabindex="-1"></a>                           (#{<span class="st">"B"</span> <span class="st">"C"</span>} (<span class="at">:V4</span> <span class="va">%</span>))) {<span class="at">:result-type</span> <span class="at">:as-indexes</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb825"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb825-1"><a href="#cb825-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">4</span> <span class="dv">6</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="set-modifications" class="level5">
<h5 class="anchored" data-anchor-id="set-modifications">set*() modifications</h5>
<p>Replace values</p>
<p>There is no mutating operations <code>tech.ml.dataset</code> or easy way to set value.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb826"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb826-1"><a href="#cb826-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/update-columns DS <span class="at">:V2</span> #(map-indexed (<span class="kw">fn</span> [idx v]</span>
<span id="cb826-2"><a href="#cb826-2" aria-hidden="true" tabindex="-1"></a>                                                   (<span class="kw">if</span> (<span class="kw">zero?</span> idx) <span class="dv">3</span> v)) <span class="va">%</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb827"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb827-1"><a href="#cb827-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Reorder rows</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb828"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb828-1"><a href="#cb828-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/order-by DS [<span class="at">:V4</span> <span class="at">:V1</span>] [<span class="at">:asc</span> <span class="at">:desc</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb829"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb829-1"><a href="#cb829-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Modify colnames</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb830"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb830-1"><a href="#cb830-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/rename-columns DS {<span class="at">:V2</span> <span class="st">"v2"</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb831"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb831-1"><a href="#cb831-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">v2</th>
<th>:V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td>A</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td>A</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
<td>B</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td>B</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td>C</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td>C</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb832"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb832-1"><a href="#cb832-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/rename-columns DS {<span class="st">"v2"</span> <span class="at">:V2</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>revert back</p>
<hr>
<p>Reorder columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb833"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb833-1"><a href="#cb833-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> DS </span>(tc/reorder-columns DS <span class="at">:V4</span> <span class="at">:V1</span> <span class="at">:V2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb834"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb834-1"><a href="#cb834-1" aria-hidden="true" tabindex="-1"></a>DS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="advanced-use-of-by" class="level5">
<h5 class="anchored" data-anchor-id="advanced-use-of-by">Advanced use of by</h5>
<p>Select first/last/… row by group</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb835"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb835-1"><a href="#cb835-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb835-2"><a href="#cb835-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb835-3"><a href="#cb835-3" aria-hidden="true" tabindex="-1"></a>    (tc/first)</span>
<span id="cb835-4"><a href="#cb835-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb836"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb836-1"><a href="#cb836-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb836-2"><a href="#cb836-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb836-3"><a href="#cb836-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows [<span class="dv">0</span> <span class="dv">2</span>])</span>
<span id="cb836-4"><a href="#cb836-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb837"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb837-1"><a href="#cb837-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb837-2"><a href="#cb837-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb837-3"><a href="#cb837-3" aria-hidden="true" tabindex="-1"></a>    (tc/tail <span class="dv">2</span>)</span>
<span id="cb837-4"><a href="#cb837-4" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Select rows using a nested query</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb838"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb838-1"><a href="#cb838-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb838-2"><a href="#cb838-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb838-3"><a href="#cb838-3" aria-hidden="true" tabindex="-1"></a>    (tc/order-by <span class="at">:V2</span>)</span>
<span id="cb838-4"><a href="#cb838-4" aria-hidden="true" tabindex="-1"></a>    (tc/first)</span>
<span id="cb838-5"><a href="#cb838-5" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<p>Add a group counter column</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb839"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb839-1"><a href="#cb839-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb839-2"><a href="#cb839-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="at">:V4</span> <span class="at">:V1</span>])</span>
<span id="cb839-3"><a href="#cb839-3" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup {<span class="at">:add-group-id-as-column</span> <span class="at">:Grp</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:Grp</th>
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>B</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>C</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Get row number of first (and last) observation by group</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb840"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb840-1"><a href="#cb840-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb840-2"><a href="#cb840-2" aria-hidden="true" tabindex="-1"></a>    (tc/add-column <span class="at">:row-id</span> (<span class="kw">range</span>))</span>
<span id="cb840-3"><a href="#cb840-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns [<span class="at">:V4</span> <span class="at">:row-id</span>])</span>
<span id="cb840-4"><a href="#cb840-4" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb840-5"><a href="#cb840-5" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:row-id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb841"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb841-1"><a href="#cb841-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb841-2"><a href="#cb841-2" aria-hidden="true" tabindex="-1"></a>    (tc/add-column <span class="at">:row-id</span> (<span class="kw">range</span>))</span>
<span id="cb841-3"><a href="#cb841-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns [<span class="at">:V4</span> <span class="at">:row-id</span>])</span>
<span id="cb841-4"><a href="#cb841-4" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb841-5"><a href="#cb841-5" aria-hidden="true" tabindex="-1"></a>    (tc/first)</span>
<span id="cb841-6"><a href="#cb841-6" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:row-id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb842"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb842-1"><a href="#cb842-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb842-2"><a href="#cb842-2" aria-hidden="true" tabindex="-1"></a>    (tc/add-column <span class="at">:row-id</span> (<span class="kw">range</span>))</span>
<span id="cb842-3"><a href="#cb842-3" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns [<span class="at">:V4</span> <span class="at">:row-id</span>])</span>
<span id="cb842-4"><a href="#cb842-4" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb842-5"><a href="#cb842-5" aria-hidden="true" tabindex="-1"></a>    (tc/select-rows [<span class="dv">0</span> <span class="dv">2</span>])</span>
<span id="cb842-6"><a href="#cb842-6" aria-hidden="true" tabindex="-1"></a>    (tc/ungroup))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:row-id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Handle list-columns by group</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb843"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb843-1"><a href="#cb843-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb843-2"><a href="#cb843-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns [<span class="at">:V1</span> <span class="at">:V4</span>])</span>
<span id="cb843-3"><a href="#cb843-3" aria-hidden="true" tabindex="-1"></a>    (tc/fold-by <span class="at">:V4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th>:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>[0 0 0]</td>
</tr>
<tr class="even">
<td>B</td>
<td>[4 4 1]</td>
</tr>
<tr class="odd">
<td>C</td>
<td>[4 1 1]</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb844"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb844-1"><a href="#cb844-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> DS</span>
<span id="cb844-2"><a href="#cb844-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by <span class="at">:V4</span>)</span>
<span id="cb844-3"><a href="#cb844-3" aria-hidden="true" tabindex="-1"></a>    (tc/unmark-group))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:name</th>
<th style="text-align: right;">:group-id</th>
<th>:data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td>Group: A [3 3]:</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">1</td>
<td>Group: B [3 3]:</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">2</td>
<td>Group: C [3 3]:</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Grouping sets (multiple by at once)</p>
<p>Not available.</p>
</section>
</section>
<section id="miscellaneous" class="level4">
<h4 class="anchored" data-anchor-id="miscellaneous">Miscellaneous</h4>
<section id="read-write-data" class="level5">
<h5 class="anchored" data-anchor-id="read-write-data">Read / Write data</h5>
<p>Write data to a csv file</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb845"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb845-1"><a href="#cb845-1" aria-hidden="true" tabindex="-1"></a>(tc/write! DS <span class="st">"DF.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb846"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb846-1"><a href="#cb846-1" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Write data to a tab-delimited file</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb847"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb847-1"><a href="#cb847-1" aria-hidden="true" tabindex="-1"></a>(tc/write! DS <span class="st">"DF.txt"</span> {<span class="at">:separator</span> <span class="ch">\tab</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb848"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb848-1"><a href="#cb848-1" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb849"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb849-1"><a href="#cb849-1" aria-hidden="true" tabindex="-1"></a>(tc/write! DS <span class="st">"DF.tsv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb850"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb850-1"><a href="#cb850-1" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Read a csv / tab-delimited file</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb851"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb851-1"><a href="#cb851-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset <span class="st">"DF.csv"</span> {<span class="at">:key-fn</span> <span class="kw">keyword</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>DF.csv [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb852"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb852-1"><a href="#cb852-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb852-2"><a href="#cb852-2" aria-hidden="true" tabindex="-1"></a>(tc/dataset <span class="st">"DF.txt"</span> {<span class="at">:key-fn</span> <span class="kw">keyword</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>DF.txt [9 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4 V1 V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A 0 3</td>
</tr>
<tr class="even">
<td>A 0 4</td>
</tr>
<tr class="odd">
<td>A 0 7</td>
</tr>
<tr class="even">
<td>B 4 0</td>
</tr>
<tr class="odd">
<td>B 4 8</td>
</tr>
<tr class="even">
<td>B 1 5</td>
</tr>
<tr class="odd">
<td>C 4 5</td>
</tr>
<tr class="even">
<td>C 1 0</td>
</tr>
<tr class="odd">
<td>C 1 9</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb853"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb853-1"><a href="#cb853-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset <span class="st">"DF.tsv"</span> {<span class="at">:key-fn</span> <span class="kw">keyword</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>DF.tsv [9 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Read a csv file selecting / droping columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb854"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb854-1"><a href="#cb854-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset <span class="st">"DF.csv"</span> {<span class="at">:key-fn</span> <span class="kw">keyword</span></span>
<span id="cb854-2"><a href="#cb854-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:column-whitelist</span> [<span class="st">"V1"</span> <span class="st">"V4"</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>DF.csv [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb855"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb855-1"><a href="#cb855-1" aria-hidden="true" tabindex="-1"></a>(tc/dataset <span class="st">"DF.csv"</span> {<span class="at">:key-fn</span> <span class="kw">keyword</span></span>
<span id="cb855-2"><a href="#cb855-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">:column-blacklist</span> [<span class="st">"V4"</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>DF.csv [9 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Read and rbind several files</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb856"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb856-1"><a href="#cb856-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">apply</span> tc/concat (<span class="kw">map</span> tc/dataset [<span class="st">"DF.csv"</span> <span class="st">"DF.csv"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>DF.csv [18 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>V4</th>
<th style="text-align: right;">V1</th>
<th style="text-align: right;">V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="reshape-data" class="level5">
<h5 class="anchored" data-anchor-id="reshape-data">Reshape data</h5>
<p>Melt data (from wide to long)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb857"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb857-1"><a href="#cb857-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> mDS </span>(tc/pivot-&gt;longer DS [<span class="at">:V1</span> <span class="at">:V2</span>] {<span class="at">:target-columns</span> <span class="at">:variable</span></span>
<span id="cb857-2"><a href="#cb857-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">:value-column-name</span> <span class="at">:value</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb858"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb858-1"><a href="#cb858-1" aria-hidden="true" tabindex="-1"></a>mDS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [18 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th>:variable</th>
<th style="text-align: right;">:value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>:V1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>A</td>
<td>:V1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td>A</td>
<td>:V1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>B</td>
<td>:V1</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td>B</td>
<td>:V1</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td>B</td>
<td>:V1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td>C</td>
<td>:V1</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td>C</td>
<td>:V1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td>C</td>
<td>:V1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>A</td>
<td>:V2</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td>A</td>
<td>:V2</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td>A</td>
<td>:V2</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td>B</td>
<td>:V2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>B</td>
<td>:V2</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td>B</td>
<td>:V2</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>C</td>
<td>:V2</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td>C</td>
<td>:V2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>C</td>
<td>:V2</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Cast data (from long to wide)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb859"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb859-1"><a href="#cb859-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> mDS</span>
<span id="cb859-2"><a href="#cb859-2" aria-hidden="true" tabindex="-1"></a>    (tc/pivot-&gt;wider <span class="at">:variable</span> <span class="at">:value</span> {<span class="at">:fold-fn</span> <span class="kw">vec</span>})</span>
<span id="cb859-3"><a href="#cb859-3" aria-hidden="true" tabindex="-1"></a>    (tc/update-columns [<span class="st">"V1"</span> <span class="st">"V2"</span>] (<span class="kw">partial</span> <span class="kw">map</span> <span class="kw">count</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th>:V1</th>
<th>:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>[0 0 0]</td>
<td>[3 4 7]</td>
</tr>
<tr class="even">
<td>B</td>
<td>[4 4 1]</td>
<td>[0 8 5]</td>
</tr>
<tr class="odd">
<td>C</td>
<td>[4 1 1]</td>
<td>[5 0 9]</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb860"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb860-1"><a href="#cb860-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> mDS</span>
<span id="cb860-2"><a href="#cb860-2" aria-hidden="true" tabindex="-1"></a>    (tc/pivot-&gt;wider <span class="at">:variable</span> <span class="at">:value</span> {<span class="at">:fold-fn</span> <span class="kw">vec</span>})</span>
<span id="cb860-3"><a href="#cb860-3" aria-hidden="true" tabindex="-1"></a>    (tc/update-columns [<span class="st">"V1"</span> <span class="st">"V2"</span>] (<span class="kw">partial</span> <span class="kw">map</span> dfn/sum)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th>:V1</th>
<th>:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>[0 0 0]</td>
<td>[3 4 7]</td>
</tr>
<tr class="even">
<td>B</td>
<td>[4 4 1]</td>
<td>[0 8 5]</td>
</tr>
<tr class="odd">
<td>C</td>
<td>[4 1 1]</td>
<td>[5 0 9]</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb861"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb861-1"><a href="#cb861-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:note-to-test/skip</span></span>
<span id="cb861-2"><a href="#cb861-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> mDS</span>
<span id="cb861-3"><a href="#cb861-3" aria-hidden="true" tabindex="-1"></a>    (tc/map-columns <span class="at">:value</span> #(<span class="kw">str</span> (<span class="kw">&gt;</span> <span class="va">%</span> <span class="dv">5</span>))) <span class="co">;; coerce to strings</span></span>
<span id="cb861-4"><a href="#cb861-4" aria-hidden="true" tabindex="-1"></a>    (tc/pivot-&gt;wider <span class="at">:value</span> <span class="at">:variable</span> {<span class="at">:fold-fn</span> <span class="kw">vec</span>})</span>
<span id="cb861-5"><a href="#cb861-5" aria-hidden="true" tabindex="-1"></a>    (tc/update-columns [<span class="st">"true"</span> <span class="st">"false"</span>] (<span class="kw">partial</span> <span class="kw">map</span> #(<span class="kw">if</span> (<span class="kw">sequential?</span> <span class="va">%</span>) (<span class="kw">count</span> <span class="va">%</span>) <span class="dv">1</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V4</th>
<th style="text-align: right;">false</th>
<th style="text-align: right;">true</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Split</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb862"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb862-1"><a href="#cb862-1" aria-hidden="true" tabindex="-1"></a>(tc/group-by DS <span class="at">:V4</span> {<span class="at">:result-type</span> <span class="at">:as-map</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div><p>{</p><div style="margin-left:10%;width:110%;">
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>"A"</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: A [3 3]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">:V4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>"B"</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: B [3 3]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">:V4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
<table data-quarto-postprocess="true" class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td data-valign="top"><div>
<pre class="sourceCode language-clojure printed-clojure code-with-copy"><code>"C"</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
</div></td>
<td><div style="margin-left:10px;">
<div class="clay-dataset">
<p>Group: C [3 3]:</p>
<table class="table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">:V4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
</div></td>
</tr>
</tbody>
</table>
</div><p>}</p></div>
</div>
<hr>
<p>Split and transpose a vector/column</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb866"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb866-1"><a href="#cb866-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> {<span class="at">:a</span> [<span class="st">"A:a"</span> <span class="st">"B:b"</span> <span class="st">"C:c"</span>]}</span>
<span id="cb866-2"><a href="#cb866-2" aria-hidden="true" tabindex="-1"></a>    (tc/dataset)</span>
<span id="cb866-3"><a href="#cb866-3" aria-hidden="true" tabindex="-1"></a>    (tc/separate-column <span class="at">:a</span> [<span class="at">:V1</span> <span class="at">:V2</span>] <span class="st">":"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V1</th>
<th>:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>a</td>
</tr>
<tr class="even">
<td>B</td>
<td>b</td>
</tr>
<tr class="odd">
<td>C</td>
<td>c</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="other-1" class="level5">
<h5 class="anchored" data-anchor-id="other-1">Other</h5>
<p>Skipped</p>
</section>
</section>
<section id="joinbind-data-sets" class="level4">
<h4 class="anchored" data-anchor-id="joinbind-data-sets">Join/Bind data sets</h4>
<div class="sourceClojure">
<div class="sourceCode" id="cb867"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb867-1"><a href="#cb867-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> x </span>(tc/dataset {<span class="st">"Id"</span> [<span class="st">"A"</span> <span class="st">"B"</span> <span class="st">"C"</span> <span class="st">"C"</span>]</span>
<span id="cb867-2"><a href="#cb867-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"X1"</span> [<span class="dv">1</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span>]</span>
<span id="cb867-3"><a href="#cb867-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"XY"</span> [<span class="st">"x2"</span> <span class="st">"x4"</span> <span class="st">"x6"</span> <span class="st">"x8"</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb868"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb868-1"><a href="#cb868-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> y </span>(tc/dataset {<span class="st">"Id"</span> [<span class="st">"A"</span> <span class="st">"B"</span> <span class="st">"B"</span> <span class="st">"D"</span>]</span>
<span id="cb868-2"><a href="#cb868-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Y1"</span> [<span class="dv">1</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span>]</span>
<span id="cb868-3"><a href="#cb868-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"XY"</span> [<span class="st">"y1"</span> <span class="st">"y3"</span> <span class="st">"y5"</span> <span class="st">"y7"</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb869"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb869-1"><a href="#cb869-1" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>Id</th>
<th style="text-align: right;">X1</th>
<th>XY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td>x2</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">3</td>
<td>x4</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">5</td>
<td>x6</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">7</td>
<td>x8</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb870"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb870-1"><a href="#cb870-1" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>Id</th>
<th style="text-align: right;">Y1</th>
<th>XY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td>y1</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">3</td>
<td>y3</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">5</td>
<td>y5</td>
</tr>
<tr class="even">
<td>D</td>
<td style="text-align: right;">7</td>
<td>y7</td>
</tr>
</tbody>
</table>
</div>
<section id="join-1" class="level5">
<h5 class="anchored" data-anchor-id="join-1">Join</h5>
<p>Join matching rows from y to x</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb871"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb871-1"><a href="#cb871-1" aria-hidden="true" tabindex="-1"></a>(tc/left-join x y <span class="st">"Id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>left-outer-join [5 6]:</p>
<table class="table">
<thead>
<tr class="header">
<th>Id</th>
<th style="text-align: right;">X1</th>
<th>XY</th>
<th>right.Id</th>
<th style="text-align: right;">Y1</th>
<th>right.XY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td>x2</td>
<td>A</td>
<td style="text-align: right;">1</td>
<td>y1</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">3</td>
<td>x4</td>
<td>B</td>
<td style="text-align: right;">3</td>
<td>y3</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">3</td>
<td>x4</td>
<td>B</td>
<td style="text-align: right;">5</td>
<td>y5</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">5</td>
<td>x6</td>
<td></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">7</td>
<td>x8</td>
<td></td>
<td style="text-align: right;"></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Join matching rows from x to y</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb872"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb872-1"><a href="#cb872-1" aria-hidden="true" tabindex="-1"></a>(tc/right-join x y <span class="st">"Id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>right-outer-join [4 6]:</p>
<table class="table">
<thead>
<tr class="header">
<th>Id</th>
<th style="text-align: right;">X1</th>
<th>XY</th>
<th>right.Id</th>
<th style="text-align: right;">Y1</th>
<th>right.XY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td>x2</td>
<td>A</td>
<td style="text-align: right;">1</td>
<td>y1</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">3</td>
<td>x4</td>
<td>B</td>
<td style="text-align: right;">3</td>
<td>y3</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">3</td>
<td>x4</td>
<td>B</td>
<td style="text-align: right;">5</td>
<td>y5</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
<td></td>
<td>D</td>
<td style="text-align: right;">7</td>
<td>y7</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Join matching rows from both x and y</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb873"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb873-1"><a href="#cb873-1" aria-hidden="true" tabindex="-1"></a>(tc/inner-join x y <span class="st">"Id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>inner-join [3 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th>Id</th>
<th style="text-align: right;">X1</th>
<th>XY</th>
<th style="text-align: right;">Y1</th>
<th>right.XY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td>x2</td>
<td style="text-align: right;">1</td>
<td>y1</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">3</td>
<td>x4</td>
<td style="text-align: right;">3</td>
<td>y3</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">3</td>
<td>x4</td>
<td style="text-align: right;">5</td>
<td>y5</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Join keeping all the rows</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb874"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb874-1"><a href="#cb874-1" aria-hidden="true" tabindex="-1"></a>(tc/full-join x y <span class="st">"Id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>outer-join [6 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th>Id</th>
<th style="text-align: right;">X1</th>
<th>XY</th>
<th style="text-align: right;">Y1</th>
<th>right.XY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td>x2</td>
<td style="text-align: right;">1</td>
<td>y1</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">3</td>
<td>x4</td>
<td style="text-align: right;">3</td>
<td>y3</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">3</td>
<td>x4</td>
<td style="text-align: right;">5</td>
<td>y5</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">5</td>
<td>x6</td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">7</td>
<td>x8</td>
<td style="text-align: right;"></td>
<td></td>
</tr>
<tr class="even">
<td>D</td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;">7</td>
<td>y7</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Return rows from x matching y</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb875"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb875-1"><a href="#cb875-1" aria-hidden="true" tabindex="-1"></a>(tc/semi-join x y <span class="st">"Id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>Id</th>
<th style="text-align: right;">X1</th>
<th>XY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td>x2</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">3</td>
<td>x4</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Return rows from x not matching y</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb876"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb876-1"><a href="#cb876-1" aria-hidden="true" tabindex="-1"></a>(tc/anti-join x y <span class="st">"Id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [2 3]:</p>
<table class="table">
<thead>
<tr class="header">
<th>Id</th>
<th style="text-align: right;">X1</th>
<th>XY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">5</td>
<td>x6</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">7</td>
<td>x8</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="more-joins" class="level5">
<h5 class="anchored" data-anchor-id="more-joins">More joins</h5>
<p>Select columns while joining</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb877"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb877-1"><a href="#cb877-1" aria-hidden="true" tabindex="-1"></a>(tc/right-join (tc/select-columns x [<span class="st">"Id"</span> <span class="st">"X1"</span>])</span>
<span id="cb877-2"><a href="#cb877-2" aria-hidden="true" tabindex="-1"></a>                (tc/select-columns y [<span class="st">"Id"</span> <span class="st">"XY"</span>])</span>
<span id="cb877-3"><a href="#cb877-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>right-outer-join [4 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>Id</th>
<th style="text-align: right;">X1</th>
<th>right.Id</th>
<th>XY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td>A</td>
<td>y1</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">3</td>
<td>B</td>
<td>y3</td>
</tr>
<tr class="odd">
<td>B</td>
<td style="text-align: right;">3</td>
<td>B</td>
<td>y5</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
<td>D</td>
<td>y7</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb878"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb878-1"><a href="#cb878-1" aria-hidden="true" tabindex="-1"></a>(tc/right-join (tc/select-columns x [<span class="st">"Id"</span> <span class="st">"XY"</span>])</span>
<span id="cb878-2"><a href="#cb878-2" aria-hidden="true" tabindex="-1"></a>                (tc/select-columns y [<span class="st">"Id"</span> <span class="st">"XY"</span>])</span>
<span id="cb878-3"><a href="#cb878-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>right-outer-join [4 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th>Id</th>
<th>XY</th>
<th>right.Id</th>
<th>right.XY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>x2</td>
<td>A</td>
<td>y1</td>
</tr>
<tr class="even">
<td>B</td>
<td>x4</td>
<td>B</td>
<td>y3</td>
</tr>
<tr class="odd">
<td>B</td>
<td>x4</td>
<td>B</td>
<td>y5</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>D</td>
<td>y7</td>
</tr>
</tbody>
</table>
</div>
<p>Aggregate columns while joining</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb879"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb879-1"><a href="#cb879-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> y</span>
<span id="cb879-2"><a href="#cb879-2" aria-hidden="true" tabindex="-1"></a>    (tc/group-by [<span class="st">"Id"</span>])</span>
<span id="cb879-3"><a href="#cb879-3" aria-hidden="true" tabindex="-1"></a>    (tc/aggregate {<span class="st">"sumY1"</span> #(dfn/sum (<span class="va">%</span> <span class="st">"Y1"</span>))})</span>
<span id="cb879-4"><a href="#cb879-4" aria-hidden="true" tabindex="-1"></a>    (tc/right-join x <span class="st">"Id"</span>)</span>
<span id="cb879-5"><a href="#cb879-5" aria-hidden="true" tabindex="-1"></a>    (tc/add-column <span class="st">"X1Y1"</span> (<span class="kw">fn</span> [ds] (dfn/* (ds <span class="st">"sumY1"</span>)</span>
<span id="cb879-6"><a href="#cb879-6" aria-hidden="true" tabindex="-1"></a>                                                    (ds <span class="st">"X1"</span>))))</span>
<span id="cb879-7"><a href="#cb879-7" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns [<span class="st">"right.Id"</span> <span class="st">"X1Y1"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>right-outer-join [4 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>right.Id</th>
<th style="text-align: right;">X1Y1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">24.0</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
<p>Update columns while joining</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb880"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb880-1"><a href="#cb880-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> x</span>
<span id="cb880-2"><a href="#cb880-2" aria-hidden="true" tabindex="-1"></a>    (tc/select-columns [<span class="st">"Id"</span> <span class="st">"X1"</span>])</span>
<span id="cb880-3"><a href="#cb880-3" aria-hidden="true" tabindex="-1"></a>    (tc/map-columns <span class="st">"SqX1"</span> <span class="st">"X1"</span> (<span class="kw">fn</span> [x] (<span class="kw">*</span> x x)))</span>
<span id="cb880-4"><a href="#cb880-4" aria-hidden="true" tabindex="-1"></a>    (tc/right-join y <span class="st">"Id"</span>)</span>
<span id="cb880-5"><a href="#cb880-5" aria-hidden="true" tabindex="-1"></a>    (tc/drop-columns [<span class="st">"X1"</span> <span class="st">"Id"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>right-outer-join [4 4]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">SqX1</th>
<th>right.Id</th>
<th style="text-align: right;">Y1</th>
<th>XY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>A</td>
<td style="text-align: right;">1</td>
<td>y1</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td>B</td>
<td style="text-align: right;">3</td>
<td>y3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td>B</td>
<td style="text-align: right;">5</td>
<td>y5</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>D</td>
<td style="text-align: right;">7</td>
<td>y7</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Adds a list column with rows from y matching x (nest-join)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb881"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb881-1"><a href="#cb881-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (tc/left-join x y <span class="st">"Id"</span>)</span>
<span id="cb881-2"><a href="#cb881-2" aria-hidden="true" tabindex="-1"></a>    (tc/drop-columns [<span class="st">"right.Id"</span>])</span>
<span id="cb881-3"><a href="#cb881-3" aria-hidden="true" tabindex="-1"></a>    (tc/fold-by (tc/column-names x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 5]:</p>
<table class="table">
<thead>
<tr class="header">
<th>Id</th>
<th style="text-align: right;">X1</th>
<th>XY</th>
<th>Y1</th>
<th>right.XY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td style="text-align: right;">1</td>
<td>x2</td>
<td>[1]</td>
<td>[y1]</td>
</tr>
<tr class="even">
<td>B</td>
<td style="text-align: right;">3</td>
<td>x4</td>
<td>[3 5]</td>
<td>[y3 y5]</td>
</tr>
<tr class="odd">
<td>C</td>
<td style="text-align: right;">5</td>
<td>x6</td>
<td>[]</td>
<td>[]</td>
</tr>
<tr class="even">
<td>C</td>
<td style="text-align: right;">7</td>
<td>x8</td>
<td>[]</td>
<td>[]</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Some joins are skipped</p>
<hr>
<p>Cross join</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb882"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb882-1"><a href="#cb882-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> cjds </span>(tc/dataset {<span class="at">:V1</span> [[<span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span>]]</span>
<span id="cb882-2"><a href="#cb882-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">:V2</span> [[<span class="dv">3</span> <span class="dv">2</span>]]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb883"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb883-1"><a href="#cb883-1" aria-hidden="true" tabindex="-1"></a>cjds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [1 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th>:V1</th>
<th>:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[2 1 1]</td>
<td>[3 2]</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb884"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb884-1"><a href="#cb884-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">reduce</span> #(tc/unroll <span class="va">%1</span> <span class="va">%2</span>) cjds (tc/column-names cjds))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb885"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb885-1"><a href="#cb885-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;</span> (<span class="kw">reduce</span> #(tc/unroll <span class="va">%1</span> <span class="va">%2</span>) cjds (tc/column-names cjds))</span>
<span id="cb885-2"><a href="#cb885-2" aria-hidden="true" tabindex="-1"></a>    (tc/unique-by))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [4 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="bind-1" class="level5">
<h5 class="anchored" data-anchor-id="bind-1">Bind</h5>
<div class="sourceClojure">
<div class="sourceCode" id="cb886"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb886-1"><a href="#cb886-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> x </span>(tc/dataset {<span class="at">:V1</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb887"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb887-1"><a href="#cb887-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> y </span>(tc/dataset {<span class="at">:V1</span> [<span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb888"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb888-1"><a href="#cb888-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> z </span>(tc/dataset {<span class="at">:V1</span> [<span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span>]</span>
<span id="cb888-2"><a href="#cb888-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">:V2</span> [<span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb889"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb889-1"><a href="#cb889-1" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb890"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb890-1"><a href="#cb890-1" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb891"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb891-1"><a href="#cb891-1" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Bind rows</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb892"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb892-1"><a href="#cb892-1" aria-hidden="true" tabindex="-1"></a>(tc/bind x y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb893"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb893-1"><a href="#cb893-1" aria-hidden="true" tabindex="-1"></a>(tc/bind x z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Bind rows using a list</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb894"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb894-1"><a href="#cb894-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;&gt;</span> [x y]</span>
<span id="cb894-2"><a href="#cb894-2" aria-hidden="true" tabindex="-1"></a>     (map-indexed #(tc/add-column <span class="va">%2</span> <span class="at">:id</span> (<span class="kw">repeat</span> <span class="va">%1</span>)))</span>
<span id="cb894-3"><a href="#cb894-3" aria-hidden="true" tabindex="-1"></a>     (<span class="kw">apply</span> tc/bind))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [6 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Bind columns</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb895"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb895-1"><a href="#cb895-1" aria-hidden="true" tabindex="-1"></a>(tc/append x y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [3 2]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="set-operations" class="level5">
<h5 class="anchored" data-anchor-id="set-operations">Set operations</h5>
<div class="sourceClojure">
<div class="sourceCode" id="cb896"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb896-1"><a href="#cb896-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> x </span>(tc/dataset {<span class="at">:V1</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">3</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb897"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb897-1"><a href="#cb897-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> y </span>(tc/dataset {<span class="at">:V1</span> [<span class="dv">2</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">4</span>]}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb898"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb898-1"><a href="#cb898-1" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb899"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb899-1"><a href="#cb899-1" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [5 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Intersection</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb900"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb900-1"><a href="#cb900-1" aria-hidden="true" tabindex="-1"></a>(tc/intersect x y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>intersection [4 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Difference</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb901"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb901-1"><a href="#cb901-1" aria-hidden="true" tabindex="-1"></a>(tc/difference x y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>difference [1 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Union</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb902"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb902-1"><a href="#cb902-1" aria-hidden="true" tabindex="-1"></a>(tc/union x y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>union [4 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb903"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb903-1"><a href="#cb903-1" aria-hidden="true" tabindex="-1"></a>(tc/concat x y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-dataset">
<p>_unnamed [10 1]:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">:V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>Equality not implemented</p>
<div style="background-color:grey;height:2px;width:100%;"></div>
<div><pre><small><small>source: <a href="https://github.com/scicloj/tablecloth/blob/master/notebooks/index.clj">notebooks/index.clj</a></small></small></pre></div>
</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>